import{$ as K,a0 as ce,a1 as G,r as d,a2 as P,a3 as Rr,j as s,a4 as be,a5 as Pr,a6 as Ar,a7 as Mr,a8 as _r,a9 as Or,aa as Dr,ab as Br,ac as Qt,ad as Fr,ae as Ur,p as ee,c as C,af as $r,ag as Vr,ah as Hr,ai as Wr,aj as os,q as Ae,ak as Y,al as zr,am as Qr,an as jn,ao as Kt,ap as Kr,aq as Gt,ar as ls,as as Gr,at as B,au as qr}from"./vendor-obEwBfia.js";import{_ as Yr,i as Jr,H as le,u as cs,a as ot,t as It,r as Xr,F as Zr,b as S,c as ea,L as qt,d as se,N as We,e as ta,T as Te,f as na,g as us,h as sa,j as ra,k as aa,l as ia,m as oa,n as la,o as ca,p as ua,B as da,q as ma}from"./react-dom-75QGQ8x8.js";import{c as ha,d as fa,f as ga,i as xa,n as pa,p as ba,t as ya,v as va,z as ja,h as wa,s as ka,a as Na,m as Sa,l as Ca,b as Ea,e as Ia,g as La,j as Ta,k as Ra,o as Pa}from"./locales-kG0Ihi24.js";import{I as E,a as j,U as ds,F as Aa,b as Se}from"./Icons--uG9Na6u.js";import{f as J}from"./auth-PrcDRVv8.js";import{d as Ma,f as _a,g as Yt,h as ms,l as Oa,F as Da}from"./caption-parsing-RO8mGNwK.js";import{H as oe}from"./hls-zqvr_1ex.js";import{c as Ba}from"./ietf-language-tags-EHt6_2CE.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();let R=function(e){return e.MOVIE="movie",e.SERIES="series",e.ANIME="anime",e}({}),ze=0;const W=K(ce(G(e=>({bookmarks:{},updateQueue:[],removeBookmark(t){e(n=>{ze+=1,n.updateQueue.push({id:ze.toString(),action:"delete",tmdbId:t}),delete n.bookmarks[t]})},addBookmark(t){e(n=>{ze+=1,n.updateQueue.push({id:ze.toString(),action:"add",tmdbId:t.tmdbId,type:t.type,title:t.title,year:t.releaseYear,poster:t.poster}),n.bookmarks[t.tmdbId]={type:t.type,title:t.title,year:t.releaseYear,poster:t.poster,updatedAt:Date.now()}})},replaceBookmarks(t){e(n=>{n.bookmarks=t})},clear(){e(t=>{t.bookmarks={}})},clearUpdateQueue(){e(t=>{t.updateQueue=[]})},removeUpdateItem(t){e(n=>{n.updateQueue=[...n.updateQueue.filter(r=>r.id!==t)]})}})),{name:"__MW::bookmarks"})),re={},hs={};async function Fa(){var e,t;for(const[n,r]of Object.values(hs)){const a=r.versions.sort((u,m)=>u.version-m.version),i=n._raw(),o=i["--version"]&&typeof i["--version"]=="number"?i["--version"]:0,l=a.filter(u=>u.version>=o);let c=i;try{for(const u of l)u.migrate&&(localStorage.setItem(`BACKUP-v${u.version}-${r.key}`,JSON.stringify(c)),c=await u.migrate(c))}catch(u){console.error(`FAILED TO MIGRATE STORE ${r.key}`,u),c=((t=(e=l[l.length-1]).create)==null?void 0:t.call(e))??{}}n.save(c)}}function Ua(e){const t=e.key??"",n=e.versions.sort((l,c)=>c.version-l.version)[0];function r(l){return re[t]||(re[t]=[]),re[t].push(l),{destroy(){re[t]=re[t].filter(c=>c===l)}}}function a(){var c;const l=((c=n.create)==null?void 0:c.call(n))??{};return l["--version"]=n.version,l}function i(){const l=localStorage.getItem(t);if(!l)return a();try{return JSON.parse(l)}catch(c){return console.error(`FAILED TO PARSE LOCALSTORAGE FOR KEY ${t}`,c),a()}}function o(l){const c={...l};c["--version"]=n.version,localStorage.setItem(t,JSON.stringify(c)),re[t]||(re[t]=[]),re[t].forEach(u=>u(window.structuredClone(l)))}return{get(){const l=i();return delete l["--version"],l},_raw(){return i()},onChange:r,save:o}}function $a(e){var r;const t=e.versions.sort((a,i)=>a.version-i.version);if(t.forEach((a,i,o)=>{if(i!==0&&a.version!==o[i-1].version+1)throw new Error("Version list of store is not incremental")}),t.forEach(a=>{if(a.version<0)throw new Error("Versions cannot be negative")}),((r=t[0])==null?void 0:r.version)!==0)throw new Error("Version 0 doesn't exist in version list of store");if(!e.versions[e.versions.length-1].create)throw new Error("Missing create function on latest version of store");if(!e.key)throw new Error("storage key not set in store");const n=[...t];n.pop(),n.forEach(a=>{if(!a.migrate)throw new Error(`Migration missing on version ${a.version}`)})}function lt(){const e={versions:[],key:null};return{setKey(t){return e.key=t,this},addVersion(t){return e.versions.push(t),this},build(){$a(e);const t=Ua(e);return hs[e.key??""]=[t,e],t}}}const wn="https://apis.justwatch.com",Va="https://images.justwatch.com";function Ha(e){if(e===R.MOVIE)return"movie";if(e===R.SERIES)return"show";throw new Error("unsupported type")}function Wa(e){if(e==="movie")return R.MOVIE;if(e==="show")return R.SERIES;throw new Error("unsupported type")}function za(e,t){var a,i;const n=Wa(e.object_type);let r;return n===R.SERIES&&(r=(a=e.seasons)==null?void 0:a.sort((o,l)=>o.season_number-l.season_number).map(o=>({id:o.id.toString(),number:o.season_number,title:o.title}))),{title:e.title,id:e.id.toString(),year:(i=e.original_release_year)==null?void 0:i.toString(),poster:e.poster?`${Va}${e.poster.replace("{profile}","s166")}`:void 0,type:n,seasons:r,seasonData:t?{id:t.id.toString(),number:t.season_number,title:t.title,episodes:t.episodes.sort((o,l)=>o.episode_number-l.episode_number).map(o=>({id:o.id.toString(),number:o.episode_number,title:o.title}))}:void 0}}const Qa="4.1.3",Ka="https://discord.movie-web.app",Ga="https://github.com/movie-web/movie-web",qa="https://ko-fi.com/movieweb",Ya="G-44YVXRL61C",Ja="https://backend.movie-web.app";var ae={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,PACKAGE_VERSION:"4.1.3"};const Xa={TMDB_READ_API_KEY:ae.VITE_TMDB_READ_API_KEY,APP_VERSION:void 0,GITHUB_LINK:void 0,DONATION_LINK:void 0,DISCORD_LINK:void 0,DMCA_EMAIL:ae.VITE_DMCA_EMAIL,CORS_PROXY_URL:ae.VITE_CORS_PROXY_URL,NORMAL_ROUTER:ae.VITE_NORMAL_ROUTER,BACKEND_URL:ae.VITE_BACKEND_URL,DISALLOWED_IDS:ae.VITE_DISALLOWED_IDS,TURNSTILE_KEY:ae.VITE_TURNSTILE_KEY,CDN_REPLACEMENTS:ae.VITE_CDN_REPLACEMENTS};function Za(e){var n;let t=(n=window==null?void 0:window.__CONFIG__)==null?void 0:n[`VITE_${e}`];return t!=null&&t.length===0&&(t=void 0),Xa[e]??t??void 0}function ie(e,t){var n;return((n=Za(e))==null?void 0:n.toString())??t??""}function M(){const e=ie("DMCA_EMAIL"),t=ie("TURNSTILE_KEY");return{APP_VERSION:Qa,GITHUB_LINK:Ga,DONATION_LINK:qa,DISCORD_LINK:Ka,DMCA_EMAIL:e.length>0?e:null,BACKEND_URL:ie("BACKEND_URL",Ja),TMDB_READ_API_KEY:ie("TMDB_READ_API_KEY"),PROXY_URLS:ie("CORS_PROXY_URL").split(",").map(n=>n.trim()),NORMAL_ROUTER:ie("NORMAL_ROUTER","false")==="true",TURNSTILE_KEY:t.length>0?t:null,DISALLOWED_IDS:ie("DISALLOWED_IDS","").split(",").map(n=>n.trim()).filter(n=>n.length>0),CDN_REPLACEMENTS:ie("CDN_REPLACEMENTS","").split(",").map(n=>n.split(":").map(r=>r.trim()).filter(r=>r.length>0)).filter(n=>n.length===2)}}let Q=function(e){return e.MOVIE="movie",e.TV="tv",e}({});const ei="https://backend.movie-web.app/metrics/providers",ti="https://backend.movie-web.app/metrics/captcha",ni=()=>Rr(32);function fs(e,t){const n=e.toString(),r=(e.stack??"").split(`
`,t+1);return r.pop(),`${n}

${r.join(`
`)}`}async function si(e){return P(ei,{method:"POST",body:{items:e,batchId:ni()}})}const ri={success:"success",notfound:"notfound",failure:"failed",pending:null,waiting:null};function pe(e,t,n,r,a){var c,u;const i=(c=e.episode)==null?void 0:c.tmdbId,o=(u=e.season)==null?void 0:u.tmdbId;let l;return a instanceof Error&&(l=a),{status:r,providerId:t,title:e.title,tmdbId:e.tmdbId,type:e.type,embedId:n??void 0,episodeId:i,seasonId:o,errorMessage:l==null?void 0:l.message,fullError:l?fs(l,5):void 0}}function kn(e,t,n){const r=ri[n.status];if(!r)return null;let a,i;e.type==="show"&&(a=e.episode.tmdbId,i=e.season.tmdbId);let o;return n.error instanceof Error&&(o=n.error),{status:r,providerId:t,title:e.title,tmdbId:e.tmdbId,type:e.type,embedId:n.embedId,episodeId:a,seasonId:i,errorMessage:n.reason??(o==null?void 0:o.message),fullError:o?fs(o,5):void 0}}function bm(e,t,n){const r=[];return t.forEach(a=>{const i=n[a.id];a.children.forEach(l=>{const c=n[l];if(!c.embedId)return;const u=kn(e,i.id,c);u&&r.push(u)});const o=kn(e,i.id,i);o&&r.push(o)}),r}function gs(){return{report:d.useCallback(t=>{t.length!==0&&si(t).catch(()=>{})},[])}}function Nn(e){P(ti,{method:"POST",body:{success:e}}).catch(()=>{})}const Xe=K(G((e,t)=>({turnstile:null,cbs:[],processToken(n){t().cbs.forEach(a=>a(n)),e(a=>{a.cbs=[]})},getToken(){return new Promise((n,r)=>{e(a=>{a.cbs=[...a.cbs,i=>{i?n(i):r(new Error("Failed to get token"))}]})})},setTurnstile(n){e(r=>{r.turnstile=n})}})));function xs(){return Xe.getState().turnstile}function ai(){return!!xs()}async function ii(){const e=xs();e==null||e.reset(),e==null||e.execute();try{const t=await Xe.getState().getToken();return Nn(!0),t}catch(t){throw Nn(!1),t}}function oi(){const e=M().TURNSTILE_KEY,t=Xe(r=>r.setTurnstile),n=Xe(r=>r.processToken);return e?s.jsx(Yr,{sitekey:e,onLoad:(r,a)=>{t(a)},onError:()=>{n(null)},onVerify:r=>{n(r)}}):null}let Ze=null,Ce=null;function ym(e){Ze=e}function ct(){return Ze??[]}function Jt(e){Ce=e}function li(){if(!Ce)return null;try{const e=Pr(Ce);if(!e.exp)return`jwt|${Ce}`;if(Date.now()/1e3<e.exp)return`jwt|${Ce}`}catch{}return null}async function vm(e){if(Ze)return;Ze=(await ks(`${e}/metadata`)).flat()}function Sn(e){let t={};return e.type==="show"&&(t={episodeNumber:e.episode.number.toString(),episodeTmdbId:e.episode.tmdbId,seasonNumber:e.season.number.toString(),seasonTmdbId:e.season.tmdbId}),{type:e.type,releaseYear:e.releaseYear.toString(),imdbId:e.imdbId,tmdbId:e.tmdbId,title:e.title,...t}}function Qe(e,t){Object.entries(t).forEach(n=>{n[1]&&e.searchParams.set(n[0],n[1])})}function Lt(e){const t=n=>new URL(`${e}${n}`);return{scrapeSource(n,r){const a=t("/scrape/source");return Qe(a,Sn(r)),Qe(a,{id:n}),a.toString()},scrapeAll(n){const r=t("/scrape");return Qe(r,Sn(n)),r.toString()},scrapeEmbed(n,r){const a=t("/scrape/embed");return Qe(a,{id:n,url:r}),a.toString()}}}async function Xt(){let e=li();return!e&&ai()&&(e=`turnstile|${await ii()}`),e}function Cn(e){return e.length===0?{}:JSON.parse(e)}async function Tt(e,t){const n=await Xt(),r=new URL(e);n&&r.searchParams.set("token",n);const a=new EventSource(r.toString());let i,o;const l=new Promise((c,u)=>{o=c,i=u});return t.forEach(c=>{a.addEventListener(c,u=>{a.close(),o(Cn(u.data))})}),a.addEventListener("token",c=>{Jt(Cn(c.data))}),a.addEventListener("error",c=>{if(a.close(),c.data){const u=JSON.parse(c.data);let m=new Error("scrape error");u.name===be.name&&(m=new be("Notfound from server")),Object.assign(m,u),i(m);return}console.error("Failed to connect to SSE",c),i(c)}),a.addEventListener("message",c=>{if(!c){a.close();return}setTimeout(()=>{i(new Error("SSE closed improperly"))},1e3)}),{promise:()=>l,on(c,u){a.addEventListener(c,m=>u(JSON.parse(m.data)))}}}const F=K(ce(G(e=>({account:null,backendUrl:null,proxySet:null,setAccount(t){e(n=>{n.account=t})},removeAccount(){e(t=>{t.account=null})},setBackendUrl(t){e(n=>{n.backendUrl=t})},setProxySet(t){e(n=>{n.proxySet=t})},setAccountProfile(t){e(n=>{n.account&&(n.account.profile=t)})},updateAccount(t){e(n=>{n.account&&(n.account={...n.account,...t})})},updateDeviceName(t){e(n=>{n.account&&(n.account.deviceName=t)})}})),{name:"__MW::auth"})),ci=M().PROXY_URLS,ui=["proxy","api"];function En(e){try{return!!new URL(e)}catch{return!1}}function di(e){return ui.includes(e)}function mi(e){const t=e.split(";").map(n=>n.split("=",2).filter(r=>r.length!==0)).filter(n=>n.length===2);return Object.fromEntries(t)}function ps(){const e=F.getState().proxySet??ci,t=[];return e.forEach(n=>{if(!n.startsWith("|")&&En(n)){t.push({url:n,type:"proxy"});return}const r=/^\|([^|]+)\|(.*)$/g.exec(n);if(!r||!r[2]||!En(r[2]))return;const i=mi(r[1]).type??"proxy";di(i)&&t.push({url:r[2],type:i})}),t}function bs(){return ps().filter(e=>e.type==="proxy").map(e=>e.url)}function hi(){return ps().filter(e=>e.type==="api").map(e=>e.url)}function ys(e){let t=-1;return()=>{const n=e();(t===-1||t>=n.length)&&(t=Math.floor(Math.random()*n.length));const r=n[t];return t=(t+1)%n.length,r}}const vs=ys(bs),js=ys(hi);async function fi(e,t){const n=await Xt(),r=new Headers(t==null?void 0:t.headers);n&&r.set("X-Token",n);const a=await fetch(e,t?{...t,headers:r}:void 0),i=a.headers.get("X-Token");return i&&Jt(i),a}function gi(){return async(t,n)=>Or(vs(),fi)(t,n)}const Rt=Ar({fetcher:Mr(fetch),proxiedFetcher:gi(),target:_r.BROWSER}),ws=P.create({retry:0});function In(e,t){let n=e;return Object.entries(t).forEach(r=>{let[a,i]=r;n=n.replace(`{${a}}`,encodeURIComponent(i))}),n}function ks(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ws(e,t)}async function Ns(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=(n==null?void 0:n.baseURL)??"";r.length>0&&r.endsWith("/")&&t.startsWith("/")?r+=t.slice(1):r.length>0&&!r.endsWith("/")&&!t.startsWith("/")?r+=`/${t}`:r+=t;const a=new URL(r);Object.entries((n==null?void 0:n.params)??{}).forEach(l=>{let[c,u]=l;a.searchParams.set(c,u)}),Object.entries((n==null?void 0:n.query)??{}).forEach(l=>{let[c,u]=l;a.searchParams.set(c,u)});let i=n.headers??{};const o=await Xt();return o&&(i={...i,"X-Token":o}),ws(e,{...n,baseURL:void 0,params:{destination:a.toString()},query:{},headers:i,onResponse(l){var u;const c=l.response.headers.get("X-Token");c&&Jt(c),(u=n.onResponse)==null||u.call(n,l)}})}function Pt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ns(vs(),e,t)}function et(e){if(e===R.MOVIE)return Q.MOVIE;if(e===R.SERIES)return Q.TV;throw new Error("unsupported type")}function tt(e){if(e==="movie")return R.MOVIE;if(e==="show")return R.SERIES;throw new Error("unsupported type")}function Me(e){if(e===Q.MOVIE)return R.MOVIE;if(e===Q.TV)return R.SERIES;throw new Error("unsupported type")}function xi(e){if(e===Q.MOVIE)return"movie";if(e===Q.TV)return"show";throw new Error("unsupported type")}function pi(e,t){var a,i;const n=Me(e.object_type);let r;return n===R.SERIES&&(r=(a=e.seasons)==null?void 0:a.sort((o,l)=>o.season_number-l.season_number).map(o=>({title:o.title,id:o.id.toString(),number:o.season_number}))),{title:e.title,id:e.id.toString(),year:(i=e.original_release_year)==null?void 0:i.toString(),poster:e.poster,type:n,seasons:r,seasonData:t?{id:t.id.toString(),number:t.season_number,title:t.title,episodes:t.episodes.sort((o,l)=>o.episode_number-l.episode_number).map(o=>({id:o.id.toString(),number:o.episode_number,title:o.title}))}:void 0}}function bi(e){const t=xi(e.object_type);return{title:e.title,id:e.id.toString(),year:e.original_release_year??0,poster:e.poster,type:t}}function Ee(e,t,n){return["tmdb",et(e),t,Dr(n,{lower:!0,strict:!0})].join("-")}function yi(e){return Ee(tt(e.type),e.id,e.title)}function jm(e){const[t,n,r]=e.split("-",3);if(t!=="tmdb")return null;let a;try{a=Me(n)}catch{return null}return{type:a,id:r}}const vi="https://api.themoviedb.org/3",ji={accept:"application/json",Authorization:`Bearer ${M().TMDB_READ_API_KEY}`};async function Re(e,t){return await ks(encodeURI(e),{headers:ji,baseURL:vi,params:{...t}})}async function Ss(e){return(await Re("search/multi",{query:e,include_adult:!1,language:"en-US",page:1})).results.filter(r=>r.media_type===Q.MOVIE||r.media_type===Q.TV)}async function wi(e){const t=await Ss(e);if(t.length===0)return;const n=t[0],r=n.media_type===Q.MOVIE?n.title:n.name;return`/media/${Ee(Me(n.media_type),n.id.toString(),r)}`}function ut(e,t){if(t===Q.MOVIE)return Re(`/movie/${e}`,{append_to_response:"external_ids"});if(t===Q.TV)return Re(`/tv/${e}`,{append_to_response:"external_ids"});throw new Error("Invalid media type")}function nt(e){if(e)return`https://image.tmdb.org/t/p/w342/${e}`}async function Cs(e,t){return(await Re(`/tv/${e}/season/${t}`)).episodes.map(r=>({id:r.id,episode_number:r.episode_number,title:r.name}))}async function Es(e){const n=(await Re(`/find/${e}`,{external_source:"imdb_id"})).movie_results[0];if(n)return n.id.toString()}function ki(e,t){if(Me(t)===R.SERIES){const a=e;return{title:a.name,poster:nt(a.poster_path),id:a.id,original_release_year:new Date(a.first_air_date).getFullYear(),object_type:t}}const r=e;return{title:r.title,poster:nt(r.poster_path),id:r.id,original_release_year:new Date(r.release_date).getFullYear(),object_type:t}}function Ni(e,t){if(t===R.MOVIE){const n=e;return{id:e.id,title:n.title,object_type:et(t),poster:nt(n.poster_path)??void 0,original_release_year:new Date(n.release_date).getFullYear()}}if(t===R.SERIES){const n=e;return{id:e.id,title:n.name,object_type:et(t),seasons:n.seasons.map(r=>({id:r.id,season_number:r.season_number,title:r.name})),poster:nt(n.poster_path)??void 0,original_release_year:new Date(n.first_air_date).getFullYear()}}throw new Error("unsupported type")}async function At(e,t,n){const r=await ut(t,et(e));if(!r)return null;const a=r.external_ids.imdb_id??void 0;let i;if(e===R.SERIES){const c=r.seasons;let u=c.find(m=>m.id.toString()===n);if(u||(u=c.find(m=>m.season_number===1)),u){const m=await Cs(r.id.toString(),u.season_number);i={id:u.id.toString(),season_number:u.season_number,title:u.name,episodes:m}}}const o=Ni(r,e);if(!o)return null;const l=pi(o,i);return l?{meta:l,imdbId:a,tmdbId:t}:null}async function Is(e,t,n){var c,u,m,g,f;const r=Ha(e);let a;try{const h=In("/content/titles/{type}/{id}/locale/en_US",{type:r,id:t});a=await Pt(h,{baseURL:wn})}catch(h){if(h instanceof Br&&(h.statusCode===400||h.statusCode===404))return null;throw h}let i=(c=a.external_ids.find(h=>h.provider==="imdb_latest"))==null?void 0:c.external_id;i||(i=(u=a.external_ids.find(h=>h.provider==="imdb"))==null?void 0:u.external_id);let o=(m=a.external_ids.find(h=>h.provider==="tmdb_latest"))==null?void 0:m.external_id;o||(o=(g=a.external_ids.find(h=>h.provider==="tmdb"))==null?void 0:g.external_id);let l;if(a.object_type==="show"){const h=n??((f=a.seasons)==null?void 0:f[0].id.toString())??"",x=In("/content/titles/show_season/{id}/locale/en_US",{id:h});l=await Pt(x,{baseURL:wn})}return{meta:za(a,l),imdbId:i,tmdbId:o}}function Mt(e){return!!(e.startsWith("/media/JW")||e.startsWith("/media/tmdb-show"))}function Si(e){return!!e.startsWith("/media/tmdb-show")}async function Ci(e){if(!Mt(e))return;const t=e.split("/").slice(2),[,n,r]=t[0].split("-",3),a=t.slice(1).map(u=>`/${u}`).join("");if(Si(e)){const u=await ut(r,Q.TV);return`/media/${Ee(R.SERIES,u.id.toString(),u.name)}${a}`}const i=Me(n),o=await Is(i,r);if(!o)return;const{tmdbId:l,imdbId:c}=o;if(!(!l&&!c)&&c&&i===R.MOVIE){const u=await Es(c);if(u)return`/media/${Ee(i,u,o.meta.title)}`;if(l)return`/media/${Ee(i,l,o.meta.title)}`}}class Ls{constructor(){this.INTERVAL_MS=2*60*1e3,this._interval=null,this._compare=null,this._storage=[]}initialize(){if(this._interval)throw new Error("cache is already initialized");this._interval=setInterval(()=>{const t=new Date;this._storage.filter(n=>!(n.expiry<t))},this.INTERVAL_MS)}destroy(){this._interval&&clearInterval(this._interval),this.clear()}setCompare(t){this._compare=t}has(t){return!!this.get(t)}get(t){if(!this._compare)throw new Error("Compare function not set");const n=this._storage.find(r=>this._compare&&this._compare(r.key,t));if(n)return n.value}set(t,n,r){if(!this._compare)throw new Error("Compare function not set");const a=this._storage.find(o=>this._compare&&this._compare(o.key,t)),i=new Date(new Date().getTime()+r*1e3);if(a){a.key=t,a.value=n,a.expiry=i;return}this._storage.push({key:t,value:n,expiry:i})}remove(t){if(!this._compare)throw new Error("Compare function not set");this._storage.filter(n=>!(this._compare&&this._compare(n.key,t)))}clear(){this._storage=[]}}const Ie=new Ls;Ie.setCompare((e,t)=>e.searchQuery.trim()===t.searchQuery.trim());Ie.initialize();async function Ts(e){if(Ie.has(e))return Ie.get(e);const{searchQuery:t}=e,r=(await Ss(t)).map(a=>{const i=ki(a,a.media_type);return bi(i)});return Ie.set(e,r,3600),r}function Ln(e){return e.trim().toLowerCase().replace(/['":]/g,"").replace(/[^a-zA-Z0-9]+/g,"_")}function Ei(e,t){return Ln(e)===Ln(t)}async function Rs(e,t){const n=(i,o)=>Math.abs(i-o)<=1,r={},a=await Promise.all(Object.values(e).map(async i=>{const o=Number(i.year.toString().split("-")[0]),c=(await Ts({searchQuery:`${i.title} ${o}`})).find(u=>n(Number(u.year),o)&&Ei(u.title,i.title));if(!c){console.error(`No item found for migration: ${i.title}`);return}return{id:i.mediaId,data:c}}));for(const i of a.filter(Boolean)){if(!i)continue;let o=[["0","0"]];if(i.data.type==="show"){const l=await At(R.SERIES,i.data.id);if(!l||!(l!=null&&l.meta.seasons))return;o=[...new Set(t!=null&&t.items?t.items.filter(m=>m.mediaId===i.id).map(m=>m.seasonId):["0"])].map(m=>{var g,f;return{num:m,season:(f=(g=l.meta)==null?void 0:g.seasons)==null?void 0:f[Math.max(0,m-1)]}}).map(m=>{var g;return m?[m.num,(g=m==null?void 0:m.season)==null?void 0:g.id]:[]}).filter(m=>m.length>0)}r[i.id]||(r[i.id]={}),await Promise.all(o.map(async l=>{let[c,u]=l;c&&(r[i.id][c]=await At(tt(i.data.type),i.data.id,u==="0"||u===null?void 0:u))}))}return r}async function Ii(e){const t=e;if(!t)return;const n={};t.bookmarks.forEach(i=>{n[i.mediaId]||(n[i.mediaId]=i)});const r=await Rs(n);return r?{bookmarks:Object.keys(r).map(i=>r[i][0]).map(i=>i==null?void 0:i.meta).filter(Boolean)}:void 0}async function Li(e){var o,l,c,u;const t=e;if(!t)return;const n={};t.items.forEach(m=>{n[m.mediaId]||(n[m.mediaId]=m)});const r=await Rs(n,t);if(!r)return;const a={...t,items:[]},i=Date.now();for(const m of t.items)if(m.mediaType==="movie"){if(!((o=r[m.mediaId][0])!=null&&o.meta))continue;const g={item:{meta:(l=r[m.mediaId][0])==null?void 0:l.meta},progress:m.progress,percentage:m.percentage,watchedAt:Date.now()};t.items=t.items.filter(f=>JSON.stringify(f)!==JSON.stringify(m)),a.items.push(g)}else if(m.mediaType==="series"){if(!((c=r[m.mediaId][m.seasonId])!=null&&c.meta))continue;const g=(u=r[m.mediaId][m.seasonId])==null?void 0:u.meta;if(g.type!=="series")return;const f={item:{meta:g,series:{episode:Number(m.episodeId),season:Number(m.seasonId),seasonId:g.seasonData.id,episodeId:g.seasonData.episodes[Number(m.episodeId)-1].id}},progress:m.progress,percentage:m.percentage,watchedAt:i+Number(m.seasonId)*1e3+Number(m.episodeId)};if(a.items.find(h=>{var x,v;return h.item.meta.id===f.item.meta.id&&((x=h.item.series)==null?void 0:x.episodeId)===((v=f.item.series)==null?void 0:v.episodeId)}))continue;t.items=t.items.filter(h=>JSON.stringify(h)!==JSON.stringify(m)),a.items.push(f)}return a}function Ti(e){return e!=null}async function Ps(e,t){const n=await Is(t,e);if(!n)return;const{tmdbId:r,imdbId:a}=n;if(!(!r&&!a)){if(a&&t===R.MOVIE){const i=await Es(a);if(i)return i}if(r)return r}}async function Ri(e){const t=e.bookmarks.map(async n=>({...n,id:await Ps(n.id,n.type).catch(()=>{})}));return{bookmarks:(await Promise.all(t)).filter(n=>n.id)}}async function Pi(e){return{items:(await Promise.all(e.items.map(async n=>{try{const r=await Ps(n.item.meta.id,n.item.meta.type);if(!r)return null;const a=structuredClone(n);if(a.item.meta.id=r,a.item.series){const i=a.item.series,l=(await ut(r,Q.TV)).seasons.find(m=>m.season_number===i.season);if(!l)return null;const u=(await Cs(r,l.season_number)).find(m=>m.episode_number===i.episode);if(!u)return null;a.item.series.episodeId=u.id.toString(),a.item.series.seasonId=l.id.toString()}return a}catch{return null}}))).filter(Ti)}}const Ai={[R.ANIME]:null,[R.MOVIE]:"movie",[R.SERIES]:"show"};lt().setKey("mw-bookmarks").addVersion({version:0,migrate(e){return Ii(e)}}).addVersion({version:1,migrate(e){return Ri(e)}}).addVersion({version:2,migrate(e){const t={};for(const n of e.bookmarks){const r=Ai[n.type];r&&(t[n.id]={title:n.title,year:n.year?Number(n.year):void 0,poster:n.poster,type:r,updatedAt:Date.now()})}return W.getState().replaceBookmarks(t),{bookmarks:[]}}}).addVersion({version:3,create(){return{bookmarks:[]}}}).build();const Mi={deviceNameLabel:"Device name",deviceNamePlaceholder:"Personal phone",hasAccount:"Already have an account? <0>Login here.</0>",createAccount:"Don't have an account yet? <0>Create an account.</0>",register:{information:{title:"Account information",color1:"Profile color one",color2:"Profile color two",icon:"User icon",header:"Enter a name for your device and pick colours and a user icon of your choosing",next:"Next"}},login:{title:"Login to your account",description:"Please enter your passphrase to login to your account",validationError:"Incorrect or incomplete passphrase",deviceLengthError:"Please enter a device name",submit:"Login",passphraseLabel:"12-Word passphrase",passphrasePlaceholder:"Passphrase"},generate:{title:"Your passphrase",passphraseFrameLabel:"Passphrase",next:"I have saved my passphrase",description:"Your passphrase acts as your username and password. Make sure to keep it safe as you will need to enter it to login to your account"},trust:{title:"Do you trust this server?",host:"You are connecting to <0>{{hostname}}</0> - please confirm you trust it before making an account",failed:{title:"Failed to reach server",text:"Did you configure it correctly?"},yes:"I trust this server",no:"Go back"},verify:{title:"Confirm your passphrase",description:"Please enter your passphrase from earlier to confirm you have saved it and to create your account",invalidData:"Data is not valid",noMatch:"Passphrase doesn't match",recaptchaFailed:"ReCaptcha validation failed",passphraseLabel:"Your 12-word passphrase",register:"Create account"}},_i={details:"Error details",reloadPage:"Reload the page",showError:"Show error details",badge:"It broke",title:"We encountered an error!"},Oi={badge:"Not found",title:"Couldn't find that page",message:"We looked everywhere: under the bins, in the closet, behind the proxy but ultimately couldn't find the page you are looking for.",goHome:"Back to home"},Di={name:"movie-web",pages:{pagetitle:"{{title}} - movie-web",dmca:"DMCA",settings:"Settings",about:"About",login:"Login",register:"Register"}},Bi={types:{movie:"Movie",show:"Show"},episodeDisplay:"S{{season}} E{{episode}}"},Fi={scraping:{notFound:{badge:"Not found",title:"We couldn't find that",text:"We have searched through our providers and cannot find the media you are looking for! We do not host the media and have no control over what is available. Please click 'Show details' below for more details.",homeButton:"Go home",detailsButton:"Show details"},items:{pending:"Checking for videos...",notFound:"Doesn't have the video",failure:"Error occurred"}},casting:{enabled:"Casting to device..."},playbackError:{badge:"Playback error",title:"Failed to play video!",text:"There was an error trying to play the media. Please try again.",homeButton:"Go home",errors:{errorAborted:"The fetching of the media was aborted by the user's request.",errorNetwork:"Some kind of network error occurred which prevented the media from being successfully fetched, despite having previously been available.",errorDecode:"Despite having previously been determined to be usable, an error occurred while trying to decode the media resource, resulting in an error.",errorNotSupported:"The media or media provider object is not supported.",errorGenericMedia:"Unknown media error occurred."}},metadata:{notFound:{badge:"Not found",title:"Couldn't find that media.",text:"We couldn't find the media you requested. Either it's been removed or you tampered with the URL.",homeButton:"Back to home"},failed:{badge:"Failed",title:"Failed to load metadata",text:"Could not load the media's metadata from TMDB. Please check whether TMDB is down or blocked on your internet connection.",homeButton:"Go home"}},back:{default:"Back to home",short:"Back"},time:{regular:"{{timeWatched}} / {{duration}}",shortRegular:"{{timeWatched}}",remaining:"{{timeLeft}} left • Finish at {{timeFinished, datetime}}",shortRemaining:"-{{timeLeft}}"},nextEpisode:{next:"Next episode",cancel:"Cancel"},menus:{settings:{videoSection:"Video settings",experienceSection:"Viewing experience",enableCaptions:"Enable captions",captionItem:"Caption settings",sourceItem:"Video sources",playbackItem:"Playback settings",downloadItem:"Download",qualityItem:"Quality"},episodes:{button:"Episodes",loadingTitle:"Loading...",loadingList:"Loading...",loadingError:"Error loading season",emptyState:"There are no episodes in this season, check back later!",episodeBadge:"E{{episode}}"},sources:{title:"Sources",unknownOption:"Unknown",noStream:{title:"No stream",text:"This source has no streams for this movie or show."},noEmbeds:{title:"No embeds found",text:"We were unable to find any embeds, please try a different source."},failed:{title:"Failed to scrape",text:"There was an error while trying to find any videos, please try a different source."}},captions:{title:"Captions",customizeLabel:"Customize",settings:{fixCapitals:"Fix capitalization",delay:"Caption delay"},customChoice:"Select caption from file",offChoice:"Off",unknownLanguage:"Unknown"},downloads:{title:"Download",disclaimer:"Downloads are taken directly from the provider. movie-web does not have control over how the downloads are provided.",hlsDisclaimer:"Downloads are taken directly from the provider. movie-web does not have control over how the downloads are provided. Please note that you are downloading an HLS playlist, this is intended for users familiar with advanced multimedia streaming.",downloadVideo:"Download video",downloadPlaylist:"Download playlist",downloadCaption:"Download current caption",onPc:{1:"On PC, click the download button then, on the new page, right click the video and select <bold>Save video as</bold>",title:"Downloading on PC",shortTitle:"Download / PC"},onAndroid:{1:"To download on Android, click the download button then, on the new page, <bold>tap and hold</bold> on the video, then select <bold>save</bold>.",title:"Downloading on Android",shortTitle:"Download / Android"},onIos:{1:"To download on iOS, click the download button then, on the new page, click <bold><ios_share /></bold>, then <bold>Save to Files <ios_files /></bold>.",title:"Downloading on iOS",shortTitle:"Download / iOS"}},playback:{title:"Playback settings",speedLabel:"Playback speed"},quality:{title:"Quality",automaticLabel:"Automatic quality",hint:"You can try <0>switching source</0> to get different quality options.",iosNoQuality:"Due to Apple-defined limitations, quality selection is not available on iOS for this source. You can try <0>switching to another source</0> to get different quality options."}}},Ui={mediaList:{stopEditing:"Stop editing"},titles:{morning:{default:"What would you like to watch this morning?",extra:["I hear Before Sunrise is good"]},day:{default:"What would you like to watch this afternoon?",extra:[]},night:{default:"What would you like to watch tonight?",extra:["Tired? I hear The Exorcist is good."]}},search:{loading:"Loading...",sectionTitle:"Search results",allResults:"That's all we have!",noResults:"We couldn't find anything!",failed:"Failed to find media, try again!",placeholder:"What do you want to watch?"},continueWatching:{sectionTitle:"Continue Watching"},bookmarks:{sectionTitle:"Bookmarks"}},$i={close:"Close"},Vi={loadingUser:"Loading your profile",loadingApp:"Loading application",loadingUserError:{text:"Failed to load your profile",textWithReset:"Failed to load your profile from your custom server, want to reset back to the default server?",reset:"Reset custom server",logout:"Logout"},migration:{failed:"Failed to migrate your data.",inProgress:"Please hold, we are migrating your data. This shouldn't take long."},dmca:{title:"DMCA",text:"Welcome to movie-web's DMCA contact page! We respect intellectual property rights and want to address any copyright concerns swiftly. If you believe your copyrighted work has been improperly used on our platform, please send a detailed DMCA notice to the email below. Please include a description of the copyrighted material, your contact details, and a statement of good faith belief. We're committed to resolving these matters promptly and appreciate your cooperation in keeping movie-web a place that respects creativity and copyrights."}},Hi={banner:{offline:"Check your internet connection"},menu:{register:"Sync to cloud",settings:"Settings",about:"About us",donation:"Donate",support:"Support",logout:"Log out"}},Wi={copy:"Copy",copied:"Copied"},zi={unsaved:"You have unsaved changes",reset:"Reset",save:"Save",sidebar:{info:{title:"App information",hostname:"Hostname",backendUrl:"Backend URL",userId:"User ID",notLoggedIn:"You are not logged in",appVersion:"App version",backendVersion:"Backend version",unknownVersion:"Unknown",secure:"Secure",insecure:"Insecure"}},appearance:{title:"Appearance",activeTheme:"Active",themes:{default:"Default",blue:"Blue",teal:"Teal",red:"Red",gray:"Gray"}},account:{title:"Account",register:{title:"Sync to the cloud",text:"Share your watch progress between devices and keep them synced.",cta:"Get started"},profile:{title:"Edit profile picture",firstColor:"Profile color one",secondColor:"Profile color two",userIcon:"User icon",finish:"Finish editing"},devices:{title:"Devices",failed:"Failed to load sessions",deviceNameLabel:"Device name",removeDevice:"Remove"},accountDetails:{editProfile:"Edit",deviceNameLabel:"Device name",deviceNamePlaceholder:"Personal phone",logoutButton:"Log out"},actions:{title:"Actions",delete:{title:"Delete account",text:"This action is irreversible. All data will be deleted and nothing can be recovered.",button:"Delete account",confirmTitle:"Are you sure?",confirmDescription:"Are you sure you want to delete your account? All your data will be lost!",confirmButton:"Delete account"}}},locale:{title:"Locale",language:"Application language",languageDescription:"Language applied to the entire application."},captions:{title:"Captions",previewQuote:"I must not fear. Fear is the mind-killer.",backgroundLabel:"Background opacity",textSizeLabel:"Text size",colorLabel:"Color"},connections:{title:"Connections",workers:{label:"Use custom proxy workers",description:"To make the application function, all traffic is routed through proxies. Enable this if you want to bring your own workers.",urlLabel:"Worker URLs",emptyState:"No workers yet, add one below",urlPlaceholder:"https://",addButton:"Add new worker"},server:{label:"Custom server",description:"If you would like to connect to a custom backend to store your data, enable this and provide the URL.",urlLabel:"Custom server URL"}}},Qi={title:"About movie-web",description:"movie-web is a web application that searches the internet for streams. The team aims for a mostly minimalistic approach to consuming content.",faqTitle:"Common questions",q1:{title:"Where does the content come from?",body:"movie-web does not host any content. When you click on something to watch, the internet is searched for the selected media (On the loading screen and in the 'video sources' tab you can see which source you're using). Media never gets uploaded by movie-web, everything is through this searching mechanism."},q2:{title:"Where can I request a show or movie?",body:"It's not possible to request a show or movie, movie-web does not manage any content. All content is viewed through sources on the internet."},q3:{title:"The search results display the show or movie, why can't I play it?",body:"Our search results are powered by The Movie Database (TMDB) and display regardless of whether our sources actually have the content."}},Ki={tagline:"Watch your favourite shows and movies with this open source streaming app.",links:{github:"GitHub",dmca:"DMCA",discord:"Discord"},legal:{disclaimer:"Disclaimer",disclaimerText:"movie-web does not host any files, it merely links to 3rd party services. Legal issues should be taken up with the file hosts and providers. movie-web is not responsible for any media files shown by the video providers."}},Gi={auth:Mi,errors:_i,notFound:Oi,global:Di,media:Bi,player:Fi,home:Ui,overlays:$i,screens:Vi,navigation:Hi,actions:Wi,settings:zi,about:Qi,footer:Ki},As={en:Gi,cs:ha,de:fa,fr:ga,it:xa,nl:pa,pl:ba,tr:ya,vi:va,zh:ja,he:wa,sv:ka,pirate:Na,minion:Sa,lv:Ca,th:Ea,ne:Ia,ar:La,es:Ta,et:Ra,tok:Pa},qi=["he","ar"],Yi=Object.keys(As),Ji=Object.fromEntries(Object.entries(As).map(e=>[e[0],{translation:e[1]}]));Qt.use(Jr).init({fallbackLng:"en",resources:Ji,interpolation:{escapeValue:!1}});const Xi={pirate:{code:"pirate",name:"Pirate",nativeName:"Pirate Tongue"},minion:{code:"minion",name:"Minion",nativeName:"Minionese"},tok:{code:"tok",name:"Toki pona",nativeName:"Toki pona"}},wm=Yi.map(e=>{const t=Xi[e];if(t)return t;const[n]=Fr.getLanguages([e]);if(!n)throw new Error(`Language with code ${e} cannot be found in database`);return n}),_e=K(ce(G(e=>({language:"en",setLanguage(t){e(n=>{n.language=t})}})),{name:"__MW::locale"}));function Zi(){const e=_e(n=>n.language);d.useEffect(()=>{Qt.changeLanguage(e)},[e]);const t=qi.includes(e);return s.jsx(le,{children:s.jsx("html",{dir:t?"rtl":"ltr"})})}const O=K(ce(G(e=>({enabled:!1,lastSync:{lastSelectedLanguage:null},lastSelectedLanguage:null,overrideCasing:!1,delay:0,styling:{color:"#ffffff",backgroundOpacity:.5,size:1},resetSubtitleSpecificSettings(){e(t=>{t.delay=0,t.overrideCasing=!1})},updateStyling(t){e(n=>{t.backgroundOpacity!==void 0&&(n.styling.backgroundOpacity=t.backgroundOpacity),t.color!==void 0&&(n.styling.color=t.color.toLowerCase()),t.size!==void 0&&(n.styling.size=Math.min(2,Math.max(.01,t.size)))})},setLanguage(t){e(n=>{n.enabled=!!t,t&&(n.lastSelectedLanguage=t)})},setCustomSubs(){e(t=>{t.enabled=!0,t.lastSelectedLanguage=null})},setOverrideCasing(t){e(n=>{n.overrideCasing=t})},setDelay(t){e(n=>{n.delay=Math.max(Math.min(500,t),-500)})},importSubtitleLanguage(t){e(n=>{n.lastSelectedLanguage=t,n.lastSync.lastSelectedLanguage=t})}})),{name:"__MW::subtitles"}));lt().setKey("mw-settings").addVersion({version:0,create(){return{language:"en",captionSettings:{delay:0,style:{color:"#ffffff",fontSize:25,backgroundColor:"#00000096"}}}},migrate(e){return{language:e.language,captionSettings:{language:"none",...e.captionSettings}}}}).addVersion({version:1,migrate(e){const t=_e.getState(),n=O.getState(),r=e.captionSettings.style.backgroundColor;let a=.5;if(r.length===9){const i=r.slice(7);a=parseInt(i,16)/255}return t.setLanguage(e.language),n.updateStyling({backgroundOpacity:a,color:e.captionSettings.style.color,size:e.captionSettings.style.fontSize/25}),n.importSubtitleLanguage(e.captionSettings.language==="none"?null:e.captionSettings.language),{}}}).addVersion({version:2,create(){return{}}}).build();const Zt=K(ce(G(e=>({volume:1,setVolume(t){e(n=>{n.volume=t})}})),{name:"__MW::volume"})),Ms=K(G(e=>({showVolume:!1,setShowVolume(t){e(n=>{n.showVolume=t})}})));lt().setKey("mw-volume").addVersion({version:0,create(){return{volume:1}},migrate(e){return Zt.getState().setVolume(e.volume),{}}}).addVersion({version:1,create(){return{}}}).build();let Ke=0;const V=K(ce(G(e=>({items:{},updateQueue:[],removeItem(t){e(n=>{Ke+=1,n.updateQueue.push({id:Ke.toString(),action:"delete",tmdbId:t}),delete n.items[t]})},replaceItems(t){e(n=>{n.items=t})},updateItem(t){let{meta:n,progress:r}=t;e(a=>{var o,l,c,u;Ke+=1,a.updateQueue.push({tmdbId:n.tmdbId,title:n.title,year:n.releaseYear,poster:n.poster,type:n.type,progress:{...r},id:Ke.toString(),episodeId:(o=n.episode)==null?void 0:o.tmdbId,seasonId:(l=n.season)==null?void 0:l.tmdbId,seasonNumber:(c=n.season)==null?void 0:c.number,episodeNumber:(u=n.episode)==null?void 0:u.number,action:"upsert"}),a.items[n.tmdbId]||(a.items[n.tmdbId]={type:n.type,episodes:{},seasons:{},updatedAt:0,title:n.title,year:n.releaseYear,poster:n.poster});const i=a.items[n.tmdbId];if(i.updatedAt=Date.now(),n.type==="movie"){i.progress||(i.progress={duration:0,watched:0}),i.progress={...r};return}!n.episode||!n.season||(i.seasons[n.season.tmdbId]||(i.seasons[n.season.tmdbId]={id:n.season.tmdbId,number:n.season.number,title:n.season.title}),i.episodes[n.episode.tmdbId]||(i.episodes[n.episode.tmdbId]={id:n.episode.tmdbId,number:n.episode.number,title:n.episode.title,seasonId:n.season.tmdbId,updatedAt:Date.now(),progress:{duration:0,watched:0}}),i.episodes[n.episode.tmdbId].progress={...r})})},clear(){e(t=>{t.items={}})},clearUpdateQueue(){e(t=>{t.updateQueue=[]})},removeUpdateItem(t){e(n=>{n.updateQueue=[...n.updateQueue.filter(r=>r.id!==t)]})}})),{name:"__MW::progress"}));function eo(e){var n,r;const t={};for(const a of e.items)if(a.item.meta.type===R.SERIES){if(t[a.item.meta.id]||(t[a.item.meta.id]={type:"show",episodes:{},seasons:{},title:a.item.meta.title,updatedAt:a.watchedAt,poster:a.item.meta.poster,year:Number(a.item.meta.year)}),a.item.series&&!t[a.item.meta.id].episodes[a.item.series.episodeId]){const i=(n=a.item.meta.seasonData.episodes.find(o=>{var l;return o.number===((l=a.item.series)==null?void 0:l.episode)}))==null?void 0:n.title;t[a.item.meta.id].seasons[a.item.series.seasonId]={id:a.item.series.seasonId,number:a.item.series.season,title:((r=a.item.meta.seasons.find(o=>{var l;return o.number===((l=a.item.series)==null?void 0:l.season)}))==null?void 0:r.title)||"Unknown season"},t[a.item.meta.id].episodes[a.item.series.episodeId]={title:i||"Unknown",id:a.item.series.episodeId,number:a.item.series.episode,seasonId:a.item.series.seasonId,updatedAt:a.watchedAt,progress:{duration:100/a.percentage*a.progress,watched:a.progress}}}}else t[a.item.meta.id]={type:"movie",episodes:{},seasons:{},title:a.item.meta.title,updatedAt:a.watchedAt,year:Number(a.item.meta.year),poster:a.item.meta.poster,progress:{duration:100/a.percentage*a.progress,watched:a.progress}};return t}lt().setKey("video-progress").addVersion({version:0,migrate(){return{items:[]}}}).addVersion({version:1,async migrate(e){return Li(e)}}).addVersion({version:2,migrate(e){return Pi(e)}}).addVersion({version:3,migrate(e){return V.getState().replaceItems(eo(e)),{items:[]}}}).addVersion({version:4,create(){return{items:[]}}}).build();Ur.initialize([{trackingId:Ya}]);function dt(e){return s.jsx("div",{className:["spinner",e.className??""].join(" ")})}function _(e){var u;const t=ee(),{onClick:n,href:r,loading:a}=e,i=d.useCallback(()=>{a||(r?t(r):n==null||n())},[n,r,t,a]);let o="bg-white hover:bg-gray-200 text-black";e.theme==="purple"&&(o="bg-buttons-purple hover:bg-buttons-purpleHover text-white"),e.theme==="secondary"&&(o="bg-buttons-cancel hover:bg-buttons-cancelHover transition-colors duration-100 text-white"),e.theme==="danger"&&(o="bg-buttons-danger hover:bg-buttons-dangerHover text-white");let l=C("tabbable cursor-pointer inline-flex items-center justify-center rounded-lg font-medium transition-[transform,background-color] duration-100 active:scale-105 md:px-8",e.padding??"px-4 py-3",e.className,o,e.disabled?"cursor-not-allowed bg-opacity-60 text-opacity-60":null);e.disabled&&(l=l.split(" ").filter(m=>!m.startsWith("hover:")&&!m.startsWith("active:")).join(" "));const c=s.jsxs(s.Fragment,{children:[e.icon&&!e.loading?s.jsx("span",{className:"mr-3 hidden md:inline-block",children:s.jsx(E,{icon:e.icon})}):null,e.loading?s.jsx("span",{className:"mr-3 inline-flex justify-center",children:s.jsx(dt,{className:"text-lg"})}):null,e.children]});return e.href&&(e.href.startsWith("https://")||(u=e.href)!=null&&u.startsWith("data:"))?s.jsx("a",{className:l,href:e.href,target:"_blank",rel:"noreferrer",download:e.download,children:c}):e.href?s.jsx("a",{className:l,onClick:i,children:c}):s.jsx("button",{type:"button",onClick:i,className:l,children:c})}function Tn(e){let t="bg-white hover:bg-gray-200 text-black";e.theme==="purple"&&(t="bg-buttons-purple hover:bg-buttons-purpleHover text-white"),e.theme==="secondary"&&(t="bg-buttons-cancel hover:bg-buttons-cancelHover transition-colors duration-100 text-white");const n=C("cursor-pointer inline-flex items-center justify-center rounded-lg font-medium transition-[transform,background-color] duration-100 active:scale-105 md:px-8","px-4 py-3",e.className,t);return s.jsx("button",{type:"button",onClick:e.onClick,className:n,children:e.children})}const to=function(t){return s.jsx("div",{className:t.className,children:s.jsxs("div",{className:"flex flex-col items-center justify-center",children:[s.jsxs("div",{className:"flex h-12 items-center justify-center",children:[s.jsx("div",{className:"mx-1 h-2 w-2 animate-loading-pin rounded-full bg-[#211D30]"}),s.jsx("div",{className:"mx-1 h-2 w-2 animate-loading-pin rounded-full bg-[#211D30] [animation-delay:150ms]"}),s.jsx("div",{className:"mx-1 h-2 w-2 animate-loading-pin rounded-full bg-[#211D30] [animation-delay:300ms]"}),s.jsx("div",{className:"mx-1 h-2 w-2 animate-loading-pin rounded-full bg-[#211D30] [animation-delay:450ms]"})]}),t.text&&t.text.length?s.jsx("p",{className:"mt-3 max-w-xs text-sm opacity-75",children:t.text}):null]})})},Oe=to;function U(e){return{authorization:`Bearer ${e}`}}function no(e,t){return{meta:{title:t.title,type:t.type,poster:t.poster,year:t.year??0},tmdbId:e}}async function so(e,t,n){return P(`/users/${t.userId}/bookmarks/${n.tmdbId}`,{method:"POST",headers:U(t.token),baseURL:e,body:n})}async function ro(e,t,n){return P(`/users/${t.userId}/bookmarks/${n}`,{method:"DELETE",headers:U(t.token),baseURL:e})}async function ao(e){return $r(Vr,e,"mnemonic",{c:2048,dkLen:32})}function io(e){return Hr(e,os)}async function Rn(e){const t=await ao(e),{privateKey:n,publicKey:r}=J.pki.ed25519.generateKeyPair({seed:t});return{privateKey:n,publicKey:r,seed:t}}function oo(){return Wr(os)}async function lo(e,t){return J.pki.ed25519.sign({encoding:"utf8",message:e,privateKey:t})}function _t(e){return J.util.encode64(String.fromCodePoint(...e))}function Ot(e){return _t(e).replace(/\//g,"_").replace(/\+/g,"-").replace(/=+$/,"")}async function Pn(e,t){const n=await lo(t,e.privateKey);return Ot(n)}function en(e){return J.util.binary.base64.decode(e)}function jt(e){return J.util.createBuffer(en(e))}function An(e){return J.util.encode64(e.getBytes())}async function Mn(e,t){if(t.byteLength!==32)throw new Error("Secret must be at least 256-bit");const n=await new Promise((o,l)=>{J.random.getBytes(16,(c,u)=>{c&&l(c),o(u)})}),r=J.cipher.createCipher("AES-GCM",J.util.createBuffer(t));r.start({iv:n,tagLength:128}),r.update(J.util.createBuffer(e,"utf8")),r.finish();const a=r.output,i=r.mode.tag;return`${J.util.encode64(n)}.${An(a)}.${An(i)}`}function _s(e,t){if(t.byteLength!==32)throw new Error("Secret must be 256-bit");const[n,r,a]=e.split("."),i=J.cipher.createDecipher("AES-GCM",J.util.createBuffer(t));if(i.start({iv:jt(n),tag:jt(a),tagLength:128}),i.update(jt(r)),!i.finish())throw new Error("Error decrypting data");return i.output.toString()}function co(e,t,n){return P(`/users/${t.userId}/progress/import`,{method:"PUT",body:n,baseURL:e,headers:U(t.token)})}function uo(e,t,n){return P(`/users/${t.userId}/bookmarks`,{method:"PUT",body:n,baseURL:e,headers:U(t.token)})}async function mo(e,t){return P("/auth/login/start",{method:"POST",body:{publicKey:t},baseURL:e})}async function ho(e,t){return P("/auth/login/complete",{method:"POST",body:{namespace:"movie-web",...t},baseURL:e})}function fo(e){var t,n;return{duration:((t=e.progress)==null?void 0:t.duration)??0,watched:((n=e.progress)==null?void 0:n.watched)??0,tmdbId:e.tmdbId,meta:{title:e.title??"",type:e.type??"",year:e.year??NaN,poster:e.poster},episodeId:e.episodeId,seasonId:e.seasonId,episodeNumber:e.episodeNumber,seasonNumber:e.seasonNumber}}function go(e,t){var n,r;return t.type==="show"?Object.entries(t.episodes).flatMap(a=>{var l,c;let[i,o]=a;return{duration:((l=t.progress)==null?void 0:l.duration)??o.progress.duration,watched:((c=t.progress)==null?void 0:c.watched)??o.progress.watched,tmdbId:e,meta:{title:t.title??"",type:t.type??"",year:t.year??NaN,poster:t.poster},episodeId:o.id,seasonId:o.seasonId,episodeNumber:o.number,seasonNumber:t.seasons[o.seasonId].number,updatedAt:new Date(o.updatedAt).toISOString()}}):[{duration:((n=t.progress)==null?void 0:n.duration)??0,watched:((r=t.progress)==null?void 0:r.watched)??0,tmdbId:e,updatedAt:new Date(t.updatedAt).toISOString(),meta:{title:t.title??"",type:t.type??"",year:t.year??NaN,poster:t.poster}}]}async function xo(e,t,n){return P(`/users/${t.userId}/progress/${n.tmdbId}`,{method:"PUT",headers:U(t.token),baseURL:e,body:n})}async function po(e,t,n,r,a){await P(`/users/${t.userId}/progress/${n}`,{method:"DELETE",headers:U(t.token),baseURL:e,body:{episodeId:r,seasonId:a}})}async function bo(e,t){return P("/auth/register/start",{method:"POST",body:{captchaToken:t},baseURL:e})}async function yo(e,t){return P("/auth/register/complete",{method:"POST",body:{namespace:"movie-web",...t},baseURL:e})}async function km(e,t){return P(`/users/${t.userId}/sessions`,{headers:U(t.token),baseURL:e})}async function Nm(e,t,n){return P(`/sessions/${t.sessionId}`,{method:"PATCH",headers:U(t.token),body:n,baseURL:e})}async function vo(e,t,n){return P(`/sessions/${n}`,{method:"DELETE",headers:U(t),baseURL:e})}function Os(e,t,n){return P(`/users/${t.userId}/settings`,{method:"PUT",body:n,baseURL:e,headers:U(t.token)})}function jo(e,t){return P(`/users/${t.userId}/settings`,{method:"GET",baseURL:e,headers:U(t.token)})}function wo(e){const t=e.map(n=>{const r={...n.meta,updatedAt:new Date(n.updatedAt).getTime()};return[n.tmdbId,r]});return Object.fromEntries(t)}function ko(e){const t={};return e.forEach(n=>{t[n.tmdbId]||(t[n.tmdbId]={title:n.meta.title,poster:n.meta.poster,type:n.meta.type,updatedAt:new Date(n.updatedAt).getTime(),episodes:{},seasons:{},year:n.meta.year});const r=t[n.tmdbId];r.type==="movie"&&(r.progress={duration:Number(n.duration),watched:Number(n.watched)}),r.type==="show"&&n.season.id&&n.episode.id&&(r.seasons[n.season.id]={id:n.season.id,number:n.season.number??0,title:""},r.episodes[n.episode.id]={id:n.episode.id,number:n.episode.number??0,title:"",progress:{duration:Number(n.duration),watched:Number(n.watched)},seasonId:n.season.id,updatedAt:new Date(n.updatedAt).getTime()})}),t}async function _n(e,t){return P("/users/@me",{headers:U(t),baseURL:e})}async function Sm(e,t,n){return P(`/users/${t.userId}`,{method:"PATCH",headers:U(t.token),body:n,baseURL:e})}async function Cm(e,t){return P(`/users/${t.userId}`,{headers:U(t.token),baseURL:e})}async function No(e,t){return P(`/users/${t.userId}/bookmarks`,{headers:U(t.token),baseURL:e})}async function So(e,t){return P(`/users/${t.userId}/progress`,{headers:U(t.token),baseURL:e})}const tn=K(ce(G(e=>({theme:null,setTheme(t){e(n=>{n.theme=t})}})),{name:"__MW::theme"}));function Co(e){const t=tn(r=>r.theme),n=t?`theme-${t}`:void 0;return s.jsxs("div",{className:n,children:[e.applyGlobal?s.jsx(le,{children:s.jsx("body",{className:n})}):null,e.children]})}function Eo(){const e=!!F(h=>h.account),t=F(h=>h.setAccount),n=F(h=>h.removeAccount),r=W(h=>h.clear),a=V(h=>h.clear),i=tn(h=>h.setTheme),o=_e(h=>h.setLanguage),l=O(h=>h.importSubtitleLanguage),c=W(h=>h.replaceBookmarks),u=V(h=>h.replaceItems),m=d.useCallback(async(h,x,v,b)=>{const y={token:h.token,userId:x.id,sessionId:h.session.id,deviceName:v.device,profile:x.profile,seed:b};return t(y),y},[t]),g=d.useCallback(async()=>{n(),r(),a()},[n,r,a]),f=d.useCallback(async(h,x,v,b,y)=>{c(wo(b)),u(ko(v)),y.applicationLanguage&&o(y.applicationLanguage),y.defaultSubtitleLanguage&&l(y.defaultSubtitleLanguage),y.applicationTheme&&i(y.applicationTheme)},[c,u,o,l,i]);return{loggedIn:e,login:m,logout:g,syncData:f}}function me(){return F(t=>t.backendUrl)??M().BACKEND_URL}function we(){const e=F(f=>f.account),t=F(f=>{var h;return(h=f.account)==null?void 0:h.profile}),n=!!F(f=>f.account),r=me(),{logout:a,login:i,syncData:o}=Eo(),l=d.useCallback(async f=>{const h=await Rn(f.mnemonic),x=Ot(h.publicKey),{challenge:v}=await mo(r,x),b=await Pn(h,v),y=await ho(r,{challenge:{code:v,signature:b},publicKey:x,device:await Mn(f.userData.device,h.seed)}),N=await _n(r,y.token),T=_t(h.seed);return i(y,N.user,N.session,T)},[i,r]),c=d.useCallback(async()=>{if(e){try{await vo(r,e.token,e.sessionId)}catch{}await a()}},[a,r,e]),u=d.useCallback(async f=>{const{challenge:h}=await bo(r,f.recaptchaToken),x=await Rn(f.mnemonic),v=await Pn(x,h),b=await yo(r,{challenge:{code:h,signature:v},publicKey:Ot(x.publicKey),device:await Mn(f.userData.device,x.seed),profile:f.userData.profile});return i(b,b.user,b.session,_t(x.seed))},[r,i]),m=d.useCallback(async(f,h,x)=>{if(Object.keys(h).length===0&&Object.keys(x).length===0)return;const v=Object.entries(h).flatMap(y=>{let[N,T]=y;return go(N,T)}),b=Object.entries(x).map(y=>{let[N,T]=y;return no(N,T)});await co(r,f,v),await uo(r,f,b)},[r]),g=d.useCallback(async f=>{var y,N,T;let h;try{h=await _n(r,f.token)}catch(L){const w=L;if(((y=w==null?void 0:w.response)==null?void 0:y.status)===401||((N=w==null?void 0:w.response)==null?void 0:N.status)===403||((T=w==null?void 0:w.response)==null?void 0:T.status)===400){await c();return}throw console.error(L),L}const x=await No(r,f),v=await So(r,f),b=await jo(r,f);o(h.user,h.session,v,x,b)},[r,o,c]);return{loggedIn:n,profile:t,login:l,logout:c,register:u,restore:g,importData:m}}const Io=12*60*60*1e3;function Lo(){const{account:e}=F(),{restore:t}=we(),n=d.useRef(!1);return cs(()=>{e&&t(e)},Io),ot(async()=>{n.current||!e||await t(e).finally(()=>{n.current=!0})},[])}function nn(e){return s.jsxs("div",{className:"bg-pill-background bg-opacity-50 px-4 py-2 rounded-full text-white flex justify-center items-center",children:[s.jsx(E,{icon:e.icon??j.WAND,className:"mr-3 text-xl text-type-link"}),e.children]})}function Pe(e){return s.jsx("h2",{className:C("text-white text-3xl font-bold text-opacity-100 mt-6",e.className),children:e.children})}const mt="pb-4 border-b border-utils-divider border-opacity-50";function sn(e){return s.jsx("h1",{className:["text-3xl lg:text-5xl font-bold text-white mb-9",e.border?mt:null,e.className??""].join(" "),children:e.children})}function De(e){return s.jsx("h2",{className:["text-xl lg:text-2xl font-bold text-white mt-20 mb-9",e.border?mt:null,e.className??""].join(" "),children:e.children})}function Em(e){return s.jsx("h2",{className:["text-lg lg:text-xl font-bold text-white mb-3",e.border?mt:null,e.className??""].join(" "),children:e.children})}function ve(e){return s.jsx("p",{className:["text-type-text my-9 font-medium",e.border?mt:null,e.className??""].join(" "),children:e.children})}function rn(e){return s.jsx("div",{className:C("w-full p-6 text-center flex flex-col items-center",e.maxWidth??"max-w-[28rem]"),children:e.children})}function an(e){return s.jsx("div",{className:"w-full h-full flex justify-center items-center flex-col",children:e.children})}function To(e,t){return e==="slide-down"?{leave:`transition-[transform,opacity] ${t}`,leaveFrom:"opacity-100 translate-y-0",leaveTo:"-translate-y-4 opacity-0",enter:`transition-[transform,opacity] ${t}`,enterFrom:"opacity-0 -translate-y-4",enterTo:"translate-y-0 opacity-100"}:e==="slide-up"?{leave:`transition-[transform,opacity] ${t}`,leaveFrom:"opacity-100 translate-y-0",leaveTo:"translate-y-4 opacity-0",enter:`transition-[transform,opacity] ${t}`,enterFrom:"opacity-0 translate-y-4",enterTo:"translate-y-0 opacity-100"}:e==="slide-full-left"?{leave:`transition-[transform] ${t}`,leaveFrom:"translate-x-0",leaveTo:"-translate-x-full",enter:`transition-[transform] ${t}`,enterFrom:"-translate-x-full",enterTo:"translate-x-0"}:e==="slide-full-right"?{leave:`transition-[transform] ${t}`,leaveFrom:"translate-x-0",leaveTo:"translate-x-full",enter:`transition-[transform] ${t}`,enterFrom:"translate-x-full",enterTo:"translate-x-0"}:e==="fade"?{leave:`transition-[transform,opacity] ${t}`,leaveFrom:"opacity-100",leaveTo:"opacity-0",enter:`transition-[transform,opacity] ${t}`,enterFrom:"opacity-0",enterTo:"opacity-100"}:{}}function z(e){const t=e.durationClass??"duration-200",n=To(e.animation,t);return e.isChild?s.jsx(It.Child,{as:d.Fragment,...n,children:s.jsx("div",{className:e.className,style:e.style,children:e.children})}):s.jsx(It,{show:e.show,as:d.Fragment,...n,children:s.jsx("div",{className:e.className,style:e.style,children:e.children})})}function Ro(){const e=Ae();return d.useMemo(()=>Object.fromEntries(new URLSearchParams(e.search).entries()),[e.search])}function on(e){const t=Ro(),n=Ae(),r=ee(),a=t[e]??null,i=d.useCallback(o=>{const l=new URLSearchParams(n.search);o?l.set(e,o):l.delete(e),r({search:l.toString()})},[e,n.search,r]);return[a,i]}const je=K(G(e=>({transition:null,routes:{},anchorPoint:null,setTransition(t){e(n=>{n.transition=t})},registerRoute(t){e(n=>{n.routes[t.id]=t})},setAnchorPoint(t){e(n=>{n.anchorPoint=t})}})));function he(e,t){return[t??"",...e.split("/")].filter(r=>r.length>0)}function fe(e){return`/${e.join("/")}`}function Po(e){const[t]=on("r"),n=je(i=>i.setAnchorPoint),r=d.useMemo(()=>!!t&&t.startsWith(`/${e}`),[t,e]),a=d.useCallback(()=>{if(!r)return;const i=document.getElementById(`__overlayRouter::${e}`);if(i){const o=i.getBoundingClientRect();n({h:o.height,w:o.width,x:o.x,y:o.y})}},[r,n,e]);d.useEffect(()=>{a()},[r,a]),d.useEffect(()=>{function i(){a()}return window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[a])}function ke(e){const[t,n]=on("r"),r=je(x=>x.transition),a=je(x=>x.setTransition),i=!!t&&t.startsWith(`/${e}`);function o(x){return fe(he(x,e))}function l(x){const v=t,b=fe(he(x,e));a({from:v??"/",to:b}),n(b)}function c(x){if(!r)return"none";const v=fe(he(x,e));return v===r.to&&r.from.startsWith(r.to)||v===r.from&&r.to.startsWith(r.from)?"yes":"no"}function u(x){return i&&t===fe(he(x,e))}function m(){return i}const g=d.useCallback(x=>{t&&!x&&n(null),a(null)},[n,t,a]),f=d.useCallback(function(){let x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"/";a(null),n(fe(he(x,e)))},[e,n,a]);return{activeRoute:i?fe(he(t.slice(`/${e}`.length))):"/",showBackwardsTransition:c,isCurrentPage:u,isOverlayActive:m,navigate:l,close:g,open:f,makePath:o,currentRoute:t}}function D(e){const t=ke(e);return{id:e,route:t.activeRoute,isRouterActive:t.isOverlayActive(),open:t.open,close:t.close,navigate:t.navigate}}function Ao(e){const t=ke("hello world :)"),n=d.useRef(t);return d.useEffect(()=>{const r=n.current;return r.close(),()=>{r.close()}},[]),s.jsx("div",{className:"popout-location",children:e.children})}function Ds(e){const[t,n]=d.useState(null),r=d.useRef(null),a=e.close;return d.useEffect(()=>{var o;const i=(o=r.current)==null?void 0:o.closest(".popout-location");n(i??document.body)},[]),s.jsx("div",{ref:r,children:t?Xr.createPortal(s.jsx(z,{show:e.show,animation:"none",children:s.jsx(Zr,{children:s.jsxs("div",{className:"popout-wrapper fixed overflow-hidden pointer-events-auto inset-0 z-[999] select-none",children:[s.jsx(z,{animation:"fade",isChild:!0,children:s.jsx("div",{onClick:a,className:C({"absolute inset-0":!0,"bg-black opacity-90":e.darken})})}),s.jsxs(z,{animation:"slide-up",className:"absolute inset-0 pointer-events-none",isChild:!0,children:[s.jsx("div",{tabIndex:1,className:"focus:ring-0 focus:outline-none opacity-0"}),e.children]})]})})}),t):null})}function Bs(e){const t=ke(e.id),n=t.close;Po(e.id);const r=d.useCallback(()=>{n()},[n]);return s.jsx(Ds,{close:r,show:t.isOverlayActive(),darken:e.darken,children:e.children})}function Fs(e){const[t,n]=on("m"),r=d.useCallback(()=>n(e),[e,n]),a=d.useCallback(()=>n(null),[n]);return{id:e,isShown:t===e,show:r,hide:a}}function Im(e){return s.jsx("div",{className:"w-full max-w-[30rem] m-4",children:s.jsx("div",{className:"w-full bg-dropdown-background rounded-xl p-8 pointer-events-auto",children:e.children})})}function Mo(e){const t=Fs(e.id);return s.jsxs(Ds,{darken:!0,close:t.hide,show:t.isShown,children:[s.jsx(le,{children:s.jsx("html",{"data-no-scroll":!0})}),s.jsx("div",{className:"flex absolute inset-0 items-center justify-center flex-col",children:e.children})]})}const _o=function(t){const[n,r]=d.useState(!1),a=d.useRef(null),{t:i}=S();let o=null;typeof t.error=="string"?o=t.error:t.error.key?o=`${t.error.type}: ${i(t.error.key)}`:t.error.message&&(o=`${t.error.type}: ${i(t.error.message)}`);function l(){!t.error||!navigator.clipboard||(navigator.clipboard.writeText(`\`\`\`${o}\`\`\``),r(!0),a.current&&clearTimeout(a.current),a.current=setTimeout(()=>r(!1),2e3))}return s.jsxs("div",{className:"bg-errors-card w-full rounded-lg p-6 text-left",children:[s.jsxs("div",{className:"border-errors-border flex items-center justify-between border-b pb-2",children:[s.jsx("span",{className:"font-medium text-white",children:i("errors.details")}),s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx(_,{theme:"secondary",padding:"p-2 h-10 min-w-[40px] md:px-4",onClick:()=>l(),children:n?s.jsxs(s.Fragment,{children:[s.jsx(E,{icon:j.CHECKMARK,className:"text-xs"}),s.jsx("span",{className:"hidden min-[400px]:inline-block ml-3",children:i("actions.copied")})]}):s.jsxs(s.Fragment,{children:[s.jsx(E,{icon:j.COPY,className:"text-2xl"}),s.jsx("span",{className:"hidden min-[400px]:inline-block ml-3",children:i("actions.copy")})]})}),s.jsx(_,{theme:"secondary",padding:"p-2 md:px-2",onClick:t.onClose,children:s.jsx(E,{icon:j.X,className:"text-2xl"})})]})]}),s.jsx("div",{className:"pointer-events-auto mt-4 h-60 select-text overflow-y-auto whitespace-pre text-left",children:o})]})},Us=_o;function Oo(e){return!e.show||!e.error?null:s.jsx("div",{className:"fixed inset-0 flex h-full w-full items-center justify-center bg-black bg-opacity-30 p-12",children:s.jsx("div",{className:"w-full max-w-2xl",children:s.jsx(Us,{error:e.error,onClose:e.onClose})})})}function Do(e){return e.error?s.jsx(Mo,{id:e.id,children:s.jsx("div",{className:"pointer-events-auto w-11/12 max-w-2xl",children:s.jsx(Us,{error:e.error,onClose:e.onClose})})}):null}function Bo(e){const{t}=S(),[n,r]=d.useState(!1),a=5,i=(e.errorInfo.componentStack||"").split(`
`).slice(0,a),o=`${e.error.toString()}
${i.join(`
`)}`;return s.jsx("div",{className:"relative flex min-h-screen flex-1 flex-col",children:s.jsx("div",{className:"flex h-full flex-1 flex-col items-center justify-center p-5 text-center",children:s.jsx(an,{children:s.jsxs(rn,{maxWidth:"max-w-2xl w-9/10",children:[s.jsx(nn,{icon:j.EYE_SLASH,children:t("errors.badge")}),s.jsx(Pe,{children:t("errors.title")}),s.jsx(ve,{children:e.error.toString()}),s.jsx(Oo,{show:n,onClose:()=>r(!1),error:o}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(Tn,{theme:"secondary",className:"mt-6 p-2.5 md:px-12",onClick:()=>window.location.reload(),children:t("errors.reloadPage")}),s.jsx(Tn,{theme:"purple",className:"mt-6 p-2.5 md:px-12",onClick:()=>r(!0),children:t("errors.showError")})]})]})})})})}class Fo extends d.Component{constructor(t){super(t),this.state={error:void 0}}componentDidCatch(t,n){console.error("Render error caught",t,n),this.setState(r=>({...r,error:{error:t,errorInfo:n}}))}render(){return this.state.error?s.jsx(Bo,{error:this.state.error.error,errorInfo:this.state.error.errorInfo}):this.props.children}}function Ne(e){const{t}=S();return s.jsxs("div",{className:C("flex items-center space-x-2 rounded-full px-4 py-2 text-type-logo",e.backgroundClass??"bg-pill-background bg-opacity-50",e.clickable?"transition-[transform,background-color] hover:scale-105 hover:bg-pill-backgroundHover hover:text-type-logo active:scale-95":""),children:[s.jsx(E,{className:"text-xl",icon:j.MOVIE_WEB}),s.jsx("span",{className:["font-semibold text-white",e.hideTextOnMobile?"hidden sm:block":""].join(" "),children:t("global.name")})]})}function $s(e){return s.jsx("div",{className:`mx-auto max-w-full px-8 ${e.ultraWide?"w-[1300px] sm:px-16":"w-[900px] sm:px-8"} ${e.classNames||""}`,children:e.children})}function ht(e){return s.jsx("div",{className:`mx-auto w-[600px] max-w-full px-8 sm:px-0 ${e.classNames||""}`,children:e.children})}function ft(e){const{t}=S(),n=t(e.k),r=t("global.pages.pagetitle",{title:n});return s.jsx(le,{children:s.jsx("title",{children:e.subpage?r:n})})}function Vs(){return!!M().DMCA_EMAIL}function Uo(){const{t:e}=S();return s.jsxs(Be,{children:[s.jsx(ft,{subpage:!0,k:"global.pages.dmca"}),s.jsxs(ht,{children:[s.jsx(sn,{children:e("screens.dmca.title")}),s.jsx(ve,{children:e("screens.dmca.text")}),s.jsxs(ve,{className:"flex space-x-3 items-center",children:[s.jsx(E,{icon:j.MAIL}),s.jsx("span",{children:M().DMCA_EMAIL??""})]})]})]})}function Dt(e){const t=ee(),n=d.useCallback(()=>{e.to&&t(e.to)},[t,e.to]);return s.jsxs("a",{href:e.href,target:e.href?"_blank":void 0,rel:"noreferrer",className:"tabbable rounded py-2 px-3 inline-flex cursor-pointer items-center space-x-3 transition-colors duration-200 hover:text-type-emphasis",onClick:e.to?n:void 0,children:[s.jsx(E,{icon:e.icon,className:"text-2xl"}),s.jsx("span",{className:"font-medium",children:e.children})]})}function On(){const{t:e}=S();return Vs()?s.jsx(Dt,{to:"/dmca",icon:j.DRAGON,children:e("footer.links.dmca")}):null}function $o(){const{t:e}=S();return s.jsx("footer",{className:"mt-16 border-t border-type-divider py-16 md:py-8",children:s.jsxs($s,{ultraWide:!0,classNames:"grid md:grid-cols-2 gap-16 md:gap-8",children:[s.jsxs("div",{children:[s.jsx("div",{className:"inline-block",children:s.jsx(Ne,{})}),s.jsx("p",{className:"mt-4 lg:max-w-[400px]",children:e("footer.tagline")})]}),s.jsxs("div",{className:"md:text-right",children:[s.jsx("h3",{className:"font-semibold text-type-emphasis",children:e("footer.legal.disclaimer")}),s.jsx("p",{className:"mt-3",children:e("footer.legal.disclaimerText")})]}),s.jsxs("div",{className:"flex flex-wrap gap-[0.5rem] -ml-3",children:[s.jsx(Dt,{icon:j.GITHUB,href:M().GITHUB_LINK,children:e("footer.links.github")}),s.jsx(Dt,{icon:j.DISCORD,href:M().DISCORD_LINK,children:e("footer.links.discord")}),s.jsx("div",{className:"inline md:hidden",children:s.jsx(On,{})})]}),s.jsx("div",{className:"hidden items-center justify-end md:flex -mr-3",children:s.jsx(On,{})})]})})}function Hs(e){return s.jsxs("div",{className:["flex min-h-screen flex-col",e.className||""].join(" "),children:[s.jsx("div",{style:{flex:"1 0 auto"},children:e.children}),s.jsx($o,{})]})}function Vo(e){return s.jsxs("div",{className:"relative inline-block",children:[s.jsx("div",{className:C(e.sizeClass,"rounded-full overflow-hidden flex items-center justify-center text-white"),style:{background:`linear-gradient(to bottom right, ${e.profile.colorA}, ${e.profile.colorB})`},children:s.jsx(ds,{className:e.iconClass,icon:e.profile.icon})}),e.bottom?s.jsx("div",{className:"absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2",children:e.bottom}):null]})}function Ws(e){const t=F(),n=d.useMemo(()=>t.account&&t.account.seed?en(t.account.seed):null,[t]);if(!t.account||t.account===null)return null;const r=n?_s(t.account.deviceName,n):"...";return s.jsxs(s.Fragment,{children:[s.jsx(Vo,{profile:t.account.profile,sizeClass:e.sizeClass??"w-[1.5rem] h-[1.5rem] ssm:w-[2rem] ssm:h-[2rem]",iconClass:e.iconClass,bottom:e.bottom}),e.withName&&n?s.jsx("span",{className:"hidden md:inline-block",children:r.length>=20?`${r.slice(0,19)}…`:r}):null]})}function Ho(e){return s.jsx("div",{className:"relative inline-block p-1 text-type-dimmed",children:s.jsx(E,{className:e.iconClass??"text-base ssm:text-xl",icon:j.MENU})})}const Wo=function(t){const n=t.clickable?"cursor-pointer hover:scale-110 hover:bg-pill-backgroundHover hover:text-white active:scale-125":"",r=t.transparent?"bg-opacity-0 hover:bg-opacity-50":"",a=t.active?"bg-pill-backgroundHover text-white":"",i=t.downsized?"h-10 w-10":"h-12 w-12";return s.jsx("div",{className:t.className||void 0,onClick:t.onClick,children:s.jsx("div",{className:`flex items-center justify-center rounded-full border-2 border-transparent bg-pill-background bg-opacity-50 transition-[background-color,color,transform,border-color] duration-75 ${r} ${n} ${a} ${i}`,children:s.jsx(E,{icon:t.icon})})})},st=Wo;function Dn(){return s.jsx("hr",{className:"border-0 w-full h-px bg-dropdown-border"})}const zo=function(t){const n=ee(),r=a=>{a.startsWith("http")?window.open(a,"_blank"):n(a)};return s.jsx("a",{tabIndex:0,href:t.href,onClick:a=>{var i;a.preventDefault(),t.href?r(t.href):(i=t.onClick)==null||i.call(t)},className:t.className,children:t.children})},zs=zo;function ge(e){return s.jsxs(zs,{onClick:e.onClick,href:e.href,className:C("tabbable cursor-pointer flex gap-3 items-center m-3 p-1 rounded font-medium transition-colors duration-100",e.highlight?"text-dropdown-highlight hover:text-dropdown-highlightHover":"text-dropdown-text hover:text-white",e.className),children:[e.icon?s.jsx(E,{icon:e.icon,className:"text-xl"}):null,e.children]})}function wt(e){return s.jsx(zs,{href:e.href,className:"tabbable w-11 h-11 rounded-full bg-dropdown-contentBackground text-dropdown-text hover:text-white transition-colors duration-100 flex justify-center items-center",children:s.jsx(E,{className:"text-2xl",icon:e.icon})})}function Qo(e){const{t}=S(),[n,r]=d.useState(!1),a=F(u=>{var m;return(m=u.account)==null?void 0:m.deviceName}),i=F(u=>{var m;return(m=u.account)==null?void 0:m.seed}),o=d.useMemo(()=>i?en(i):null,[i]),{logout:l}=we();d.useEffect(()=>{function u(m){m.target.closest(".is-dropdown")||r(!1)}return window.addEventListener("click",u),()=>window.removeEventListener("click",u)},[]);const c=d.useCallback(()=>{r(u=>!u)},[]);return s.jsxs("div",{className:"relative is-dropdown",children:[s.jsxs("div",{className:"cursor-pointer tabbable rounded-full flex gap-2 text-white items-center py-2 px-3 bg-pill-background bg-opacity-50 hover:bg-pill-backgroundHover transition-[background,transform] duration-100 hover:scale-105",tabIndex:0,onClick:c,onKeyUp:u=>u.key==="Enter"&&c(),children:[e.children,s.jsx(E,{className:C("text-xl transition-transform duration-100",n?"rotate-180":""),icon:j.CHEVRON_DOWN})]}),s.jsx(z,{animation:"slide-down",show:n,children:s.jsxs("div",{className:"rounded-lg absolute w-64 bg-dropdown-altBackground top-full mt-3 right-0",children:[a&&o?s.jsxs(ge,{className:"text-white",href:"/settings",children:[s.jsx(Ws,{}),_s(a,o)]}):s.jsx(ge,{href:"/login",icon:j.RISING_STAR,highlight:!0,children:t("navigation.menu.register")}),s.jsx(Dn,{}),s.jsx(ge,{href:"/settings",icon:j.SETTINGS,children:t("navigation.menu.settings")}),s.jsx(ge,{href:"/about",icon:j.CIRCLE_QUESTION,children:t("navigation.menu.about")}),s.jsx(ge,{href:M().DONATION_LINK,icon:j.DONATION,children:t("navigation.menu.donation")}),a?s.jsx(ge,{className:"!text-type-danger opacity-75 hover:opacity-100",icon:j.LOGOUT,onClick:l,children:t("navigation.menu.logout")}):null,s.jsx(Dn,{}),s.jsxs("div",{className:"my-4 flex justify-center items-center gap-4",children:[s.jsx(wt,{href:M().DISCORD_LINK,icon:j.DISCORD}),s.jsx(wt,{href:M().GITHUB_LINK,icon:j.GITHUB}),s.jsx(wt,{href:M().DONATION_LINK,icon:j.DONATION})]})]})})]})}class Ko{constructor(t){this.x=0,this.y=0,this.radius=0,this.direction=0,this.speed=0,this.lifetime=0,this.ran=0,this.image=null,this.size=10;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{horizontalMotion:!1,sizeRange:[10,10]};n.imgSrc&&(this.image=new Image,this.image.src=n.imgSrc),this.options=n,this.reset(t),this.initialize(t)}reset(t){this.x=Math.round(Math.random()*t.width/2+t.width/4),this.y=Math.random()*100+5,this.radius=1+Math.floor(Math.random()*.5),this.direction=Math.random()*Math.PI/2+Math.PI/4,this.speed=.02+Math.random()*.08;const n=60;this.lifetime=n*3+Math.random()*(n*30),this.size=this.options.sizeRange?Math.random()*(this.options.sizeRange[1]-this.options.sizeRange[0])+this.options.sizeRange[0]:10,this.options.horizontalMotion&&(this.direction=Math.random()<=.5?0:Math.PI,this.lifetime=30*n),this.ran=0}initialize(t){this.ran=Math.random()*this.lifetime;const n=this.speed;this.speed=Math.random()*this.lifetime*n,this.update(t),this.speed=n}update(t){this.ran+=1;const n=this.speed*Math.cos(this.direction),r=this.speed*Math.sin(this.direction);this.x+=n,this.y+=r,this.ran>this.lifetime&&this.reset(t)}render(t){const n=t.getContext("2d");if(!n)return;n.save(),n.beginPath();const r=this.ran/this.lifetime,a=(r-r*r)*4;if(n.globalAlpha=Math.max(0,a*.8),this.image){n.translate(this.x,this.y);const i=this.size,o=this.image.naturalWidth/this.image.naturalHeight*i;n.rotate(this.direction-Math.PI),n.drawImage(this.image,-i/2,o,o,i)}else n.ellipse(this.x,this.y,this.radius,this.radius*1.5,this.direction,0,Math.PI*2),n.fillStyle="white",n.fill();n.restore()}}function Go(){const e=d.useRef(null);return d.useEffect(()=>{var x,v;if(!e.current)return;const t=e.current,n=[];t.width=t.scrollWidth,t.height=t.scrollHeight;const r=20;let a=r,i=[];const o=new Date,l=o.getMonth(),c=o.getDate();l===11&&c>=24&&c<=26&&(i=[{image:"/lightbar-images/snowflake.svg",sizeRange:[4,15]},{image:"/lightbar-images/santa.png",sizeRange:[15,30]}]),Math.floor(Math.random()*600)===69&&(i=[{image:"/lightbar-images/fishie.png",sizeRange:[10,11]}],a=r/2);for(let b=0;b<r;b+=1){const y=i&&b<=a,N=Math.floor(Math.random()*i.length),T=(x=i[N])==null?void 0:x.sizeRange,L=(v=i[N])==null?void 0:v.image,w=new Ko(t,{imgSrc:y?L:void 0,horizontalMotion:L==null?void 0:L.includes("fishie"),sizeRange:T});n.push(w)}let m=!0,g=null;function f(){if(t.getContext("2d")){if(m){for(const y of n)y.update(t);m=!1}t.width=t.scrollWidth,t.height=t.scrollHeight;for(const y of n)y.render(t);g=requestAnimationFrame(f)}}const h=setInterval(()=>{m=!0},1e3/120);return f(),()=>{g&&cancelAnimationFrame(g),clearInterval(h)}},[]),s.jsx("canvas",{className:"particles",ref:e})}const qo=function(t){return s.jsx("div",{className:"absolute inset-0 w-full h-[680px] overflow-hidden pointer-events-none -mt-64",children:s.jsx("div",{className:"max-w-screen w-full h-[680px] relative pt-64",children:s.jsx("div",{className:t.className,children:s.jsxs("div",{className:"lightbar",children:[s.jsx(Go,{}),s.jsx("div",{className:"lightbar-visual"})]})})})})},Yo=qo,ne=K(G(e=>({banners:[],isOnline:!0,location:null,updateOnline(t){e(n=>{n.isOnline=t})},setLocation(t){e(n=>{n.location=t})},showBanner(t){e(n=>{n.banners.find(r=>r.id===t)||n.banners.push({id:t,height:0})})},hideBanner(t){e(n=>{n.banners=n.banners.filter(r=>r.id!==t)})},updateHeight(t,n){e(r=>{const a=r.banners.find(i=>i.id===t);a&&(a.height=n)})}})));function gt(e){const t=e??null,n=ne(i=>i.banners),r=ne(i=>i.location),a=n.reduce((i,o)=>i+o.height,0);return t!==r?0:a}function Jo(e){const[t,{height:n}]=ea(),r=ne(o=>o.updateHeight),a=ne(o=>o.showBanner),i=ne(o=>o.hideBanner);return d.useEffect(()=>(a(e),()=>{i(e)}),[a,i,e]),d.useEffect(()=>{r(e,n)},[n,e,r]),[t]}const Xo=function(t){const n=gt(),{loggedIn:r}=we();return s.jsxs(s.Fragment,{children:[t.noLightbar?null:s.jsx("div",{className:"absolute inset-x-0 top-0 flex h-[88px] items-center justify-center",style:{top:`${n}px`},children:s.jsx("div",{className:"absolute inset-x-0 -mt-[22%] flex items-center sm:mt-0",children:s.jsx(Yo,{})})}),s.jsx("div",{className:"fixed z-[20] pointer-events-none left-0 right-0 top-0 min-h-[150px]",style:{top:`${n}px`},children:s.jsxs("div",{className:C("fixed left-0 right-0 h-20 flex items-center",t.doBackground?"bg-background-main border-b border-utils-divider border-opacity-50":null),children:[t.doBackground?s.jsx("div",{className:"absolute w-full h-full inset-0 overflow-hidden",children:s.jsx(xt,{positionClass:"absolute"})}):null,s.jsx("div",{className:"opacity-0 absolute inset-0 block h-20 pointer-events-auto"}),s.jsx("div",{className:`${t.bg?"opacity-100":"opacity-0"} absolute inset-0 block h-24 bg-background-main transition-opacity duration-300`,children:s.jsx("div",{className:"absolute -bottom-24 h-24 w-full bg-gradient-to-b from-background-main to-transparent"})})]})}),s.jsx("div",{className:"fixed pointer-events-none left-0 right-0 z-[60] top-0 min-h-[150px]",style:{top:`${n}px`},children:s.jsx("div",{className:C("fixed left-0 right-0 flex items-center"),children:s.jsxs("div",{className:"px-7 py-5 relative z-[60] flex flex-1 items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-1.5 ssm:space-x-3 pointer-events-auto",children:[s.jsx(qt,{className:"block tabbable rounded-full text-xs ssm:text-base",to:"/",children:s.jsx(Ne,{clickable:!0})}),s.jsx("a",{href:M().DISCORD_LINK,target:"_blank",rel:"noreferrer",className:"text-xl text-white tabbable rounded-full",children:s.jsx(st,{icon:j.DISCORD,clickable:!0,downsized:!0})}),s.jsx("a",{href:M().GITHUB_LINK,target:"_blank",rel:"noreferrer",className:"text-xl text-white tabbable rounded-full",children:s.jsx(st,{icon:j.GITHUB,clickable:!0,downsized:!0})})]}),s.jsx("div",{className:"relative pointer-events-auto",children:s.jsx(Qo,{children:r?s.jsx(Ws,{withName:!0}):s.jsx(Ho,{})})})]})})})]})},ln=Xo;function xt(e){return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:C(e.positionClass??"fixed","top-0 -right-48 rotate-[32deg] w-[50rem] h-[15rem] rounded-[70rem] bg-background-accentA blur-[100px] pointer-events-none opacity-25")}),s.jsx("div",{className:C(e.positionClass??"fixed","top-0 right-48 rotate-[32deg] w-[50rem] h-[15rem] rounded-[70rem] bg-background-accentB blur-[100px] pointer-events-none opacity-25")})]})}function Be(e){return s.jsxs("div",{className:"bg-background-main",style:{backgroundImage:"linear-gradient(to bottom, var(--tw-gradient-from), var(--tw-gradient-to) 800px)"},children:[s.jsx(xt,{}),s.jsxs(Hs,{children:[s.jsx(ln,{doBackground:!0,noLightbar:!0}),s.jsx("div",{className:"mt-40 relative",children:e.children})]})]})}function Zo(){const{t:e}=S();return s.jsxs("div",{className:"flex flex-col justify-center items-center h-screen text-center font-medium",children:[s.jsx(xt,{}),s.jsx("div",{className:"right-[calc(2rem+env(safe-area-inset-right))] top-6 absolute",children:s.jsx(Ne,{})}),s.jsx(Oe,{}),s.jsx("p",{className:"max-w-[19rem] mt-3 mb-12 text-type-secondary",children:e("screens.migration.inProgress")})]})}function Qs(e){return s.jsxs("div",{className:"flex flex-col justify-center items-center h-screen text-center font-medium",children:[s.jsx(xt,{}),s.jsx("div",{className:"right-[calc(2rem+env(safe-area-inset-right))] top-6 absolute",children:s.jsx(Ne,{})}),e.iconSlot?e.iconSlot:null,s.jsx("div",{className:"max-w-[19rem] mt-3 mb-12 text-type-secondary",children:e.children})]})}const el="modulepreload",tl=function(e){return"/"+e},Bn={},pt=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){const i=document.getElementsByTagName("link");a=Promise.all(n.map(o=>{if(o=tl(o),o in Bn)return;Bn[o]=!0;const l=o.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(!!r)for(let g=i.length-1;g>=0;g--){const f=i[g];if(f.href===o&&(!l||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const m=document.createElement("link");if(m.rel=l?"stylesheet":el,l||(m.as="script",m.crossOrigin=""),m.href=o,document.head.appendChild(m),l)return new Promise((g,f)=>{m.addEventListener("load",g),m.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}return a.then(()=>t()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function nl(){const e=ne(n=>n.updateOnline),t=d.useRef(!0);d.useEffect(()=>{let n=0,r=null;const a=setInterval(()=>{if(n+=1,t.current&&n<10)return;n=0,r&&r.abort(),r=new AbortController;const i=r.signal;fetch("/ping.txt",{signal:i}).then(()=>{e(!0),t.current=!0}).catch(o=>{o.name!=="AbortError"&&(e(!1),t.current=!1)})},5e3);return()=>{clearInterval(a),r&&r.abort()}},[e])}const sl=function(t){return s.jsx("ol",{children:t.items.map((n,r)=>s.jsxs("li",{className:C("grid grid-cols-[auto,1fr] gap-6",r!==t.items.length-1?"pb-12":void 0),children:[s.jsxs("div",{className:"relative z-0",children:[s.jsx("div",{className:"w-7 h-7 rounded-full bg-about-circle text-about-circleText font-medium flex justify-center items-center relative z-10",children:r+1}),r!==t.items.length-1?s.jsx("div",{className:"h-[calc(100%+1.5rem)] w-px absolute top-6 left-1/2 transform -translate-x-1/2",style:{backgroundImage:"linear-gradient(to bottom, transparent 5px, #1F1F29 5px, #1F1F29 10px)",backgroundSize:"10px 10px",backgroundRepeat:"Repeat"}}):null]}),s.jsx("div",{children:n})]}))})},rl=sl;function kt(e){return s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-white mb-2 font-medium",children:e.title}),s.jsx("div",{className:"text-type-text",children:e.children})]})}function al(){const{t:e}=S();return s.jsxs(Be,{children:[s.jsx(ft,{subpage:!0,k:"global.pages.about"}),s.jsxs(ht,{children:[s.jsx(sn,{children:e("about.title")}),s.jsx(ve,{children:e("about.description")}),s.jsx(De,{children:e("about.faqTitle")}),s.jsx(rl,{items:[s.jsx(kt,{title:e("about.q1.title"),children:e("about.q1.body")}),s.jsx(kt,{title:e("about.q2.title"),children:e("about.q2.body")}),s.jsx(kt,{title:e("about.q3.title"),children:e("about.q3.body")})]})]})]})}function cn(e){return s.jsx("hr",{className:C("w-full h-px border-0 bg-utils-divider bg-opacity-50",e.marginClass??"my-8")})}function Nt(e){return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex",children:[s.jsx("p",{className:"flex-1 font-bold text-white",children:e.name}),s.jsx("p",{children:e.children})]}),s.jsx(cn,{marginClass:"my-3"})]})}function il(){const e=M().NORMAL_ROUTER,t=M().APP_VERSION,n=M().BACKEND_URL;return s.jsxs(s.Fragment,{children:[s.jsx(De,{className:"mb-8 mt-12",children:"Configured values"}),s.jsx(Nt,{name:"Routing mode",children:e?"Normal routing":"Hash based routing"}),s.jsxs(Nt,{name:"Application version",children:["v",t]}),s.jsx(Nt,{name:"Backend URL",children:n})]})}function un(e){return s.jsx("div",{className:"bg-video-scraping-card rounded-xl p-8",children:e.children})}function ol(){const e=M().TMDB_READ_API_KEY,[t,n]=d.useState({hasTested:!1,success:!1,errorText:""}),[r,a]=se(async()=>{if(n({hasTested:!1,success:!1,errorText:""}),e.length===0)return n({hasTested:!0,success:!1,errorText:"TMDB api key is not set"});if(!(e.split(".").length>2))return n({hasTested:!0,success:!1,errorText:"TMDB api key is not a read only key"});try{await ut("556574",Q.MOVIE)}catch{return n({hasTested:!0,success:!1,errorText:"Failed to call tmdb, double check api key and your internet connection"})}return n({hasTested:!0,success:!0,errorText:""})},[e,n]);return s.jsxs(s.Fragment,{children:[s.jsx(De,{className:"mb-8 mt-12",children:"TMDB tests"}),s.jsx(un,{children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-1",children:t.hasTested?t.success?s.jsxs("p",{className:"flex items-center",children:[s.jsx(E,{icon:j.CIRCLE_CHECK,className:"text-video-scraping-success mr-2"}),"TMDB is working as expected"]}):s.jsxs(s.Fragment,{children:[s.jsxs("p",{className:"text-white font-bold w-full mb-3 flex items-center gap-1",children:[s.jsx(E,{icon:j.CIRCLE_EXCLAMATION,className:"text-video-scraping-error mr-2"}),"TMDB is not working"]}),s.jsx("p",{children:t.errorText})]}):s.jsx("p",{children:"Run the test to validate TMDB"})}),s.jsxs(_,{theme:"purple",onClick:a,children:[r.loading?s.jsx(dt,{className:"text-base mr-2"}):null,"Test TMDB"]})]})})]})}function Ge(e){return s.jsxs("div",{className:"flex mb-2",children:[s.jsx(E,{icon:e.errored?j.WARNING:e.success?j.CIRCLE_CHECK:j.EYE_SLASH,className:C({"text-xl mr-2 mt-0.5":!0,"text-video-scraping-error":e.errored,"text-video-scraping-noresult":!e.errored&&!e.success,"text-video-scraping-success":e.success})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-white font-bold",children:e.name}),e.errorText?s.jsx("p",{children:e.errorText}):null]})]})}function ll(){const e=d.useMemo(()=>bs().map((i,o)=>({id:o.toString(),url:i})),[]),[t,n]=d.useState([]),[r,a]=se(async()=>{function i(o,l){n(c=>[...c.filter(u=>u.id!==o),l])}n([]);for(const o of e)try{if(o.url.endsWith("/")){i(o.id,{id:o.id,status:"error",error:new Error("URL ends with slash")});continue}await Ns(o.url,"https://postman-echo.com/get",{}),i(o.id,{id:o.id,status:"success"})}catch(l){i(o.id,{id:o.id,status:"error",error:l})}},[e,n]);return s.jsxs(s.Fragment,{children:[s.jsx(De,{className:"!mb-0 mt-12",children:"Worker tests"}),s.jsxs("p",{className:"mb-8 mt-2",children:[e.length," worker(s) registered"]}),s.jsxs(un,{children:[e.map((i,o)=>{var u;const l=t.find(m=>m.id===i.id),c=`Worker ${o+1}`;return l?l.status==="error"?s.jsx(Ge,{name:c,errored:!0,errorText:(u=l.error)==null?void 0:u.toString()},i.id):l.status==="success"?s.jsx(Ge,{name:c,success:!0},i.id):s.jsx(Ge,{name:c},i.id):s.jsx(Ge,{name:c},i.id)}),s.jsx(cn,{}),s.jsx("div",{className:"flex justify-end",children:s.jsx(_,{theme:"purple",loading:r.loading,onClick:a,children:"Test workers"})})]})]})}async function Ks(e){return P("/meta",{baseURL:e})}function cl(){var i,o,l,c;const e=M().BACKEND_URL,[t,n]=d.useState({hasTested:!1,success:!1,errorText:"",value:null}),[r,a]=se(async()=>{n({hasTested:!1,success:!1,errorText:"",value:null});try{const u=await Ks(e);return n({hasTested:!0,success:!0,errorText:"Failed to call backend, double check the URL key and your internet connection",value:u})}catch{return n({hasTested:!0,success:!1,errorText:"Failed to call backend, double check the URL key and your internet connection",value:null})}},[n]);return s.jsxs(s.Fragment,{children:[s.jsx(De,{className:"mb-8 mt-12",children:"Backend API test"}),s.jsxs(un,{children:[s.jsx("div",{children:s.jsx("div",{className:"flex-1",children:t.hasTested&&t.success?s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("span",{className:"inline-block w-36 text-white font-medium",children:"Version:"}),(i=t.value)==null?void 0:i.version]}),s.jsxs("p",{children:[s.jsx("span",{className:"inline-block w-36 text-white font-medium",children:"Backend name:"}),(o=t.value)==null?void 0:o.name]}),s.jsxs("p",{children:[s.jsx("span",{className:"inline-block w-36 text-white font-medium",children:"Description:"}),((l=t.value)==null?void 0:l.description)??"Not set"]}),s.jsxs("p",{children:[s.jsx("span",{className:"inline-block w-36 text-white font-medium",children:"Captcha enabled:"}),(c=t.value)!=null&&c.hasCaptcha?"Yes":"No"]}),s.jsx(cn,{})]}):null})}),s.jsxs("div",{className:"w-full flex gap-6 justify-between items-center",children:[t.hasTested?t.success?s.jsxs("p",{className:"flex items-center text-md",children:[s.jsx(E,{icon:j.CIRCLE_CHECK,className:"text-video-scraping-success mr-2"}),"Backend is working as expected"]}):s.jsxs("div",{children:[s.jsxs("p",{className:"text-white font-bold w-full mb-3 flex items-center gap-1",children:[s.jsx(E,{icon:j.CIRCLE_EXCLAMATION,className:"text-video-scraping-error mr-2"}),"Backend is not working"]}),s.jsx("p",{children:t.errorText})]}):s.jsx("p",{children:"Run the test to validate backend"}),s.jsx(_,{theme:"purple",loading:r.loading,className:"whitespace-nowrap",onClick:a,children:"Test backend"})]})]})]})}function ul(){return s.jsx(Be,{children:s.jsxs(ht,{children:[s.jsx(sn,{children:"Admin tools"}),s.jsx(ve,{children:"Useful tools to test out your current deployment"}),s.jsx(il,{}),s.jsx(cl,{}),s.jsx(ll,{}),s.jsx(ol,{})]})})}function dl(e){return s.jsx("div",{className:"relative my-4 max-w-[18rem]",children:s.jsx(We,{value:e.selectedItem,onChange:e.setSelectedItem,children:()=>s.jsxs(s.Fragment,{children:[s.jsxs(We.Button,{className:"relative w-full rounded-lg bg-dropdown-background hover:bg-dropdown-hoverBackground py-3 pl-3 pr-10 text-left text-white shadow-md focus:outline-none tabbable cursor-pointer",children:[s.jsxs("span",{className:"flex gap-4 items-center truncate",children:[e.selectedItem.leftIcon?e.selectedItem.leftIcon:null,e.selectedItem.name]}),s.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:s.jsx(E,{icon:j.UP_DOWN_ARROW,className:"transform transition-transform text-xl text-dropdown-secondary"})})]}),s.jsx(It,{as:d.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:s.jsx(We.Options,{className:"absolute left-0 right-0 top-10 z-[1] mt-4 max-h-60 overflow-auto rounded-md bg-dropdown-background py-1 text-white shadow-lg ring-1 ring-black ring-opacity-5 scrollbar-thin scrollbar-track-background-secondary scrollbar-thumb-type-secondary focus:outline-none sm:top-10",children:e.options.map(t=>s.jsxs(We.Option,{className:n=>{let{active:r}=n;return`cursor-pointer flex gap-4 items-center relative select-none py-3 pl-4 pr-4 ${r?"bg-background-secondaryHover text-type-link":"text-white"}`},value:t,children:[t.leftIcon?t.leftIcon:null,t.name]},t.id))})})]})})})}const ml=e=>({casting:{instance:null,player:null,controller:null,setInstance(t){e(n=>{n.casting.instance=t})},setPlayer(t){e(n=>{n.casting.player=t})},setController(t){e(n=>{n.casting.controller=t})},setIsCasting(t){e(n=>{n.interface.isCasting=t})},clear(){e(t=>{t.casting.instance=null})}}}),hl={unknown:0,360:10,480:20,720:30,1080:40},ue=Object.entries(hl).sort((e,t)=>t[1]-e[1]).map(e=>e[0]);function Gs(e,t){if(t.automaticQuality||t.lastChosenQuality===null||t.lastChosenQuality==="unknown")return ue.find(a=>e.includes(a));const n=ue.indexOf(t.lastChosenQuality);let r;for(let a=n;a<ue.length;a+=1)if(e.includes(ue[a])){r=ue[a];break}if(r)return r;for(let a=n;a>=0;a-=1)if(e.includes(ue[a])){r=ue[a];break}return r}function Bt(e,t){if(e.type==="hls")return{stream:e,quality:null};if(e.type==="file"){const n=Object.entries(e.qualities).filter(a=>(a[1].url.length??0)>0).map(a=>a[0]),r=Gs(n,t);if(r){const a=e.qualities[r];if(a)return{stream:a,quality:r}}}throw new Error("couldn't select quality")}const qs={1080:"1080p",360:"360p",480:"480p",720:"720p",unknown:"unknown"},fl=Object.keys(qs);function Ys(e){return qs[e]}const Le=K(ce(G(e=>({quality:{automaticQuality:!0,lastChosenQuality:null},setLastChosenQuality(t){e(n=>{n.quality.lastChosenQuality=t})},setAutomaticQuality(t){e(n=>{n.quality.automaticQuality=t})}})),{name:"__MW::quality"})),A={IDLE:"idle",SCRAPING:"scraping",PLAYING:"playing",SCRAPE_NOT_FOUND:"scrapeNotFound",PLAYBACK_ERROR:"playbackError"};function Js(e){if(e.type==="show"){if(!e.episode||!e.season)throw new Error("missing show data");return{title:e.title,releaseYear:e.releaseYear,tmdbId:e.tmdbId,type:"show",imdbId:e.imdbId,episode:e.episode,season:e.season}}return{title:e.title,releaseYear:e.releaseYear,tmdbId:e.tmdbId,type:"movie",imdbId:e.imdbId}}const gl=(e,t)=>({source:null,sourceId:null,qualities:[],captionList:[],currentQuality:null,status:A.IDLE,meta:null,caption:{selected:null,asTrack:!1},setSourceId(n){e(r=>{r.sourceId=n})},setStatus(n){e(r=>{r.status=n})},setMeta(n,r){e(a=>{a.meta=n,a.interface.hideNextEpisodeBtn=!1,r&&(a.status=r)})},setCaption(n){var a;(a=t().display)==null||a.setCaption(n),e(i=>{i.caption.selected=n})},setSource(n,r,a){let i=[];n.type==="file"&&(i=Object.keys(n.qualities));const o=Le.getState(),l=Bt(n,o.quality);e(u=>{u.source=n,u.qualities=i,u.currentQuality=l.quality,u.captionList=r}),t().redisplaySource(a)},redisplaySource(n){var l;const r=t(),a=r.currentQuality;if(!r.source)return;const i=Le.getState(),o=Bt(r.source,{automaticQuality:i.quality.automaticQuality,lastChosenQuality:a});(l=r.display)==null||l.load({source:o.stream,startAt:n,automaticQuality:i.quality.automaticQuality,preferredQuality:i.quality.lastChosenQuality})},switchQuality(n){var a,i;const r=t();if(r.source)if(r.source.type==="file"){const o=r.source.qualities[n];if(!o)return;e(l=>{l.currentQuality=n}),(a=r.display)==null||a.load({source:o,startAt:r.progress.time,automaticQuality:!1,preferredQuality:n})}else r.source.type==="hls"&&((i=r.display)==null||i.changeQuality(!1,n))},enableAutomaticQuality(){var r;(r=t().display)==null||r.changeQuality(!0,null)}}),xl=(e,t)=>({display:null,setDisplay(n){const r=t().display;if(r&&r.destroy(),!n){e(a=>{a.display=null});return}n.on("pause",()=>e(a=>{a.mediaPlaying.isPaused=!0,a.mediaPlaying.isPlaying=!1})),n.on("play",()=>e(a=>{a.mediaPlaying.hasPlayedOnce=!0,a.mediaPlaying.isPaused=!1,a.mediaPlaying.isPlaying=!0})),n.on("fullscreen",a=>e(i=>{i.interface.isFullscreen=a})),n.on("time",a=>e(i=>{i.progress.time=a})),n.on("volumechange",a=>e(i=>{i.mediaPlaying.volume=a})),n.on("duration",a=>e(i=>{i.progress.duration=a})),n.on("buffered",a=>e(i=>{i.progress.buffered=a})),n.on("loading",a=>e(i=>{i.mediaPlaying.isLoading=a})),n.on("qualities",a=>{e(i=>{i.qualities=a})}),n.on("changedquality",a=>{e(i=>{i.currentQuality=a})}),n.on("needstrack",a=>{e(i=>{i.caption.asTrack=a})}),n.on("canairplay",a=>{e(i=>{i.interface.canAirplay=a})}),n.on("playbackrate",a=>{e(i=>{i.mediaPlaying.playbackRate=a})}),n.on("error",a=>{e(i=>{i.status=A.PLAYBACK_ERROR,i.interface.error=a})}),e(a=>{a.display=n})},reset(){var n;(n=t().display)==null||n.load({source:null,startAt:0,automaticQuality:!1,preferredQuality:null}),e(r=>{r.status=A.IDLE,r.meta=null,r.thumbnails.images=[],r.progress.time=0,r.progress.duration=0})}});let xe=function(e){return e[e.REGULAR=0]="REGULAR",e[e.REMAINING=1]="REMAINING",e}({}),X=function(e){return e.NOT_HOVERING="not_hovering",e.MOUSE_HOVER="mouse_hover",e.MOBILE_TAPPED="mobile_tapped",e}({});const pl=(e,t)=>({interface:{isCasting:!1,hasOpenOverlay:!1,isFullscreen:!1,isSeeking:!1,lastVolume:0,leftControlHovering:!1,isHoveringControls:!1,hovering:X.NOT_HOVERING,lastHoveringState:X.NOT_HOVERING,volumeChangedWithKeybind:!1,volumeChangedWithKeybindDebounce:null,timeFormat:xe.REGULAR,canAirplay:!1,hideNextEpisodeBtn:!1,shouldStartFromBeginning:!1},setShouldStartFromBeginning(n){e(r=>{r.interface.shouldStartFromBeginning=n})},setLastVolume(n){e(r=>{r.interface.lastVolume=n})},setHasOpenOverlay(n){e(r=>{r.interface.hasOpenOverlay=n})},setTimeFormat(n){e(r=>{r.interface.timeFormat=n})},updateInterfaceHovering(n){e(r=>{n!==X.NOT_HOVERING&&(r.interface.lastHoveringState=n),r.interface.hovering=n})},setSeeking(n){const r=t().display;r==null||r.setSeeking(n),e(a=>{a.interface.isSeeking=n})},setHoveringLeftControls(n){e(r=>{r.interface.leftControlHovering=n})},setHoveringAnyControls(n){e(r=>{r.interface.isHoveringControls=n})},hideNextEpisodeButton(){e(n=>{n.interface.hideNextEpisodeBtn=!0})}}),bl=e=>({mediaPlaying:{isPlaying:!1,isPaused:!0,isLoading:!1,isSeeking:!1,isDragSeeking:!1,hasPlayedOnce:!1,volume:1,playbackRate:1},play(){e(t=>{t.mediaPlaying.isPlaying=!0,t.mediaPlaying.isPaused=!1})},pause(){e(t=>{t.mediaPlaying.isPlaying=!1,t.mediaPlaying.isPaused=!1})}}),yl=e=>({progress:{time:0,duration:0,buffered:0,draggingTime:0},setDraggingTime(t){e(n=>{n.progress.draggingTime=t})}});function vl(e,t){if(e.length===0)return null;const n=e.findIndex(l=>l.at>t);if(n===-1)return{index:e.length-1,image:e[e.length-1]};const r=e[n];if(n===0)return{index:n,image:r};const a=e[n-1],i=t-a.at,o=r.at-t;return i<o?{index:n-1,image:a}:{index:n,image:r}}const jl=(e,t)=>({thumbnails:{images:[],resetImages(){e(n=>{n.thumbnails.images=[]})},addImage(n){const r=t(),a=r.thumbnails.images.findIndex(o=>o.at>=n.at);if(a===-1){e(o=>{o.thumbnails.images.push(n),o.thumbnails.images=[...o.thumbnails.images]});return}if(r.thumbnails.images[a].at===n.at){e(o=>{o.thumbnails.images[a]=n,o.thumbnails.images=[...o.thumbnails.images]});return}e(o=>{o.thumbnails.images.splice(a,0,n),o.thumbnails.images=[...o.thumbnails.images]})}}}),p=K(G(function(){return{...pl(...arguments),...yl(...arguments),...bl(...arguments),...gl(...arguments),...xl(...arguments),...ml(...arguments),...jl(...arguments)}})),wl=Ma.sanitize;function kl(e,t,n,r){const a=e/1e3+n,i=t/1e3+n;return Math.max(0,a)<=r&&Math.max(0,i)>=r}function Nl(e,t,n){return`${e}-${t}-${n}`}function Xs(e){const t=e.trim();if(t==="")throw new Error("Given text is empty");const n=Yt(t,"vtt");if(ms(n)==="")throw new Error("Invalid subtitle format");return n}function Zs(e){const t=e.trim();if(t==="")throw new Error("Given text is empty");const n=Yt(t,"srt");if(ms(n)==="")throw new Error("Invalid subtitle format");return n}function Sl(e,t){const n=Xs(e);return _a(n).filter(r=>r.type==="caption")}function Cl(e){return btoa(String.fromCodePoint(...new TextEncoder().encode(e)))}function El(e){return`data:application/x-subrip;base64,${Cl(Zs(e))}`}function Il(e){return URL.createObjectURL(new Blob([Xs(e)],{type:"text/vtt"}))}function Ft(e){return e.map(t=>({language:t.language,url:t.url,needsProxy:t.hasCorsRestrictions}))}const Ll=Oa().map(e=>`.${e}`),Ut=new Ls;Ut.setCompare((e,t)=>e===t);const Tl=24*60*60;async function Rl(e){const t=Ut.get(e.url);if(t)return t;let n;if(e.needsProxy?n=await Pt(e.url,{responseType:"text"}):n=await fetch(e.url).then(a=>a.text()),!n)throw new Error("failed to get caption data");const r=Zs(n);return Ut.set(e.url,r,Tl),r}function bt(){const e=O(g=>g.setLanguage),t=O(g=>g.enabled),n=O(g=>g.resetSubtitleSpecificSettings),r=p(g=>g.setCaption),a=O(g=>g.lastSelectedLanguage),i=p(g=>g.captionList),o=d.useCallback(async g=>{const f=i.find(x=>x.language===g);if(!f)return;const h=await Rl(f);r({language:f.language,srtData:h,url:f.url}),n(),e(g)},[e,i,r,n]),l=d.useCallback(async()=>{r(null),e(null)},[r,e]),c=d.useCallback(async()=>(await o(a??"en"),!0),[a,o]),u=d.useCallback(async()=>{t?l():await c()},[c,l,t]),m=d.useCallback(async()=>{t&&await c()},[c,t]);return{selectLanguage:o,disable:l,selectLastUsedLanguage:c,toggleLastUsed:u,selectLastUsedLanguageIfEnabled:m}}function Pl(){const e=p(r=>r.display),t=Zt(r=>r.volume);return{init:d.useCallback(()=>{e==null||e.setVolume(t)},[e,t])}}function Al(){const e=p(a=>a.source),t=d.useMemo(()=>e?JSON.stringify(e):null,[e]),{selectLastUsedLanguageIfEnabled:n}=bt(),r=d.useRef(n);d.useEffect(()=>{r.current=n},[n]),d.useEffect(()=>{t&&r.current()},[t])}function Ml(e,t){var a;const n=e[(t==null?void 0:t.tmdbId)??""];if(!n||!t)return 0;if(t.type==="movie")return n.progress?n.progress.watched:0;const r=n.episodes[((a=t.episode)==null?void 0:a.tmdbId)??""];return r?r.progress.watched:0}function er(){const e=p(f=>f.setStatus),t=p(f=>f.setMeta),n=p(f=>f.setSource),r=p(f=>f.setCaption),a=p(f=>f.setSourceId),i=p(f=>f.status),o=p(f=>f.interface.shouldStartFromBeginning),l=p(f=>f.setShouldStartFromBeginning),c=p(f=>f.reset),u=p(f=>f.meta),{init:m}=Pl(),g=V();return{meta:u,reset:c,status:i,shouldStartFromBeginning:o,setShouldStartFromBeginning:l,setMeta(f,h){t(f,h)},playMedia(f,h,x,v){const b=v??Ml(g.items,u);r(null),n(f,h,b),a(x),e(A.PLAYING),m()},setScrapeStatus(){e(A.SCRAPING)},setScrapeNotFound(){e(A.SCRAPE_NOT_FOUND)}}}const dn=d.forwardRef((e,t)=>{let{onChange:n,onUnFocus:r,value:a,label:i,name:o,autoComplete:l,className:c,placeholder:u,onFocus:m,passwordToggleable:g}=e,f="text";const[h,x]=d.useState(!0);g&&(f=h?"password":"text");const v=s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:f,ref:t,className:C(c,g&&"pr-12"),placeholder:u,onChange:b=>n&&n(b.target.value),value:a,name:o,autoComplete:l,onBlur:()=>r&&r(),onFocus:()=>m==null?void 0:m(),onKeyDown:b=>b.key==="Enter"?b.target.blur():null}),g?s.jsx("button",{type:"button",className:"absolute top-1/2 -translate-y-1/2 right-1 text-xl p-3",onClick:()=>x(!h),children:s.jsx(E,{icon:h?j.EYE:j.EYE_SLASH})}):null]});return i?s.jsxs("label",{children:[s.jsx("span",{children:i}),v]}):v});function _l(e){return s.jsx("p",{className:C("text-errors-type-secondary",e.marginClass??"mt-6"),children:e.children})}function Ol(){const{t:e}=S(),t=p(r=>r.interface.error),n=Fs("error");return s.jsxs(an,{children:[s.jsxs(rn,{children:[s.jsx(nn,{icon:j.WAND,children:e("player.playbackError.badge")}),s.jsx(Pe,{children:e("player.playbackError.title")}),s.jsx(_l,{children:e("player.playbackError.text")}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(_,{href:"/",theme:"secondary",padding:"md:px-12 p-2.5",className:"mt-6",children:e("player.playbackError.homeButton")}),s.jsx(_,{onClick:()=>n.show(),theme:"purple",padding:"md:px-12 p-2.5",className:"mt-6",children:e("errors.showError")})]})]}),s.jsx(Do,{onClose:()=>n.hide(),error:t,id:n.id})]})}const te=d.forwardRef((e,t)=>s.jsxs("button",{ref:t,type:"button",onClick:n=>{var r;return(r=e.onClick)==null?void 0:r.call(e,n.currentTarget)},className:C(["tabbable p-2 rounded-full hover:bg-video-buttonBackground hover:bg-opacity-50 transition-transform duration-100 flex items-center gap-3",e.activeClass??"active:scale-110 active:bg-opacity-75 active:text-white",e.className??""]),children:[e.icon&&s.jsx(E,{className:e.iconSizeClass||"text-2xl",icon:e.icon}),e.children]}));function Fn(e){const t=p(a=>a.display),{isPaused:n}=p(a=>a.mediaPlaying),r=()=>{n?t==null||t.play():t==null||t.pause()};return s.jsx(te,{className:e.className,iconSizeClass:e.iconSizeClass,onClick:r,icon:n?j.PLAY:j.PAUSE})}function Un(){const{isFullscreen:e}=p(n=>n.interface),t=p(n=>n.display);return s.jsx(te,{onClick:()=>t==null?void 0:t.toggleFullscreen(),icon:e?j.COMPRESS:j.EXPAND})}const tr=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);let St=null;async function rt(){if(St===null){const e=new Promise(n=>{setTimeout(()=>n(!1),1e3)}),t=new Promise(n=>{const r=document.createElement("video"),a=()=>{r.removeEventListener("volumechange",a),n(!0)};r.addEventListener("volumechange",a),r.volume=.5});St=await Promise.race([t,e])}return St}function yt(){return Y.fullscreenEnabled}function nr(){return yt()||tr}function sr(){return yt()||nr()}function rr(){return"pictureInPictureEnabled"in document}function ar(){return"webkitSupportsPresentationMode"in document.createElement("video")}function qe(e){return oe.isSupported()?!1:!!e.canPlayType("application/vnd.apple.mpegurl")}function $n(){const e=p(t=>t.display);return!rr()&&!ar()?null:s.jsx(te,{onClick:()=>e==null?void 0:e.togglePictureInPicture(),icon:j.PICTURE_IN_PICTURE})}function Dl(e){return`${e.toFixed(2)}%`}function Vn(e){return Number(Math.max(0,Math.min(e,100)).toFixed(2))}function Bl(e){return e.type==="mousedown"||e.type==="mouseup"||e.type==="mousemove"}const Ct=e=>Bl(e)?e.pageX:e.changedTouches[0].pageX;function mn(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const[r,a]=d.useState(!1),[i,o]=d.useState(0);d.useEffect(()=>{function c(m){if(!r||!e.current)return;const g=e.current.getBoundingClientRect(),f=(Ct(m)-g.left)/e.current.offsetWidth;o(f*100),n&&t(f)}function u(m){if(!r||(a(!1),document.body.removeAttribute("data-no-select"),!e.current))return;const g=e.current.getBoundingClientRect(),f=(Ct(m)-g.left)/e.current.offsetWidth;t(f)}return document.addEventListener("mousemove",c),document.addEventListener("touchmove",c),document.addEventListener("mouseup",u),document.addEventListener("touchend",u),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("touchmove",c),document.removeEventListener("mouseup",u),document.removeEventListener("touchend",u)}},[r,e,t,n]);const l=d.useCallback(c=>{if(a(!0),document.body.setAttribute("data-no-select","true"),!e.current)return;const u=e.current.getBoundingClientRect(),m=(Ct(c)-u.left)/e.current.offsetWidth*100;o(m)},[o,e]);return{dragging:r,dragPercentage:i,dragMouseDown:l}}function Ye(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Number.isNaN(e))return t?"0:00:00":"0:00";let n=e;const r=Math.floor(n%60);n/=60;const a=Math.floor(n%60);n/=60;const i=Math.floor(n),o=r.toString().padStart(2,"0"),l=a.toString().padStart(2,"0");return t?[i,l,o].join(":"):[l,o].join(":")}function $t(e){return e>60*60}function Fl(e){const t=p(o=>o.thumbnails.images),n=d.useMemo(()=>{var o;return(o=vl(t,e.at))==null?void 0:o.image},[t,e.at]),[r,a]=d.useState({offscreenLeft:0,offscreenRight:0}),i=d.useRef(null);return d.useEffect(()=>{if(!i.current)return;const o=i.current.getBoundingClientRect(),l=32,c=Math.max(0,(o.left-l)*-1),u=Math.max(0,o.right+l-window.innerWidth);a({offscreenLeft:c,offscreenRight:u})},[e.at]),!e.show||!n?null:s.jsx("div",{className:"flex flex-col items-center -translate-x-1/2",children:s.jsx("div",{className:"w-screen flex justify-center",children:s.jsx("div",{ref:i,children:s.jsxs("div",{style:{transform:`translateX(${r.offscreenLeft>0?r.offscreenLeft:-r.offscreenRight}px)`},children:[s.jsx("img",{src:n.data,className:"h-24 border rounded-xl border-gray-800"}),s.jsx("p",{className:"text-center mt-1",children:Ye(Math.max(e.at,0),$t(e.at))})]})})})})}function Ul(e){const[t,n]=d.useState(-1),r=d.useCallback(i=>{if(!e.current)return;const l=e.current.getBoundingClientRect(),c=(i.pageX-l.left)/e.current.offsetWidth;n(c*100)},[n,e]),a=d.useCallback(()=>{n(-1)},[n]);return{mousePos:t,mouseMove:r,mouseLeave:a}}const $l=function(){const{duration:t,time:n,buffered:r}=p(b=>b.progress),a=p(b=>b.display),i=p(b=>b.setDraggingTime),o=p(b=>b.setSeeking),{isSeeking:l}=p(b=>b.interface),c=d.useCallback(b=>{a==null||a.setTime(b*t)},[t,a]),u=d.useRef(null),{mouseMove:m,mouseLeave:g,mousePos:f}=Ul(u),{dragging:h,dragPercentage:x,dragMouseDown:v}=mn(u,c);return d.useEffect(()=>{o(h)},[o,h]),d.useEffect(()=>{i(x/100*t)},[i,t,x]),s.jsxs("div",{className:"w-full relative",dir:"ltr",children:[s.jsx("div",{className:"top-0 absolute inset-x-0",children:s.jsx("div",{className:"absolute bottom-0",style:{left:`${f}%`},children:s.jsx(Fl,{at:Math.floor(f/100*t),show:f>-1})})}),s.jsx("div",{className:"w-full",ref:u,children:s.jsx("div",{className:"group w-full h-8 flex items-center cursor-pointer",onMouseDown:v,onTouchStart:v,onMouseLeave:g,onMouseMove:m,children:s.jsxs("div",{className:["relative w-full h-1 bg-progress-background bg-opacity-25 rounded-full transition-[height] duration-100 group-hover:h-1.5",h?"!h-1.5":""].join(" "),children:[s.jsx("div",{className:"absolute top-0 left-0 h-full rounded-full bg-progress-preloaded bg-opacity-50 flex justify-end items-center",style:{width:`${r/t*100}%`}}),s.jsx("div",{className:"absolute top-0 dir-neutral:left-0 h-full rounded-full bg-progress-filled flex justify-end items-center",style:{width:`${Math.max(0,Math.min(1,h?x/100:n/t))*100}%`},children:s.jsx("div",{className:["w-[1rem] min-w-[1rem] h-[1rem] rounded-full transform translate-x-1/2 scale-0 group-hover:scale-100 bg-white transition-[transform] duration-100",l?"scale-100":""].join(" ")})})]})})})]})},Vl=$l;function Hn(e){const t=p(a=>a.display),n=p(a=>a.progress.time),r=d.useCallback(()=>{t==null||t.setTime(n+10)},[t,n]);return s.jsx(te,{iconSizeClass:e.iconSizeClass,onClick:r,icon:j.SKIP_FORWARD})}function Wn(e){const t=p(a=>a.display),n=p(a=>a.progress.time),r=d.useCallback(()=>{t==null||t.setTime(n-10)},[t,n]);return s.jsx(te,{iconSizeClass:e.iconSizeClass,onClick:r,icon:j.SKIP_BACKWARD})}function zn(e){const t=p(y=>y.interface.timeFormat),n=p(y=>y.setTimeFormat),{duration:r,time:a,draggingTime:i}=p(y=>y.progress),{isSeeking:o}=p(y=>y.interface),{t:l}=S(),c=$t(r);function u(){n(t===xe.REGULAR?xe.REMAINING:xe.REGULAR)}const m=Math.min(Math.max(o?i:a,0),r),g=Math.abs(m-r),f=Ye(g,$t(g)),h=Ye(m,c),x=new Date(Date.now()+g*1e3),v=Ye(r,c);let b=t===xe.REGULAR?"regular":"remaining";return e.short&&(b=t===xe.REGULAR?"shortRegular":"shortRemaining"),s.jsx(te,{onClick:()=>u(),children:s.jsx("span",{children:l(`player.time.${b}`,{timeFinished:x,timeWatched:h,timeLeft:f,duration:v,formatParams:{timeFinished:{hour:"numeric",minute:"numeric"}}})})})}function Hl(){return p(t=>t.mediaPlaying.isLoading)?s.jsx(dt,{className:"text-4xl"}):null}function Wl(){const e=p(o=>o.display),t=p(o=>o.mediaPlaying.isPlaying),n=p(o=>o.mediaPlaying.isLoading),r=p(o=>o.mediaPlaying.hasPlayedOnce),a=p(o=>o.status),i=d.useCallback(()=>{e==null||e.play()},[e]);return r||t||n||a!==A.PLAYING?null:s.jsx("div",{onClick:i,className:"group pointer-events-auto flex h-16 w-16 cursor-pointer items-center justify-center bg-video-autoPlay-background hover:bg-video-autoPlay-hover rounded-full text-white transition-[background-color,transform] hover:scale-125 active:scale-100",children:s.jsx(E,{icon:j.PLAY,className:"text-2xl transition-transform group-hover:scale-125"})})}function ir(){const e=p(o=>o.mediaPlaying.volume),t=p(o=>o.interface.lastVolume),n=p(o=>o.setLastVolume),r=p(o=>o.display),a=Zt(o=>o.setVolume),i=()=>{let o=0;e>0?(o=0,n(e)):t>0?o=t:o=1,r==null||r.setVolume(o),a(o)};return{toggleMute(){i()},setVolume(o){a(o),n(o),r==null||r.setVolume(o)}}}const zl=function(t){const n=d.useRef(null),r=p(b=>b.setHoveringLeftControls),a=p(b=>b.interface.leftControlHovering),i=p(b=>b.mediaPlaying.volume),{setVolume:o,toggleMute:l}=ir(),c=d.useCallback(b=>{o(b)},[o]),{dragging:u,dragPercentage:m,dragMouseDown:g}=mn(n,c,!0),f=d.useCallback(()=>{l()},[l]),h=d.useCallback(async()=>{await rt()&&r(!0)},[r]);let x=Vn(i*100);u&&(x=Vn(m));const v=Dl(x);return s.jsx("div",{className:t.className,onMouseEnter:h,children:s.jsxs("div",{className:"pointer-events-auto flex cursor-pointer items-center py-0",children:[s.jsx("div",{className:"px-4 text-2xl text-white",onClick:f,children:s.jsx(E,{icon:x>0?j.VOLUME:j.VOLUME_X})}),s.jsx("div",{className:`linear -ml-2 w-0 overflow-hidden transition-[width,opacity] duration-300 ${a||u?"!w-24 opacity-100":"w-4 opacity-0"}`,children:s.jsx("div",{ref:n,className:"flex h-10 w-20 items-center px-2",onMouseDown:g,onTouchStart:g,children:s.jsx("div",{className:"relative h-1 flex-1 rounded-full bg-gray-500 bg-opacity-50",children:s.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center justify-end rounded-full bg-video-audio-set",style:{width:v},children:s.jsx("div",{className:"absolute h-3 w-3 translate-x-1/2 rounded-full bg-white"})})})})})]})})},Ql=zl;function Kl(){const e=p(t=>{var n;return(n=t.meta)==null?void 0:n.title});return s.jsx("p",{children:e})}function Gl(){var n,r,a;const{t:e}=S(),t=p(i=>i.meta);return(t==null?void 0:t.type)!=="show"?null:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("span",{className:"text-white font-medium",children:e("media.episodeDisplay",{season:(n=t==null?void 0:t.season)==null?void 0:n.number,episode:(r=t==null?void 0:t.episode)==null?void 0:r.number})}),s.jsx("span",{className:"text-type-secondary font-medium",children:(a=t==null?void 0:t.episode)==null?void 0:a.title})]})}function or(e){return s.jsxs("div",{className:C("relative",e.className),children:[s.jsx("div",{id:`__overlayRouter::${e.id}`,className:"absolute inset-0 -z-10"}),e.children]})}function vt(e){const[t,n]=d.useState(!1),r=d.useRef(!1);return d.useEffect(()=>{function a(){const i=e?window.innerHeight<600:window.innerWidth<1024;r.current!==i&&(r.current=i,n(i))}return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[e]),{isMobile:t}}function H(e){const t=ke(e.id),n=t.showBackwardsTransition(e.path),r=t.isCurrentPage(e.path),a=je(u=>u.registerRoute),i=d.useMemo(()=>t.makePath(e.path),[e.path,t]),{isMobile:o}=vt();d.useEffect(()=>{a({id:i,width:e.width,height:e.height})},[e.height,e.width,i,a]);const l=o?"100%":`${e.width}px`;let c="none";return(n==="yes"||n==="no")&&(c=n==="yes"?"slide-full-left":"slide-full-right"),s.jsx(z,{animation:c,className:"absolute inset-0",durationClass:"duration-[400ms]",show:r,children:s.jsx("div",{className:C(["grid grid-rows-1 max-h-full",e.className]),style:{height:e.height?`${e.height}px`:void 0,width:e.width?l:void 0},children:e.children})})}function ql(){const e=je(u=>u.anchorPoint),t=d.useRef(null),[n,r]=d.useState(0),[a,i]=d.useState(0),[o,l]=d.useState(null),c=d.useCallback((u,m)=>{if(!u)return;const g=u.x+u.w/2,f=window.innerHeight-(u.y+u.h);i(window.innerHeight-f-u.h-m.height-30),r(Math.min(g-m.width/2,window.innerWidth-m.width-30))},[]);return d.useEffect(()=>{!e||!o||c(e,o)},[e,c,o]),d.useEffect(()=>{if(!t.current)return;function u(){var f;const g=(f=t.current)==null?void 0:f.getBoundingClientRect();l(g??null)}u();const m=new ResizeObserver(u);return m.observe(t.current),()=>{m.disconnect()}},[]),[t,n,a]}function Yl(e){const[t,n,r]=ql();return s.jsx("div",{ref:t,style:{transform:`translateX(${n}px) translateY(${r}px)`},className:C(["[&>*]:pointer-events-auto z-10 flex dir-neutral:items-start rtl:justify-start ltr:justify-end dir-neutral:origin-top-left touch-none",e.className]),children:e.children})}const Jl=function(t){const n=ke("hello world :)"),{t:r}=S();return s.jsxs("div",{className:C(["pointer-events-auto px-4 pb-6 z-10 ml-[env(safe-area-inset-left)] mr-[env(safe-area-inset-right)] bottom-0 origin-top-left inset-x-0 absolute overflow-hidden max-h-[calc(100vh-1.5rem)] grid grid-rows-[minmax(0,1fr),auto]",t.className]),children:[t.children,s.jsx("button",{className:"w-full text-video-context-type-main bg-video-context-background z-10 relative hover:bg-video-context-closeHover active:scale-95 rounded-2xl pointer-events-auto transition-all duration-100 flex justify-center items-center py-3 mt-3 font-bold border border-video-context-border hover:text-white",type:"button",onClick:()=>n.close(),children:r("overlays.close")}),s.jsx("div",{className:"pointer-events-none absolute z-0 bottom-0 left-0 w-full h-32 bg-gradient-to-t from-black to-transparent"})]})},Xl=Jl,Zl=200,ec="--colors-global-accentA";function tc(e){return s.jsx("div",{tabIndex:e.tabIndex,className:C(e.className,"relative"),onKeyUp:e.onKeyUp,children:e.children})}function nc(e){return s.jsx("div",{className:C(e.className,"relative"),children:e.children})}const sc=function(t){const n=d.useRef(null),r=t.flareSize??Zl,a=t.cssColorVar??ec;return d.useEffect(()=>{function i(o){if(!n.current)return;const l=n.current.getBoundingClientRect(),c=r/2;n.current.style.setProperty("--bg-x",`${(o.clientX-l.left-c).toFixed(0)}px`),n.current.style.setProperty("--bg-y",`${(o.clientY-l.top-c).toFixed(0)}px`)}return document.addEventListener("mousemove",i),()=>document.removeEventListener("mousemove",i)},[r]),s.jsx("div",{ref:n,className:C("flare-light pointer-events-none absolute inset-0 overflow-hidden opacity-0 transition-opacity duration-[400ms]",t.className,{"!opacity-100":t.enabled??!1}),style:{backgroundImage:`radial-gradient(circle at center, rgba(var(${a}), 1), rgba(var(${a}), 0) 70%)`,backgroundPosition:"var(--bg-x) var(--bg-y)",backgroundRepeat:"no-repeat",backgroundSize:`${r.toFixed(0)}px ${r.toFixed(0)}px`},children:s.jsx("div",{className:C("absolute inset-[1px] overflow-hidden",t.className,t.backgroundClass),children:s.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:`radial-gradient(circle at center, rgba(var(${a}), 1), rgba(var(${a}), 0) 70%)`,backgroundPosition:"var(--bg-x) var(--bg-y)",backgroundRepeat:"no-repeat",backgroundSize:`${r.toFixed(0)}px ${r.toFixed(0)}px`}})})})},rc=sc,Z={Base:tc,Light:rc,Child:nc};function ac(e){const t=d.useRef(null),{isMobile:n}=vt(),r=je(u=>u.routes),a=ke(e.id),i=d.useMemo(()=>r[a.currentRoute??""],[r,a]),[o,l]=zr(()=>({from:{height:`${(i==null?void 0:i.height)??0}px`,width:n?"100%":`${(i==null?void 0:i.width)??0}px`},config:{easing:Qr.linear}}),[]),c=d.useRef(null);return d.useEffect(()=>{const u={height:i==null?void 0:i.height,width:i==null?void 0:i.width,isMobile:n},m=JSON.stringify(u);if(m!==c.current){const g=c.current?JSON.parse(c.current):null;c.current=m,u.isMobile?(l.set({width:"100%"}),l.start({height:`${(i==null?void 0:i.height)??0}px`})):(g==null?void 0:g.height)===void 0&&u.height!==void 0?l.set({height:`${(i==null?void 0:i.height)??0}px`,width:`${(i==null?void 0:i.width)??0}px`}):l.start({height:`${(i==null?void 0:i.height)??0}px`,width:`${(i==null?void 0:i.width)??0}px`})}},[i==null?void 0:i.height,i==null?void 0:i.width,n,l]),s.jsx(ta.div,{ref:t,style:o,className:"overflow-hidden relative z-10 max-h-full",children:s.jsxs(Z.Base,{className:"group w-full bg-video-context-border h-full rounded-2xl transition-colors duration-100 text-video-context-type-main",children:[s.jsx(Z.Light,{flareSize:400,cssColorVar:"--colors-video-context-light",backgroundClass:"bg-video-context-background duration-100",className:"rounded-2xl opacity-100"}),s.jsx(Z.Child,{className:"pointer-events-auto relative transition-transform duration-100 h-full",children:e.children})]})})}function lr(e){const{isMobile:t}=vt(),n=s.jsx(ac,{id:e.id,children:e.children});return t?s.jsx(Xl,{children:n}):s.jsx(Yl,{children:n})}const ic={1080:"1080",480:"480",360:"360",720:"720",unknown:"unknown"},oc=Object.keys(ic),lc=["mp4"];function cc(e){return oc.includes(e)}function Vt(e){if(e.stream.type==="hls")return{type:"hls",url:e.stream.playlist};if(e.stream.type==="file"){const t={};return Object.entries(e.stream.qualities).forEach(n=>{if(!cc(n[0])){console.warn(`unrecognized quality: ${n[0]}`);return}if(!lc.includes(n[1].type)){console.warn(`unrecognized file type: ${n[1].type}`);return}t[n[0]]={type:n[1].type,url:n[1].url}}),{type:"file",qualities:t}}throw new Error("unrecognized type")}function uc(e,t,n,r){const a=p(h=>h.setSource),i=p(h=>h.setCaption),o=p(h=>h.setSourceId),l=p(h=>h.progress.time),c=p(h=>h.meta),u=D(e),{report:m}=gs(),[g,f]=se(async()=>{const h=js();let x;if(c){try{if(h){const v=Lt(h);x=await(await Tt(v.scrapeEmbed(r,n),["completed","noOutput"])).promise()}else x=await Rt.runEmbedScraper({id:r,url:n})}catch(v){console.error(`Failed to scrape ${r}`,v);const y=v instanceof be?"notfound":"failed";throw m([pe(c,t,r,y,v)]),v}m([pe(c,t,null,"success",null)]),o(t),i(null),a(Vt({stream:x.stream}),Ft(x.stream.captions),l),u.close()}},[r,t,c,u,m,i]);return{run:f,loading:g.loading,errored:!!g.error}}function dc(e,t){const n=p(g=>g.meta),r=p(g=>g.setSource),a=p(g=>g.setCaption),i=p(g=>g.setSourceId),o=p(g=>g.progress.time),l=D(t),{report:c}=gs(),[u,m]=se(async()=>{if(!e||!n)return null;const g=Js(n),f=js();let h;try{if(f){const x=Lt(f);h=await(await Tt(x.scrapeSource(e,g),["completed","noOutput"])).promise()}else h=await Rt.runSourceScraper({id:e,media:g})}catch(x){console.error(`Failed to scrape ${e}`,x);const b=x instanceof be?"notfound":"failed";throw c([pe(n,e,null,b,x)]),x}if(c([pe(n,e,null,"success",null)]),h.stream)return a(null),r(Vt({stream:h.stream}),Ft(h.stream.captions),o),i(e),l.close(),null;if(h.embeds.length===1){let x;if(!n)return;try{if(f){const v=Lt(f);x=await(await Tt(v.scrapeEmbed(h.embeds[0].embedId,h.embeds[0].url),["completed","noOutput"])).promise()}else x=await Rt.runEmbedScraper({id:h.embeds[0].embedId,url:h.embeds[0].url})}catch(v){console.error(`Failed to scrape ${h.embeds[0].embedId}`,v);const y=v instanceof be?"notfound":"failed";throw c([pe(n,e,h.embeds[0].embedId,y,v)]),v}c([pe(n,e,h.embeds[0].embedId,"success",null)]),i(e),a(null),r(Vt({stream:x.stream}),Ft(x.stream.captions),o),l.close()}return h.embeds},[e,n,l,a]);return{run:m,watching:(u.value??null)===null,loading:u.loading,items:u.value,notfound:u.error instanceof be,errored:!!u.error}}function mc(e){return s.jsx("div",{className:"h-full grid grid-rows-[1fr]",children:s.jsx("div",{className:"px-6 h-full flex flex-col justify-start overflow-y-auto overflow-x-hidden",children:e.children})})}function hc(e){return s.jsx("div",{className:"[&>*]:px-6 h-full grid grid-rows-[auto,1fr] [&>*:nth-child(2)]:overflow-y-auto [&>*:nth-child(2)]:overflow-x-hidden",children:e.children})}const fc=Object.freeze(Object.defineProperty({__proto__:null,Card:mc,CardWithScrollable:hc},Symbol.toStringTag,{value:"Module"}));function cr(e){return s.jsx("div",{children:s.jsxs("h3",{className:"font-bold text-video-context-type-main pb-3 pt-5 border-b border-video-context-border flex justify-between items-center",children:[s.jsx("div",{className:"flex items-center space-x-3",children:e.children}),s.jsx("div",{children:e.rightSide})]})})}function gc(e){return s.jsx("button",{type:"button",onClick:e.onClick,children:s.jsx(E,{className:"text-xl",icon:e.icon})})}function xc(){return s.jsx("hr",{className:"!my-4 border-0 w-full h-px bg-video-context-border"})}function pc(e){return s.jsx("p",{className:"text-sm mt-8 font-medium",children:e.children})}function bc(e){return s.jsx("a",{type:"button",className:"text-video-context-type-accent cursor-pointer",onClick:e.onClick,children:e.children})}function yc(e){return s.jsx("p",{className:"font-medium",children:e.children})}function vc(e){return s.jsx("p",{className:e.marginClass??"my-3",children:e.children})}function jc(e){return s.jsx("span",{className:"text-white",children:e.children})}function wc(e){return s.jsx("div",{className:"w-full h-full flex justify-center items-center text-center",children:s.jsxs("div",{className:"flex items-center gap-4 flex-col",children:[e.noIcon?null:s.jsx("div",{className:"w-16 h-10 border border-video-context-border rounded-lg flex justify-center items-center",children:s.jsx(E,{className:"text-xl",icon:j.EYE_SLASH})}),e.title?s.jsx("h2",{className:"text-white text-lg font-bold",children:e.title}):null,s.jsx("div",{children:e.children})]})})}const kc=Object.freeze(Object.defineProperty({__proto__:null,Anchor:bc,Divider:xc,FieldTitle:yc,Highlight:jc,IconButton:gc,Paragraph:vc,SmallText:pc,TextDisplay:wc,Title:cr},Symbol.toStringTag,{value:"Module"}));function ur(e){return s.jsxs("span",{className:"text-white flex items-center font-medium",children:[e.children,s.jsx(E,{className:"text-xl ml-1 -mr-1.5",icon:j.CHEVRON_RIGHT})]})}function hn(e){return s.jsx("span",{className:C(["font-medium text-left",e.textClass||"text-video-context-type-main"]),children:e.children})}function Nc(e){return s.jsxs(cr,{rightSide:e.rightSide,children:[s.jsx("button",{type:"button",className:"-ml-2 p-2 rounded tabbable hover:bg-video-context-light hover:bg-opacity-10",onClick:e.onClick,children:s.jsx(E,{className:"text-xl",icon:j.ARROW_LEFT})}),s.jsx("span",{className:"line-clamp-1 break-all",children:e.children})]})}function fn(e){const t=C("flex py-2 px-3 rounded-lg w-full -ml-3",{"cursor-default":!e.clickable,"hover:bg-video-context-hoverColor hover:bg-opacity-50 cursor-pointer tabbable":e.clickable,"bg-video-context-hoverColor bg-opacity-50":e.active}),n={width:"calc(100% + 1.5rem)"},r=s.jsxs("div",{className:C("flex items-center flex-1",e.className),children:[s.jsx("div",{className:"flex-1 text-left",children:e.children}),s.jsx("div",{className:"flex",children:e.rightSide})]});return e.onClick?s.jsx("button",{type:"button",className:t,style:n,onClick:e.onClick,"data-active-link":e.active?!0:void 0,children:r}):s.jsx("div",{className:t,style:n,"data-active-link":e.active?!0:void 0,children:r})}function Sc(e){const t=s.jsx(ur,{children:e.rightText});return s.jsx(fn,{onClick:e.onClick,active:e.active,clickable:!0,rightSide:t,children:s.jsx(hn,{children:e.children})})}function Fe(e){let t;return e.selected&&(t=s.jsx(E,{icon:j.CIRCLE_CHECK,className:"text-xl text-video-context-type-accent"})),e.error&&(t=s.jsx("span",{className:"flex items-center text-video-context-error",children:s.jsx(E,{className:"ml-2",icon:j.WARNING})})),e.loading&&(t=s.jsx(dt,{className:"text-lg"})),s.jsx(fn,{onClick:e.onClick,clickable:!e.disabled,rightSide:t,children:s.jsx(hn,{textClass:C({"text-white":e.selected,"text-video-context-type-main text-opacity-40":e.disabled}),children:e.children})})}const Cc=Object.freeze(Object.defineProperty({__proto__:null,BackLink:Nc,Chevron:ur,ChevronLink:Sc,Link:fn,LinkTitle:hn,SelectableLink:Fe},Symbol.toStringTag,{value:"Module"}));function Ec(e){return s.jsx("h3",{className:C("uppercase font-bold text-video-context-type-secondary text-xs pt-8 pl-1 pb-2.5 border-b border-video-context-border",e.className),children:e.children})}function Ic(e){return s.jsx("div",{className:C("pt-4 space-y-1",e.className),children:e.children})}function Lc(e){const t=d.useRef(null);return d.useEffect(()=>{var o,l,c;const n=(o=t.current)==null?void 0:o.querySelector("[data-active-link]"),r=(l=t.current)==null?void 0:l.getBoundingClientRect(),a=n==null?void 0:n.getBoundingClientRect();if(!a||!r)return;const i=a.top-r.top;(c=t.current)==null||c.scrollTo(0,i-r.height/2+a.height/2)},[e.loaded]),s.jsx("div",{ref:t,className:C("pt-4 space-y-1",e.className),children:e.children})}const Tc=Object.freeze(Object.defineProperty({__proto__:null,ScrollToActiveSection:Lc,Section:Ic,SectionTitle:Ec},Symbol.toStringTag,{value:"Module"})),k={...fc,...Cc,...Tc,...kc};function Rc(e){const{t}=S(),n=t("player.menus.sources.unknownOption"),r=d.useMemo(()=>{if(!e.embedId)return n;const l=ct().find(c=>c.id===e.embedId);return(l==null?void 0:l.name)??n},[e.embedId,n]),{run:a,errored:i,loading:o}=uc(e.routerId,e.sourceId,e.url,e.embedId);return s.jsx(Fe,{loading:o,error:i,onClick:a,children:s.jsx("span",{className:"flex flex-col",children:s.jsx("span",{children:r})})})}function Pc(e){let{sourceId:t,id:n}=e;const{t:r}=S(),a=D(n),{run:i,watching:o,notfound:l,loading:c,items:u,errored:m}=dc(t,n),g=d.useMemo(()=>{if(!t)return"...";const x=ct().find(v=>v.id===t);return(x==null?void 0:x.name)??"..."},[t]),f=d.useRef(null);d.useEffect(()=>{f.current!==t&&(f.current=t,t&&i())},[i,t]);let h=null;return c?h=s.jsx(k.TextDisplay,{noIcon:!0,children:s.jsx(Oe,{})}):l?h=s.jsx(k.TextDisplay,{title:r("player.menus.sources.noStream.title")??void 0,children:r("player.menus.sources.noStream.text")}):(u==null?void 0:u.length)===0?h=s.jsx(k.TextDisplay,{title:r("player.menus.sources.noEmbeds.title")??void 0,children:r("player.menus.sources.noEmbeds.text")}):m?h=s.jsx(k.TextDisplay,{title:r("player.menus.sources.failed.title")??void 0,children:r("player.menus.sources.failed.text")}):o?h=null:u&&t&&(h=u.map(x=>s.jsx(Rc,{embedId:x.embedId,url:x.url,routerId:n,sourceId:t},`${x.embedId}-${x.url}`))),s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>a.navigate("/source"),children:g}),s.jsx(k.Section,{children:h})]})}function Ac(e){let{id:t,onChoose:n}=e;const{t:r}=S(),a=D(t),i=p(c=>{var u;return(u=c.meta)==null?void 0:u.type}),o=p(c=>c.sourceId),l=d.useMemo(()=>i?ct().filter(c=>c.type==="source").filter(c=>{var u;return(u=c.mediaTypes)==null?void 0:u.includes(i)}):[],[i]);return s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>a.navigate("/"),children:r("player.menus.sources.title")}),s.jsx(k.Section,{children:l.map(c=>s.jsx(Fe,{onClick:()=>{n==null||n(c.id),a.navigate("/source/embeds")},selected:c.id===o,children:c.name},c.id))})]})}const Mc=function(t){return s.jsx("button",{type:"button",onClick:t.onClick,className:C("w-11 h-6 p-1 rounded-full grid transition-colors duration-100 group/toggle tabbable",t.enabled?"bg-buttons-toggle":"bg-buttons-toggleDisabled"),children:s.jsx("div",{className:"relative w-full h-full",children:s.jsx("div",{className:C("scale-90 group-hover/toggle:scale-100 h-full aspect-square rounded-full bg-white absolute transition-all duration-100",t.enabled?"left-full transform -translate-x-full":"left-0")})})})},gn=Mc,_c=function(t){return s.jsx("button",{type:"button",className:C("tabbable p-1.5 bg-video-context-buttonFocus rounded transition-colors duration-100",t.active?"bg-opacity-100":"bg-opacity-0 cursor-pointer"),onClick:t.onClick,children:s.jsx("div",{className:"w-6 h-6 rounded-full flex justify-center items-center",style:{backgroundColor:t.color},children:t.active?s.jsx(E,{className:"text-sm text-black",icon:j.CHECKMARK}):null})})},Oc=_c,Dc=function(t){const n=d.useRef(null),r=d.useRef(null),a=(t.value-t.min)/(t.max-t.min),i=d.useCallback(b=>{var T;const y=t.max-t.min,N=Math.min(Math.max(b,0),1);(T=t.onChange)==null||T.call(t,t.min+y*N)},[t]),{dragging:o,dragPercentage:l,dragMouseDown:c}=mn(r,i,!0),[u,m]=d.useState(!1),[g,f]=d.useState("");d.useEffect(()=>{function b(y){var N;y.key==="Enter"&&u&&((N=n.current)==null||N.blur())}return window.addEventListener("keydown",b),()=>{window.removeEventListener("keydown",b)}},[u]);const h=`tabbable py-1 bg-video-context-inputBg rounded text-white cursor-text ${t.controlButtons?"text-center px-4 w-24":"px-3 text-left w-20"}`,x="tabbable hover:text-white transition-colors duration-100 w-full h-full flex justify-center items-center hover:bg-video-context-buttonOverInputHover rounded",v=t.textTransformer??(b=>b);return s.jsxs("div",{children:[s.jsx(k.FieldTitle,{children:t.label}),s.jsxs("div",{className:"grid items-center grid-cols-[1fr,auto] gap-4",children:[s.jsx("div",{ref:r,children:s.jsx("div",{className:"group/progress w-full h-8 flex items-center cursor-pointer",onMouseDown:c,onTouchStart:c,children:s.jsx("div",{dir:"ltr",className:["relative w-full h-1 bg-video-context-slider bg-opacity-25 rounded-full transition-[height] duration-100 group-hover/progress:h-1.5",o?"!h-1.5":""].join(" "),children:s.jsx("div",{className:"absolute top-0 left-0 h-full rounded-full bg-video-context-sliderFilled flex justify-end items-center",style:{width:`${Math.max(0,Math.min(1,o?l/100:a))*100}%`},children:s.jsx("div",{className:["w-[1rem] min-w-[1rem] h-[1rem] border-[4px] border-video-context-sliderFilled rounded-full transform translate-x-1/2 bg-white transition-[transform] duration-100"].join(" ")})})})})}),s.jsx("div",{children:u?s.jsx("input",{className:h,value:g,autoFocus:!0,onFocus:b=>{b.target.select()},onBlur:b=>{var N;m(!1);const y=Number(b.target.value);Number.isNaN(y)||(N=t.onChange)==null||N.call(t,(t.decimalsAllowed??0)===0?Math.round(y):y)},ref:n,onChange:b=>f(b.target.value)}):s.jsxs("div",{className:"relative",onClick:b=>{b.target.closest(".actions")||(f(t.value.toFixed(t.decimalsAllowed??0)),m(!0))},children:[s.jsx("button",{className:C(h,t.controlButtons?"relative":void 0),type:"button",tabIndex:0,children:v(t.value.toFixed(t.decimalsAllowed??0))}),t.controlButtons?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"actions w-6 h-full absolute left-0 top-0 grid grid-cols-1 items-center justify-center",children:s.jsx("button",{type:"button",onClick:()=>{var b;return(b=t.onChange)==null?void 0:b.call(t,t.value-1/10**(t.decimalsAllowed??0))},className:x,children:s.jsx(E,{icon:j.CHEVRON_LEFT})})}),s.jsx("div",{className:"actions w-6 h-full absolute right-0 top-0 grid grid-cols-1 items-center justify-center",children:s.jsx("button",{type:"button",onClick:()=>{var b;return(b=t.onChange)==null?void 0:b.call(t,t.value+1/10**(t.decimalsAllowed??0))},className:x,children:s.jsx(E,{icon:j.CHEVRON_RIGHT})})})]}):null]})})]})]})},Et=Dc,Bc=["#ffffff","#80b1fa","#e2e535"];function Fc(e){let{id:t}=e;const{t:n}=S(),r=D(t),a=O(m=>m.styling),i=O(m=>m.overrideCasing),o=O(m=>m.delay),l=O(m=>m.setOverrideCasing),c=O(m=>m.setDelay),u=O(m=>m.updateStyling);return s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>r.navigate("/captions"),children:"Custom captions"}),s.jsxs(k.Section,{className:"space-y-6",children:[s.jsx(Et,{label:n("player.menus.captions.settings.delay"),max:10,min:-10,onChange:m=>c(m),value:o,textTransformer:m=>`${m}s`,decimalsAllowed:1,controlButtons:!0}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx(k.FieldTitle,{children:n("player.menus.captions.settings.fixCapitals")}),s.jsx("div",{className:"flex justify-center items-center",children:s.jsx(gn,{enabled:i,onClick:()=>l(!i)})})]}),s.jsx(k.Divider,{}),s.jsx(Et,{label:n("settings.captions.backgroundLabel"),max:100,min:0,onChange:m=>u({backgroundOpacity:m/100}),value:a.backgroundOpacity*100,textTransformer:m=>`${m}%`}),s.jsx(Et,{label:n("settings.captions.textSizeLabel"),max:200,min:1,textTransformer:m=>`${m}%`,onChange:m=>u({size:m/100}),value:a.size*100}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx(k.FieldTitle,{children:n("settings.captions.colorLabel")}),s.jsx("div",{className:"flex justify-center items-center",children:Bc.map(m=>s.jsx(Oc,{onClick:()=>u({color:m}),color:m,active:a.color===m},m))})]})]})]})}function Uc(e){return s.jsxs("div",{className:"w-full relative",children:[s.jsx(E,{className:"pointer-events-none absolute top-1/2 left-3 transform -translate-y-1/2 text-video-context-inputPlaceholder",icon:j.SEARCH}),s.jsx("input",{placeholder:"Search",className:"w-full py-2 px-3 pl-[calc(0.75rem+24px)] tabbable bg-video-context-inputBg rounded placeholder:text-video-context-inputPlaceholder",value:e.value,onInput:t=>e.onInput(t.currentTarget.value)})]})}function dr(e){var i,o,l,c;const t=Ba.getTag(e,!0),n=((o=(i=t==null?void 0:t.language)==null?void 0:i.Description)==null?void 0:o[0])??null;if(!n)return null;const r=((c=(l=t==null?void 0:t.region)==null?void 0:l.Description)==null?void 0:c[0])??null;let a="";return r&&(a=` (${r})`),`${n}${a}`}function $c(e){const t=["en","hi","fr","de","nl","pt"].reverse();return e.sort((r,a)=>t.indexOf(a)!==-1||t.indexOf(r)!==-1?t.indexOf(a)-t.indexOf(r):r.localeCompare(a))}function Ht(e){return s.jsx(Fe,{selected:e.selected,loading:e.loading,error:e.error,onClick:e.onClick,children:s.jsxs("span",{"data-active-link":e.selected?!0:void 0,className:"flex items-center",children:[s.jsx("span",{"data-code":e.countryCode,className:"mr-3 inline-flex",children:s.jsx(Aa,{countryCode:e.countryCode})}),s.jsx("span",{children:e.children})]})})}function Vc(){const{t:e}=S(),t=p(i=>{var o;return(o=i.caption.selected)==null?void 0:o.language}),n=p(i=>i.setCaption),r=O(i=>i.setCustomSubs),a=d.useRef(null);return s.jsxs(Ht,{selected:t==="custom",onClick:()=>{var i;return(i=a.current)==null?void 0:i.click()},children:[e("player.menus.captions.customChoice"),s.jsx("input",{className:"hidden",ref:a,accept:Ll.join(","),type:"file",onChange:i=>{if(!i.target.files)return;const o=new FileReader;o.addEventListener("load",l=>{if(!l.target||typeof l.target.result!="string")return;const c=Yt(l.target.result,"srt");n({language:"custom",srtData:c}),r()}),o.readAsText(i.target.files[0],"utf-8")}})]})}function Hc(e,t){const{t:n}=S(),r=n("player.menus.captions.unknownLanguage");return d.useMemo(()=>{const a=e.map(l=>({...l,languageName:dr(l.language)??r})),i=$c(a.map(l=>l.language));let o=a.sort((l,c)=>i.indexOf(l.language)-i.indexOf(c.language));return t.trim().length>0&&(o=new Da(a,{includeScore:!0,keys:["languageName"]}).search(t).map(c=>c.item)),o},[e,t,r])}function Wc(e){let{id:t}=e;const{t:n}=S(),r=D(t),a=p(b=>{var y;return(y=b.caption.selected)==null?void 0:y.language}),[i,o]=d.useState(null),{selectLanguage:l,disable:c}=bt(),u=p(b=>b.captionList),[m,g]=d.useState(""),f=Hc(u,m),[h,x]=se(async b=>(o(b),l(b)),[l,o]),v=f.map((b,y)=>s.jsx(Ht,{countryCode:b.language,selected:a===b.language,loading:b.language===i&&h.loading,error:b.language===i&&h.error?h.error.toString():void 0,onClick:()=>x(b.language),children:b.languageName},`${y}-${b.url}`));return s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx(k.BackLink,{onClick:()=>r.navigate("/"),rightSide:s.jsx("button",{type:"button",onClick:()=>r.navigate("/captions/settings"),className:"py-1 -my-1 px-3 -mx-3 rounded tabbable",children:n("player.menus.captions.customizeLabel")}),children:n("player.menus.captions.title")}),s.jsx("div",{className:"mt-3",children:s.jsx(Uc,{value:m,onInput:g})})]}),s.jsxs(k.ScrollToActiveSection,{className:"!pt-1 mt-2 pb-3",children:[s.jsx(Ht,{onClick:()=>c(),selected:!a,children:n("player.menus.captions.offChoice")}),s.jsx(Vc,{}),v]})]})}function zc(){const e=p(r=>r.source),t=p(r=>r.currentQuality);return d.useMemo(()=>{var r;return(e==null?void 0:e.type)==="file"&&t?((r=e.qualities[t])==null?void 0:r.url)??null:(e==null?void 0:e.type)==="hls"?e.url:null},[e,t])}function de(e){return s.jsx(Te,{i18nKey:e.k,components:{bold:s.jsx(k.Highlight,{}),ios_share:s.jsx(E,{icon:j.IOS_SHARE,className:"inline-block text-xl -mb-1"}),ios_files:s.jsx(E,{icon:j.IOS_FILES,className:"inline-block text-xl -mb-1"})}})}function Qc(e){let{id:t}=e;const n=D(t),{t:r}=S(),a=zc(),i=p(c=>{var u;return(u=c.source)==null?void 0:u.type}),o=p(c=>{var u;return(u=c.caption)==null?void 0:u.selected}),l=d.useMemo(()=>o?El(o==null?void 0:o.srtData):null,[o]);return a?s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>n.navigate("/"),children:r("player.menus.downloads.title")}),s.jsx(k.Section,{children:s.jsx("div",{children:i==="hls"?s.jsxs(s.Fragment,{children:[s.jsx(k.Paragraph,{marginClass:"mb-6",children:s.jsx(de,{k:"player.menus.downloads.hlsDisclaimer"})}),s.jsx(_,{className:"w-full",href:a,theme:"purple",children:r("player.menus.downloads.downloadPlaylist")}),s.jsx(_,{className:"w-full mt-2",href:l??void 0,disabled:!l,theme:"secondary",download:"subtitles.srt",children:r("player.menus.downloads.downloadCaption")})]}):s.jsxs(s.Fragment,{children:[s.jsx(k.ChevronLink,{onClick:()=>n.navigate("/download/pc"),children:r("player.menus.downloads.onPc.title")}),s.jsx(k.ChevronLink,{onClick:()=>n.navigate("/download/ios"),children:r("player.menus.downloads.onIos.title")}),s.jsx(k.ChevronLink,{onClick:()=>n.navigate("/download/android"),children:r("player.menus.downloads.onAndroid.title")}),s.jsx(k.Divider,{}),s.jsx(k.Paragraph,{marginClass:"my-6",children:s.jsx(de,{k:"player.menus.downloads.disclaimer"})}),s.jsx(_,{className:"w-full",href:a,theme:"purple",children:r("player.menus.downloads.downloadVideo")}),s.jsx(_,{className:"w-full mt-2",href:l??void 0,disabled:!l,theme:"secondary",download:"subtitles.srt",children:r("player.menus.downloads.downloadCaption")})]})})})]}):null}function Kc(e){let{id:t}=e;const n=D(t),{t:r}=S();return s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>n.navigate("/"),children:r("player.menus.downloads.title")}),s.jsx(k.Section,{children:s.jsx(k.Paragraph,{children:s.jsx(de,{k:"player.menus.downloads.hlsExplanation"})})})]})}function Gc(e){let{id:t}=e;const n=D(t),{t:r}=S();return s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>n.navigate("/download"),children:r("player.menus.downloads.onAndroid.shortTitle")}),s.jsx(k.Section,{children:s.jsx(k.Paragraph,{children:s.jsx(de,{k:"player.menus.downloads.onAndroid.1"})})})]})}function qc(e){let{id:t}=e;const n=D(t),{t:r}=S();return s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>n.navigate("/download"),children:r("player.menus.downloads.onPc.shortTitle")}),s.jsx(k.Section,{children:s.jsx(k.Paragraph,{children:s.jsx(de,{k:"player.menus.downloads.onPc.1"})})})]})}function Yc(e){let{id:t}=e;const n=D(t);return s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>n.navigate("/download"),children:s.jsx(de,{k:"player.menus.downloads.onIos.shortTitle"})}),s.jsx(k.Section,{children:s.jsx(k.Paragraph,{children:s.jsx(de,{k:"player.menus.downloads.onIos.1"})})})]})}function Jc(e){let{id:t}=e;return s.jsxs(s.Fragment,{children:[s.jsx(H,{id:t,path:"/download",width:343,height:490,children:s.jsx(k.CardWithScrollable,{children:s.jsx(Qc,{id:t})})}),s.jsx(H,{id:t,path:"/download/unable",width:343,height:440,children:s.jsx(k.CardWithScrollable,{children:s.jsx(Kc,{id:t})})}),s.jsx(H,{id:t,path:"/download/ios",width:343,height:440,children:s.jsx(k.CardWithScrollable,{children:s.jsx(Yc,{id:t})})}),s.jsx(H,{id:t,path:"/download/android",width:343,height:440,children:s.jsx(k.CardWithScrollable,{children:s.jsx(Gc,{id:t})})}),s.jsx(H,{id:t,path:"/download/pc",width:343,height:440,children:s.jsx(k.CardWithScrollable,{children:s.jsx(qc,{id:t})})})]})}const Xc=function(t){return s.jsx("div",{className:"flex items-center bg-video-context-buttons-list p-1 rounded-lg",children:t.options.map(n=>s.jsxs("button",{type:"button",className:C("w-full px-2 py-1 rounded-md tabbable",t.selected===n?"bg-video-context-buttons-active text-white":null),onClick:()=>t.onClick(n),children:[n,"x"]},n))})},Zc=Xc;function eu(e){let{id:t}=e;const{t:n}=S(),r=D(t),a=p(c=>c.mediaPlaying.playbackRate),i=p(c=>c.display),o=d.useCallback(c=>{i==null||i.setPlaybackRate(c)},[i]),l=[.25,.5,1,1.5,2];return s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>r.navigate("/"),children:n("player.menus.playback.title")}),s.jsx(k.Section,{children:s.jsxs("div",{className:"space-y-4 mt-3",children:[s.jsx(k.FieldTitle,{children:n("player.menus.playback.speedLabel")}),s.jsx(Zc,{options:l,selected:a,onClick:o})]})})]})}const tu={unknown:!1,360:!0,480:!0,720:!0,1080:!0};function nu(){const e=p(n=>{var r;return(r=n.source)==null?void 0:r.type});return d.useMemo(()=>{const n=document.createElement("video");return!(e!=="hls"||oe.isSupported()||!qe(n))},[e])}function su(e){let{id:t}=e;const n=D(t),r=nu(),a=p(x=>x.qualities),i=p(x=>x.currentQuality),o=p(x=>x.switchQuality),l=p(x=>x.enableAutomaticQuality),c=Le(x=>x.setAutomaticQuality),u=Le(x=>x.setLastChosenQuality),m=Le(x=>x.quality.automaticQuality),g=d.useCallback(x=>{u(x),c(!1),o(x),n.close()},[n,o,u,c]),f=d.useCallback(()=>{const x=!m;c(x),x&&l()},[c,m,l]),h=fl.filter(x=>!!(tu[x]||a.includes(x)));return s.jsxs(s.Fragment,{children:[s.jsx(k.BackLink,{onClick:()=>n.navigate("/"),children:jn("player.menus.quality.title")}),s.jsxs(k.Section,{className:"flex flex-col pb-4",children:[h.map(x=>s.jsx(Fe,{selected:x===i,onClick:a.includes(x)?()=>g(x):void 0,disabled:!a.includes(x),children:Ys(x)},x)),s.jsx(k.Divider,{}),s.jsx(k.Link,{rightSide:s.jsx(gn,{onClick:f,enabled:m}),children:jn("player.menus.quality.automaticLabel")}),s.jsx(k.SmallText,{children:s.jsx(Te,{i18nKey:r?"player.menus.quality.iosNoQuality":"player.menus.quality.hint",children:s.jsx(k.Anchor,{onClick:()=>n.navigate("/source"),children:"text"})})})]})]})}function ru(e){let{id:t}=e;const{t:n}=S(),r=D(t),a=p(h=>h.currentQuality),i=p(h=>{var x;return(x=h.caption.selected)==null?void 0:x.language}),o=O(h=>h.enabled),l=p(h=>h.sourceId),c=d.useMemo(()=>{if(!l)return"...";const h=ct().find(x=>x.id===l);return(h==null?void 0:h.name)??"..."},[l]),{toggleLastUsed:u}=bt(),m=i?dr(i)??n("player.menus.captions.unknownLanguage"):void 0,g=p(h=>h.source),f=(g==null?void 0:g.type)==="file"||(g==null?void 0:g.type)==="hls";return s.jsxs(k.Card,{children:[s.jsx(k.SectionTitle,{children:n("player.menus.settings.videoSection")}),s.jsxs(k.Section,{children:[s.jsx(k.ChevronLink,{onClick:()=>r.navigate("/quality"),rightText:a?Ys(a):"",children:n("player.menus.settings.qualityItem")}),s.jsx(k.ChevronLink,{onClick:()=>r.navigate("/source"),rightText:c,children:n("player.menus.settings.sourceItem")}),s.jsx(k.Link,{clickable:!0,onClick:()=>r.navigate(f?"/download":"/download/unable"),rightSide:s.jsx(E,{className:"text-xl",icon:j.DOWNLOAD}),className:f?"opacity-100":"opacity-50",children:n("player.menus.settings.downloadItem")})]}),s.jsx(k.SectionTitle,{children:n("player.menus.settings.experienceSection")}),s.jsxs(k.Section,{children:[s.jsx(k.Link,{rightSide:s.jsx(gn,{enabled:o,onClick:()=>u().catch(()=>{})}),children:n("player.menus.settings.enableCaptions")}),s.jsx(k.ChevronLink,{onClick:()=>r.navigate("/captions"),rightText:m??void 0,children:n("player.menus.settings.captionItem")}),s.jsx(k.ChevronLink,{onClick:()=>r.navigate("/playback"),children:n("player.menus.settings.playbackItem")})]})]})}function au(e){let{id:t}=e;const[n,r]=d.useState(null),a=D(t);return d.useEffect(()=>{a.isRouterActive||r(null),a.route==="/"&&r(null)},[a.isRouterActive,a.route]),s.jsx(Bs,{id:t,children:s.jsxs(lr,{id:t,children:[s.jsx(H,{id:t,path:"/",width:343,height:431,children:s.jsx(ru,{id:t})}),s.jsx(H,{id:t,path:"/quality",width:343,height:400,children:s.jsx(k.Card,{children:s.jsx(su,{id:t})})}),s.jsx(H,{id:t,path:"/captions",width:343,height:431,children:s.jsx(k.CardWithScrollable,{children:s.jsx(Wc,{id:t})})}),s.jsx(H,{id:t,path:"/captions/settings",width:343,height:450,children:s.jsx(k.Card,{children:s.jsx(Fc,{id:t})})}),s.jsx(H,{id:t,path:"/source",width:343,height:431,children:s.jsx(k.CardWithScrollable,{children:s.jsx(Ac,{id:t,onChoose:r})})}),s.jsx(H,{id:t,path:"/source/embeds",width:343,height:431,children:s.jsx(k.CardWithScrollable,{children:s.jsx(Pc,{id:t,sourceId:n})})}),s.jsx(H,{id:t,path:"/playback",width:343,height:215,children:s.jsx(k.Card,{children:s.jsx(eu,{id:t})})}),s.jsx(Jc,{id:t})]})})}function iu(){return s.jsx(au,{id:"settings"})}function Qn(){const e=D("settings"),t=p(n=>n.setHasOpenOverlay);return d.useEffect(()=>{t(e.isRouterActive)},[t,e.isRouterActive]),s.jsx(or,{id:e.id,children:s.jsx(te,{onClick:()=>e.open(),icon:j.GEAR})})}const ou=function(t){const n=t.radius??40;return s.jsxs("svg",{className:`${t.className??""} -rotate-90`,viewBox:"0 0 100 100",children:[s.jsx("circle",{className:`fill-transparent stroke-type-text stroke-[15] opacity-25 ${t.backingRingClassname??""}`,r:n,cx:"50",cy:"50"}),s.jsx("circle",{className:"fill-transparent stroke-current stroke-[15] transition-[stroke-dashoffset] duration-150",r:n,cx:"50",cy:"50",style:{strokeDasharray:`${2*Math.PI*n} ${2*Math.PI*n}`,strokeDashoffset:`${2*Math.PI*n-t.percentage/100*(2*Math.PI*n)}`}})]})},lu=ou;function mr(){const{meta:e,setMeta:t}=er(),n=d.useMemo(()=>e?Js(e):null,[e]),r=d.useCallback(i=>{t(i,A.SCRAPING)},[t]),a=d.useCallback((i,o)=>{let l;if(i.meta.type===R.SERIES){const c=i.meta.seasonData.episodes.find(u=>u.id===o);if(!c)return null;l={type:"show",releaseYear:+(i.meta.year??0),title:i.meta.title,poster:i.meta.poster,tmdbId:i.tmdbId??"",imdbId:i.imdbId,episodes:i.meta.seasonData.episodes.map(u=>({number:u.number,title:u.title,tmdbId:u.id})),episode:{number:c.number,title:c.title,tmdbId:c.id},season:{number:i.meta.seasonData.number,title:i.meta.seasonData.title,tmdbId:i.meta.seasonData.id}}}else l={type:"movie",releaseYear:+(i.meta.year??0),title:i.meta.title,poster:i.meta.poster,tmdbId:i.tmdbId??"",imdbId:i.imdbId};return r(l),l},[r]);return{playerMeta:e,setPlayerMeta:a,setDirectMeta:r,scrapeMedia:n}}function at(e){return s.jsx("div",{className:"h-full w-full flex justify-center items-center p-8 text-center",children:e.children})}function hr(e,t){const[n,r]=d.useState(null);return[ot(async()=>{const i=await At(R.SERIES,e,t);return(i==null?void 0:i.meta.type)!==R.SERIES?null:(r(i.meta.seasons),{season:i.meta.seasonData,fullData:i})},[e,t]),n]}function cu(e){let{selectedSeason:t,setSeason:n}=e;const{t:r}=S(),a=p(c=>c.meta),[i,o]=hr((a==null?void 0:a.tmdbId)??"",t);let l=null;return o?l=s.jsx(k.Section,{className:"pb-6",children:o==null?void 0:o.map(c=>s.jsx(k.ChevronLink,{onClick:()=>n(c.id),children:c.title},c.id))}):i.error?l=s.jsx(at,{children:r("player.menus.episodes.loadingError")}):i.loading&&(l=s.jsx(at,{children:r("player.menus.episodes.loadingList")})),s.jsxs(k.CardWithScrollable,{children:[s.jsx(k.Title,{children:(a==null?void 0:a.title)??r("player.menus.episodes.loadingTitle")}),l]})}function uu(e){var h;let{id:t,selectedSeason:n,goBack:r,onChange:a}=e;const{t:i}=S(),o=D(t),{setPlayerMeta:l}=mr(),c=p(x=>x.meta),[u]=hr((c==null?void 0:c.tmdbId)??"",n),m=V(),g=d.useCallback(x=>{if(u.value){const v=l(u.value.fullData,x);v&&(a==null||a(v))}o.close(!0)},[l,u,o,a]);if(!(c!=null&&c.tmdbId))return null;let f=null;return u.error?f=s.jsx(at,{children:i("player.menus.episodes.loadingError")}):u.loading?f=s.jsx(at,{children:i("player.menus.episodes.loadingList")}):u.value&&(f=s.jsxs(k.ScrollToActiveSection,{className:"pb-6",children:[u.value.season.episodes.length===0?s.jsx(k.TextDisplay,{title:"No episodes found",children:i("player.menus.episodes.emptyState")}):null,u.value.season.episodes.map(x=>{var y,N,T,L;const v=(N=(y=m.items[c==null?void 0:c.tmdbId])==null?void 0:y.episodes)==null?void 0:N[x.id];let b;if(v){const w=v.progress.watched/v.progress.duration*100;b=s.jsx(lu,{className:"h-[18px] w-[18px] text-white",percentage:w>90?100:w})}return s.jsx(k.Link,{onClick:()=>g(x.id),active:x.id===((T=c==null?void 0:c.episode)==null?void 0:T.tmdbId),clickable:!0,rightSide:b,children:s.jsx(k.LinkTitle,{children:s.jsxs("div",{className:"text-left flex items-center space-x-3",children:[s.jsx("span",{className:C("p-0.5 px-2 rounded inline bg-video-context-hoverColor",x.id===((L=c==null?void 0:c.episode)==null?void 0:L.tmdbId)?"text-white bg-opacity-100":"bg-opacity-50"),children:i("player.menus.episodes.episodeBadge",{episode:x.number})}),s.jsx("span",{className:"line-clamp-1 break-all",children:x.title})]})})},x.id)})]})),s.jsxs(k.CardWithScrollable,{children:[s.jsx(k.BackLink,{onClick:r,children:((h=u==null?void 0:u.value)==null?void 0:h.season.title)||i("player.menus.episodes.loadingTitle")}),f]})}function du(e){let{id:t,onChange:n}=e;const r=D(t),a=p(u=>u.meta),[i,o]=d.useState(""),l=d.useRef(!1);d.useEffect(()=>{var u;l.current!==r.isRouterActive&&(l.current=r.isRouterActive,o(((u=a==null?void 0:a.season)==null?void 0:u.tmdbId)??""))},[a,i,o,r.isRouterActive]);const c=d.useCallback(u=>{o(u),r.navigate("/episodes")},[r]);return s.jsx(Bs,{id:t,children:s.jsxs(lr,{id:t,children:[s.jsx(H,{id:t,path:"/",width:343,height:431,children:s.jsx(cu,{setSeason:c,selectedSeason:i})}),s.jsx(H,{id:t,path:"/episodes",width:343,height:431,children:i.length>0?s.jsx(uu,{selectedSeason:i,id:t,goBack:()=>r.navigate("/"),onChange:n}):null})]})})}function mu(e){return s.jsx(du,{onChange:e.onChange,id:"episodes"})}function Kn(){const{t:e}=S(),t=D("episodes"),n=p(a=>a.setHasOpenOverlay),r=p(a=>{var i;return(i=a.meta)==null?void 0:i.type});return d.useEffect(()=>{n(t.isRouterActive)},[n,t.isRouterActive]),r!=="show"?null:s.jsx(or,{id:t.id,children:s.jsx(te,{onClick:()=>t.open("/episodes"),icon:j.EPISODES,children:e("player.menus.episodes.button")})})}function Gn(){const e=p(n=>n.interface.canAirplay),t=p(n=>n.display);return e?s.jsx(te,{onClick:()=>t==null?void 0:t.startAirplay(),icon:j.AIRPLAY}):null}function hu(){const e=Ms(),t=p(n=>n.mediaPlaying.volume);return s.jsx(z,{animation:"slide-down",show:e.showVolume,className:"absolute inset-x-0 top-4 flex justify-center pointer-events-none",children:s.jsxs(Z.Base,{className:"hover:flare-enabled pointer-events-auto bg-video-context-background pl-4 pr-6 py-3 group w-72 h-full rounded-lg transition-colors text-video-context-type-main",children:[s.jsx(Z.Light,{enabled:!0,flareSize:200,cssColorVar:"--colors-video-context-light",backgroundClass:"bg-video-context-background duration-100",className:"rounded-lg"}),s.jsxs(Z.Child,{className:"grid grid-cols-[auto,1fr] gap-3 pointer-events-auto relative transition-transform",children:[s.jsx(E,{className:"text-2xl",icon:t>0?j.VOLUME:j.VOLUME_X}),s.jsx("div",{className:"w-full flex items-center",children:s.jsx("div",{className:"w-full h-1.5 rounded-full bg-video-context-slider bg-opacity-25",children:s.jsx("div",{className:"h-full bg-video-context-sliderFilled rounded-full transition-[width] duration-100",style:{width:`${t*100}%`}})})})]})]})})}function fu(e,t){const n=e/t;return t-e<=30?"always":n>=.9?"hover":"none"}function qn(e){return s.jsx("button",{className:C("font-bold rounded h-10 w-40 scale-95 hover:scale-100 transition-all duration-200",e.className),type:"button",onClick:e.onClick,children:e.children})}function gu(e){var y;const{t}=S(),n=p(N=>N.progress.duration),r=p(N=>N.interface.hideNextEpisodeBtn),a=p(N=>N.meta),{setDirectMeta:i}=mr(),o=p(N=>N.hideNextEpisodeButton),l=p(N=>{var T;return(T=N.meta)==null?void 0:T.type}),c=p(N=>N.progress.time),u=fu(c,n),m=p(N=>N.status),g=p(N=>N.setShouldStartFromBeginning);let f=!1;(u==="always"||u==="hover"&&e.controlsShowing)&&(f=!0),(r||m!=="playing"||n===0)&&(f=!1);const h=u==="hover"?"slide-up":"fade";let x="bottom-[calc(6rem+env(safe-area-inset-bottom))]";u==="always"&&(x=e.controlsShowing?x:"bottom-[calc(3rem+env(safe-area-inset-bottom))]");const v=(y=a==null?void 0:a.episodes)==null?void 0:y.find(N=>{var T;return N.number===(((T=a==null?void 0:a.episode)==null?void 0:T.number)??0)+1}),b=d.useCallback(()=>{var T;if(!a||!v)return;const N={...a};N.episode=v,g(!0),i(N),(T=e.onChange)==null||T.call(e,N)},[i,v,a,e,g]);return!(a!=null&&a.episode)||!v||l!=="show"?null:s.jsx(z,{animation:h,show:f,className:"absolute right-[calc(3rem+env(safe-area-inset-right))] bottom-0",children:s.jsxs("div",{className:C(["absolute bottom-0 right-0 transition-[bottom] duration-200 flex items-center space-x-3",x]),children:[s.jsx(qn,{className:"py-px box-content bg-buttons-secondary hover:bg-buttons-secondaryHover bg-opacity-90 text-buttons-secondaryText",onClick:o,children:t("player.nextEpisode.cancel")}),s.jsxs(qn,{onClick:()=>b(),className:"bg-buttons-primary hover:bg-buttons-primaryHover text-buttons-primaryText flex justify-center items-center",children:[s.jsx(E,{className:"text-xl mr-1",icon:j.SKIP_EPISODE}),t("player.nextEpisode.next")]})]})})}function Yn(e){const[t,n]=d.useState(!1),r=p(o=>o.interface.isCasting),a=d.useRef(null),i=d.useCallback(o=>{const l=(o.getAttribute("style")??"").includes("inline");n(!l)},[n]);return d.useEffect(()=>{var c;const o=(c=a.current)==null?void 0:c.querySelector("google-cast-launcher");if(!o)return;const l=new MutationObserver(()=>{i(o)});return l.observe(o,{attributes:!0,attributeFilter:["style"]}),i(o),()=>{l.disconnect()}},[i]),s.jsx(te,{ref:a,className:[e.className??"","google-cast-button",r?"casting":"",t?"hidden":""].join(" "),icon:j.CASTING,onClick:o=>{const l=o.querySelector("google-cast-launcher");l&&l.click()}})}function xu(){const{t:e}=S(),t=p(a=>a.mediaPlaying.isLoading),n=p(a=>a.display),r=(n==null?void 0:n.getType())==="casting";return t||!r?null:s.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[s.jsx("div",{className:"rounded-full bg-opacity-10 bg-video-buttonBackground p-3 brightness-100 grayscale",children:s.jsx(E,{icon:j.CASTING})}),s.jsx("p",{className:"text-center",children:e("player.casting.enabled")})]})}function pu(e,t){for(let n=0;n<t.length;n+=1)if(t.start(t.length-1-n)<e)return t.end(t.length-1-n);return 0}const bu={1:{name:"MEDIA_ERR_ABORTED",key:"player.playbackError.errors.errorAborted"},2:{name:"MEDIA_ERR_NETWORK",key:"player.playbackError.errors.errorNetwork"},3:{name:"MEDIA_ERR_DECODE",key:"player.playbackError.errors.errorDecode"},4:{name:"MEDIA_ERR_SRC_NOT_SUPPORTED",key:"player.playbackError.errors.errorNotSupported"}};function yu(e){const t=bu[(e==null?void 0:e.code)??-1];return t||{name:"MEDIA_ERR_GENERIC",key:"player.playbackError.errors.errorGenericMedia"}}function ye(e){const t=new URL(e),n=M().CDN_REPLACEMENTS;for(const[r,a]of n)if(t.hostname.endsWith(r))return t.hostname=a,t.port="",t.protocol="https://",t.toString();return e}function fr(){const e={};return{on(t,n){var r;e[t]||(e[t]=[]),(r=e[t])==null||r.push(n)},off(t,n){var r;e[t]=((r=e[t])==null?void 0:r.filter(a=>a!==n))??[]},emit(t,n){(e[t]??[]).forEach(r=>r(n))}}}const gr={360:"360",1080:"1080",720:"720",480:"480"};function Je(e){return gr[e.height]??null}function vu(e){const t=Object.entries(gr).find(n=>n[1]===e);return t?+t[0]:null}function ju(e){return e.map(t=>Je(t)).filter(t=>!!t)}function xr(){const{emit:e,on:t,off:n}=fr();let r=null,a=null,i=null,o=null,l=!1,c=!1,u=!1,m=0,g=!1,f=null,h=1;function x(){if(!a)return;const I=a.levels.map($=>Je($)).filter($=>!!$);e("qualities",I)}function v(){if(i&&qe(i)||!a)return;if(g)a.currentLevel=-1,a.loadLevel=-1;else{const I=ju(a.levels),$=Gs(I,{lastChosenQuality:f,automaticQuality:g});if($){const q=a.levels.findIndex(He=>He.height===vu($));q!==-1&&(a.currentLevel=q,a.loadLevel=q)}}const w=Je(a.levels[a.currentLevel]);e("changedquality",w)}function b(w,I){if(I.type==="hls"){if(qe(w)){w.src=ye(I.url),w.currentTime=m;return}if(!oe.isSupported())throw new Error("HLS not supported");a||(a=new oe({maxBufferSize:500*1e3*1e3,fragLoadPolicy:{default:{maxLoadTimeMs:30*1e3,maxTimeToFirstByteMs:30*1e3,errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3},timeoutRetry:{maxNumRetry:3,maxRetryDelayMs:0,retryDelayMs:0}}}}),a.on(oe.Events.ERROR,($,q)=>{console.error("HLS error",q),q.fatal&&e("error",{message:q.error.message,stackTrace:q.error.stack,errorName:q.error.name,type:"hls"})}),a.on(oe.Events.MANIFEST_LOADED,()=>{a&&(x(),v())}),a.on(oe.Events.LEVEL_SWITCHED,()=>{if(!a)return;const $=Je(a.levels[a.currentLevel]);e("changedquality",$)})),a.attachMedia(w),a.loadSource(ye(I.url)),w.currentTime=m;return}w.src=ye(I.url),w.currentTime=m}function y(){!i||!r||(b(i,r),i.addEventListener("play",()=>{e("play",void 0),e("loading",!1)}),i.addEventListener("error",()=>{const w=(i==null?void 0:i.error)??null,I=yu(w);e("error",{errorName:I.name,key:I.key,type:"htmlvideo"})}),i.addEventListener("playing",()=>e("play",void 0)),i.addEventListener("pause",()=>e("pause",void 0)),i.addEventListener("canplay",()=>e("loading",!1)),i.addEventListener("waiting",()=>e("loading",!0)),i.addEventListener("volumechange",()=>e("volumechange",i!=null&&i.muted?0:(i==null?void 0:i.volume)??0)),i.addEventListener("timeupdate",()=>e("time",(i==null?void 0:i.currentTime)??0)),i.addEventListener("loadedmetadata",()=>{(r==null?void 0:r.type)==="hls"&&i&&qe(i)&&(e("qualities",["unknown"]),e("changedquality","unknown")),e("duration",(i==null?void 0:i.duration)??0)}),i.addEventListener("progress",()=>{i&&e("buffered",pu(i.currentTime,i.buffered))}),i.addEventListener("webkitendfullscreen",()=>{l=!1,e("fullscreen",l),l||e("needstrack",!1)}),i.addEventListener("webkitplaybacktargetavailabilitychanged",w=>{w.availability==="available"&&e("canairplay",!0)}),i.addEventListener("ratechange",()=>{i&&e("playbackrate",i.playbackRate)}))}function N(){i&&(i.removeAttribute("src"),i.load()),a&&(a.destroy(),a=null)}function T(){N(),i&&(i=null)}function L(){l=!!document.fullscreenElement||!!document.webkitFullscreenElement,e("fullscreen",l),l||e("needstrack",!1)}return Y.addEventListener("fullscreenchange",L),{on:t,off:n,getType(){return"web"},destroy:()=>{T(),Y.removeEventListener("fullscreenchange",L)},load(w){w.source||N(),g=w.automaticQuality,f=w.preferredQuality,r=w.source,e("loading",!0),m=w.startAt,y()},changeQuality(w,I){(r==null?void 0:r.type)==="hls"&&(g=w,f=I,v())},processVideoElement(w){T(),i=w,y(),this.setVolume(h)},processContainerElement(w){o=w},setMeta(){},setCaption(){},pause(){i==null||i.pause()},play(){i==null||i.play()},setSeeking(w){if(w!==u){if(u=w,!w){c||this.play();return}c=(i==null?void 0:i.paused)??!0,this.pause()}},setTime(w){if(!i)return;let I=Math.min(w,i.duration);I=Math.max(0,I),!Number.isNaN(I)&&(e("time",I),i.currentTime=I)},async setVolume(w){let I=Math.min(w,1);if(I=Math.max(0,I),h=w,!i)return;i.muted=I===0,await rt()?i.volume=I:e("volumechange",I===0?0:1)},toggleFullscreen(){if(l){if(l=!1,e("fullscreen",l),e("needstrack",!1),!Y.fullscreenElement)return;Y.exitFullscreen();return}if(l=!0,e("fullscreen",l),!(!sr()||Y.fullscreenElement)){if(yt()){o&&Y.requestFullscreen(o);return}nr()&&i&&(e("needstrack",!0),i.webkitEnterFullscreen())}},togglePictureInPicture(){if(i){if(ar()){const w=i;w.webkitSetPresentationMode(w.webkitPresentationMode==="picture-in-picture"?"inline":"picture-in-picture")}rr()&&(i!==document.pictureInPictureElement?i.requestPictureInPicture():document.exitPictureInPicture())}},startAirplay(){const w=i;w&&w.webkitShowPlaybackTargetPicker&&w.webkitShowPlaybackTargetPicker()},setPlaybackRate(w){i&&(i.playbackRate=w)}}}function wu(e){const{emit:t,on:n,off:r}=fr();let a=!1,i=1,o=null,l=null,c=null,u=!1,m=!1,g=!1,f=0,h={title:"",type:R.MOVIE};function x(){var w;const L=async I=>{switch(I.field){case"volumeLevel":await rt()&&t("volumechange",I.value);break;case"currentTime":t("time",I.value);break;case"duration":t("duration",I.value??0);break;case"mediaInfo":I.value&&t("duration",I.value.duration??0);break;case"playerState":t("loading",I.value==="BUFFERING"),I.value==="PLAYING"?t("play",void 0):I.value==="PAUSED"&&t("pause",void 0),a=I.value==="PAUSED";break;case"isMuted":t("volumechange",I.value?1:0);break}};return(w=e.controller)==null||w.addEventListener(cast.framework.RemotePlayerEventType.ANY_CHANGE,L),()=>{var I;(I=e.controller)==null||I.removeEventListener(cast.framework.RemotePlayerEventType.ANY_CHANGE,L)}}function v(){var He;if(!o){(He=e.controller)==null||He.stop();return}let L="video/mp4";o.type==="hls"&&(L="application/x-mpegurl");const w=new chrome.cast.media.GenericMediaMetadata;w.title=h.title;const I=new chrome.cast.media.MediaInfo("video",L);I.contentUrl=ye(o.url),I.streamType=chrome.cast.media.StreamType.BUFFERED,I.metadata=w,I.customData={playbackRate:i};const $=new chrome.cast.media.LoadRequest(I);if($.autoplay=!0,$.currentTime=f,o.type==="hls"){const yn=chrome.cast.media,vn=$.media;vn.hlsSegmentFormat=yn.HlsSegmentFormat.FMP4,vn.hlsVideoSegmentFormat=yn.HlsVideoSegmentFormat.FMP4}const q=e.instance.getCurrentSession();q==null||q.loadMedia($)}function b(){!l||!o||v()}function y(){l&&(l=null)}function N(){u=!!document.fullscreenElement||!!document.webkitFullscreenElement,t("fullscreen",u),u||t("needstrack",!1)}Y.addEventListener("fullscreenchange",N);const T=x();return{on:n,off:r,getType(){return"casting"},destroy:()=>{T(),y(),Y.removeEventListener("fullscreenchange",N)},load(L){o=L.source,t("loading",!0),f=L.startAt,b()},changeQuality(){},setCaption(L){b()},processVideoElement(L){y(),l=L,b()},processContainerElement(L){c=L},setMeta(L){h=L,b()},pause(){a||(e.controller.playOrPause(),a=!0)},play(){a&&(e.controller.playOrPause(),a=!1)},setSeeking(L){if(L!==g){if(g=L,!L){m||this.play();return}m=a??!0,this.pause()}},setTime(L){if(!l)return;let w=Math.min(L,e.player.duration);w=Math.max(0,w),!Number.isNaN(w)&&(t("time",w),e.player.currentTime=w,e.controller.seek())},async setVolume(L){let w=Math.min(L,1);w=Math.max(0,w),await rt()?(e.player.volumeLevel=w,e.controller.setVolumeLevel(),t("volumechange",w)):t("volumechange",w===0?0:1)},toggleFullscreen(){if(u){if(u=!1,t("fullscreen",u),t("needstrack",!1),!Y.fullscreenElement)return;Y.exitFullscreen();return}u=!0,t("fullscreen",u),!(!sr()||Y.fullscreenElement)&&yt()&&c&&Y.requestFullscreen(c)},togglePictureInPicture(){},startAirplay(){},setPlaybackRate(L){i=L,b()}}}const ku="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",pr=[];let Wt=null;function Nu(e){Wt=e,pr.forEach(t=>t(e))}function Su(e){if(Wt!==null)return e(Wt);pr.push(e)}function Cu(){if(window.__onGCastApiAvailable=t=>{Nu(t)},!!!document.getElementById("chromecast-script")){const t=document.createElement("script");t.setAttribute("src",ku),t.setAttribute("id","chromecast-script"),document.body.appendChild(t)}}function Eu(){const[e,t]=d.useState(null);return d.useEffect(()=>{Su(n=>t(n))},[]),e}function Iu(){const e=p(y=>y.casting.setInstance),t=p(y=>y.casting.setController),n=p(y=>y.casting.setPlayer),r=p(y=>y.casting.setIsCasting),a=p(y=>y.interface.isCasting),i=p(y=>{var N;return(N=y.caption)==null?void 0:N.selected}),o=p(y=>y.setDisplay),l=p(y=>y.redisplaySource),c=Eu(),u=p(y=>y.display),m=p(y=>y.casting.controller),g=p(y=>y.casting.player),f=p(y=>y.casting.instance),h=p(y=>y.progress.time),x=p(y=>{var N;return(N=y.meta)==null?void 0:N.title}),v=p(y=>{var N;return(N=y.meta)==null?void 0:N.type}),b=d.useRef({controller:m,player:g,instance:f,time:h,metaTitle:x,metaType:v,caption:i});return d.useEffect(()=>{b.current={controller:m,player:g,instance:f,time:h,metaTitle:x,metaType:v,caption:i}},[m,g,f,h,x,v,i]),d.useEffect(()=>{if(a){if(b.current.controller&&b.current.instance&&b.current.player){const y=wu({controller:b.current.controller,instance:b.current.instance,player:b.current.player});y.setMeta({title:b.current.metaTitle??"",type:tt(b.current.metaType??"movie")}),y.setCaption(b.current.caption),o(y),l(b.current.time??0)}}else{const y=xr();o(y),l(b.current.time??0)}},[a,o,l]),d.useEffect(()=>{u==null||u.setMeta({title:b.current.metaTitle??"",type:tt(b.current.metaType??"movie")})},[x,v,u]),d.useEffect(()=>{if(!c)return;const y=cast.framework.CastContext.getInstance();e(y),y.setOptions({receiverApplicationId:chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,autoJoinPolicy:chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED});const N=new cast.framework.RemotePlayer;n(N);const T=new cast.framework.RemotePlayerController(N);t(T);function L(w){w.field==="isConnected"&&r(w.value)}return T.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,L),()=>{T.removeEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,L)}},[c,n,t,e,r]),null}function Lu(){var r,a;const{t:e}=S(),t=p(i=>i.meta);if(!t)return null;if(t.type!=="show")return s.jsx(le,{children:s.jsx("title",{children:t.title})});const n=e("media.episodeDisplay",{season:(r=t.season)==null?void 0:r.number,episode:(a=t.episode)==null?void 0:a.number});return s.jsx(le,{children:s.jsxs("title",{children:[t.title," - ",n]})})}function Tu(){const e=D(""),t=p(f=>f.display),n=p(f=>f.mediaPlaying),r=p(f=>f.progress.time),{setVolume:a,toggleMute:i}=ir(),{toggleLastUsed:o}=bt(),l=Ms(f=>f.setShowVolume),[c,u]=d.useState(!1),m=d.useRef(),g=d.useRef({setShowVolume:l,setVolume:a,toggleMute:i,setIsRolling:u,toggleLastUsed:o,display:t,mediaPlaying:n,isRolling:c,time:r,router:e});return d.useEffect(()=>{g.current={setShowVolume:l,setVolume:a,toggleMute:i,setIsRolling:u,toggleLastUsed:o,display:t,mediaPlaying:n,isRolling:c,time:r,router:e}},[l,a,i,u,o,t,n,c,r,e]),d.useEffect(()=>{const f=h=>{var v,b,y,N,T,L,w;if(h.target&&h.target.nodeName==="INPUT")return;const x=h.key;if(["ArrowUp","ArrowDown","m"].includes(x)&&(g.current.setShowVolume(!0),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{g.current.setShowVolume(!1)},3e3)),x==="ArrowUp"&&g.current.setVolume((((v=g.current.mediaPlaying)==null?void 0:v.volume)||0)+.15),x==="ArrowDown"&&g.current.setVolume((((b=g.current.mediaPlaying)==null?void 0:b.volume)||0)-.15),x==="m"&&g.current.toggleMute(),x==="ArrowRight"&&((y=g.current.display)==null||y.setTime(g.current.time+5)),x==="ArrowLeft"&&((N=g.current.display)==null||N.setTime(g.current.time-5)),x==="f"&&((T=g.current.display)==null||T.toggleFullscreen()),x===" "&&((L=g.current.display)==null||L[g.current.mediaPlaying.isPaused?"play":"pause"]()),x==="Escape"&&g.current.router.close(),x==="c"&&g.current.toggleLastUsed().catch(()=>{}),x==="r"){if(g.current.isRolling||h.ctrlKey||h.metaKey)return;g.current.setIsRolling(!0),(w=document.querySelector(".popout-location"))==null||w.classList.add("roll"),document.body.setAttribute("data-no-scroll","true"),setTimeout(()=>{var I;(I=document.querySelector(".popout-location"))==null||I.classList.remove("roll"),document.body.removeAttribute("data-no-scroll"),g.current.setIsRolling(!1)},1e3)}};return window.addEventListener("keydown",f),()=>{window.removeEventListener("keydown",f)}},[]),null}function Ru(){const e=p(r=>r.meta),t=p(r=>r.progress),n=p(r=>r.mediaPlaying);return d.useEffect(()=>(window.meta||(window.meta={}),e&&(window.meta.player={meta:{title:e.title,type:e.type,tmdbId:e.tmdbId,year:e.releaseYear,poster:e.poster},controls:{isPlaying:n.isPlaying,isLoading:n.isLoading},season:e.season?{number:e.season.number,tmdbId:e.season.tmdbId,title:e.season.title}:void 0,episode:e.episode?{number:e.episode.number,tmdbId:e.episode.tmdbId,title:e.episode.title}:void 0,progress:{time:t.time,duration:t.duration}}),()=>{window.meta&&delete window.meta.player}),[e,t,n]),null}function Pu(){const e=p(l=>l.meta),t=p(l=>l.progress),n=V(l=>l.updateItem),r=p(l=>l.status),a=p(l=>l.mediaPlaying.hasPlayedOnce),i=d.useRef(null),o=d.useRef({updateItem:n,meta:e,progress:t,status:r,hasPlayedOnce:a});return d.useEffect(()=>{o.current.updateItem=n,o.current.meta=e,o.current.progress=t,o.current.status=r,o.current.hasPlayedOnce=a},[n,t,e,r,a]),cs(()=>{var u,m;const l=o.current;if(!l.progress||!l.meta||!l.updateItem||l.status!==A.PLAYING||!a)return;let c=!1;i.current?(((u=i.current)==null?void 0:u.duration)!==t.duration||((m=i.current)==null?void 0:m.watched)!==t.time)&&(c=!0):c=!0,i.current={duration:t.duration,watched:t.time},c&&l.updateItem({meta:l.meta,progress:i.current})},3e3),null}function Au(e){const t=[0,1];let n=.5,r=0;for(let a=0;a<e;a+=1){const i=1/n-1;for(let o=0;o<i-r;o+=1){const l=o*n*2;t.push(l+n)}r=i,n/=2}return t}class Mu{constructor(t){this.videoEl=null,this.canvasEl=null,this.hls=null,this.cb=t.addImage,this.interrupted=!1}start(t){if(tr)return!1;const n=document.createElement("video");n.setAttribute("muted","true");const r=document.createElement("canvas");if(this.hls=new oe,t.type==="mp4")n.src=ye(t.url),n.crossOrigin="anonymous";else if(t.type==="hls")this.hls.attachMedia(n),this.hls.loadSource(ye(t.url));else throw new Error("Invalid loadable source type");this.videoEl=n,this.canvasEl=r,this.begin().catch(a=>console.error(a))}destroy(){var t,n;this.interrupted=!0,this.videoEl=null,this.canvasEl=null,(t=this.hls)==null||t.detachMedia(),(n=this.hls)==null||n.destroy(),this.hls=null}async initVideo(){!this.videoEl||!this.canvasEl||(await new Promise((t,n)=>{var r,a;(r=this.videoEl)==null||r.addEventListener("loadedmetadata",t),(a=this.videoEl)==null||a.addEventListener("error",n)}),!(!this.videoEl||!this.canvasEl)&&(this.canvasEl.height=this.videoEl.videoHeight,this.canvasEl.width=this.videoEl.videoWidth))}async takeSnapshot(t){if(!this.videoEl||!this.canvasEl||(this.videoEl.currentTime=t,await new Promise(a=>{var o;const i=()=>{var l;(l=this.videoEl)==null||l.removeEventListener("seeked",i),a(null)};(o=this.videoEl)==null||o.addEventListener("seeked",i)}),!this.videoEl||!this.canvasEl))return;const n=this.canvasEl.getContext("2d");if(!n)return;n.drawImage(this.videoEl,0,0,this.canvasEl.width,this.canvasEl.height);const r=this.canvasEl.toDataURL();this.interrupted||r==="data:,"||!r||this.cb({at:t,data:r})}async begin(){const t=this.videoEl;if(!t)return;await this.initVideo();const n=Au(6);for(let r=0;r<n.length;r+=1){if(this.interrupted)return;await this.takeSnapshot(t.duration*n[r])}}}function _u(){var m,g;const e=p(f=>f.thumbnails.addImage),t=p(f=>f.status),n=p(f=>f.thumbnails.resetImages),r=p(f=>f.meta),a=p(f=>f.source),i=d.useRef(null),o=JSON.stringify(a),l=d.useCallback(()=>{let f=null;if(a&&(f=Bt(a,{automaticQuality:!1,lastChosenQuality:"360"})),i.current||t!==A.PLAYING||!f)return;n();const h=new Mu({addImage:e});i.current=h,h.start(f.stream)},[a,e,n,t]),c=d.useRef(l);d.useEffect(()=>{c.current=l},[l,t]),d.useEffect(()=>{c.current()},[o]),d.useEffect(()=>()=>{i.current&&(i.current.destroy(),i.current=null)},[]);const u=JSON.stringify({id:r==null?void 0:r.tmdbId,ep:(m=r==null?void 0:r.episode)==null?void 0:m.tmdbId,se:(g=r==null?void 0:r.season)==null?void 0:g.tmdbId});return d.useEffect(()=>{i.current&&(i.current.destroy(),i.current=null),c.current()},[u,o,t]),null}function Ou(){const e=p(r=>r.display),t=p(r=>r.setDisplay),n=d.useRef(e);d.useEffect(()=>{n.current=e},[e]),d.useEffect(()=>{if(!n.current){const r=xr();n.current=r,t(r)}return()=>{n.current&&(n.current=null,t(null))}},[t])}function br(){return p(t=>t.status)===A.PLAYING}function Du(e,t){const n=d.useRef(null),r=d.useMemo(()=>{n.current&&URL.revokeObjectURL(n.current);const a=e();return n.current=a,a},t);return d.useEffect(()=>()=>{n.current&&URL.revokeObjectURL(n.current)},[]),r}const Bu=function(){const t=d.useRef(null),n=d.useRef(null),r=p(u=>u.display),a=p(u=>{var m;return(m=u.caption.selected)==null?void 0:m.srtData}),i=p(u=>u.caption.asTrack),o=p(u=>{var m;return(m=u.caption.selected)==null?void 0:m.language}),l=Du(()=>a?Il(a):null,[a]);d.useEffect(()=>{r&&t.current&&r.processVideoElement(t.current)},[r,t]),d.useEffect(()=>{n.current&&(n.current.track.mode="showing")},[n]);let c=null;return i&&l&&o&&(c=s.jsx("track",{label:"movie-web",kind:"subtitles",srcLang:o,src:l,default:!0})),s.jsx("video",{className:"absolute inset-0 w-full h-screen bg-black",autoPlay:!0,playsInline:!0,ref:t,children:c})},Fu=Bu;function Uu(){const e=br();return Ou(),Al(),e?s.jsx(Fu,{}):null}function $u(e){const t=br(),n=p(g=>g.display),r=p(g=>g.mediaPlaying.isPaused),a=p(g=>g.updateInterfaceHovering),i=p(g=>g.interface.hovering),[o,l,c]=na(()=>{a(X.NOT_HOVERING)},3e3);us(()=>{l()});const u=d.useCallback(()=>{n==null||n.toggleFullscreen()},[n]),m=d.useCallback(g=>{if(g.pointerType==="mouse"){if(g.button!==0)return;r?n==null||n.play():n==null||n.pause();return}i!==X.MOBILE_TAPPED?(a(X.MOBILE_TAPPED),c()):(a(X.NOT_HOVERING),l())},[n,r,i,a,c,l]);return t?s.jsx("div",{className:C("absolute inset-0",{"absolute inset-0":!0,"cursor-none":!e.showingControls}),onDoubleClick:u,onPointerUp:m}):null}function Vu(e){const t=d.useRef(null),n=p(a=>a.updateInterfaceHovering),r=p(a=>a.interface.hovering);d.useEffect(()=>{if(!e.current)return;const a=e.current;function i(l){l.pointerType==="mouse"&&(n(X.MOUSE_HOVER),t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{n(X.NOT_HOVERING),t.current=null},3e3))}function o(l){l.pointerType==="mouse"&&(n(X.NOT_HOVERING),t.current&&clearTimeout(t.current))}return a.addEventListener("pointermove",i),a.addEventListener("pointerleave",o),()=>{a.removeEventListener("pointermove",i),a.removeEventListener("pointerleave",o)}},[e,r,n])}function Hu(e){const t=d.useRef(null),n=p(r=>r.display);return Vu(t),d.useEffect(()=>{n&&t.current&&n.processContainerElement(t.current)},[n,t]),s.jsx("div",{ref:t,children:s.jsx(Ao,{children:s.jsx("div",{className:"h-screen select-none",children:e.children})})})}function Wu(e){const t=d.useRef(e.onLoad);return d.useEffect(()=>{var n;(n=t.current)==null||n.call(t)},[]),s.jsx("div",{className:"relative",children:s.jsxs(Hu,{children:[s.jsx(Ru,{}),s.jsx(_u,{}),s.jsx(Iu,{}),s.jsx(Uu,{}),s.jsx(Pu,{}),s.jsx(Tu,{}),s.jsxs("div",{className:"relative h-screen overflow-hidden",children:[s.jsx($u,{showingControls:e.showingControls}),s.jsx(Lu,{}),e.children]})]})})}const zu=function(t){const[n]=Jo(t.id),r={error:"bg-[#C93957] text-white"},a={error:j.CIRCLE_EXCLAMATION};return s.jsx("div",{ref:n,children:s.jsx("div",{className:[r[t.type],"flex items-center justify-center p-1"].join(" "),children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(E,{icon:a[t.type]}),s.jsx("div",{children:t.children})]})})})},Qu=zu;function yr(e){const{t}=S(),n=ne(o=>o.isOnline),r=ne(o=>o.setLocation),a=ne(o=>o.location),i=e.location??null;return d.useEffect(()=>{if(i)return r(i),()=>{r(null)}},[r,i]),a!==i?null:s.jsx("div",{children:n?null:s.jsx(Qu,{id:"offline",type:"error",children:t("navigation.banner.offline")})})}function Ku(e){const t=gt("player"),n=p(r=>r.setHoveringAnyControls);return d.useEffect(()=>()=>{n(!1)},[n]),s.jsxs("div",{className:"w-full text-white",children:[s.jsx(z,{animation:"fade",show:e.show,style:{top:`${t}px`},className:"pointer-events-none flex justify-end pb-32 bg-gradient-to-b from-black to-transparent [margin-bottom:env(safe-area-inset-bottom)] transition-opacity duration-200 absolute top-0 w-full"}),s.jsx("div",{className:"relative z-10",children:s.jsx(yr,{location:"player"})}),s.jsx("div",{onMouseOver:()=>n(!0),onMouseOut:()=>n(!1),className:"pointer-events-auto pl-[calc(2rem+env(safe-area-inset-left))] pr-[calc(2rem+env(safe-area-inset-right))] pt-6 absolute top-0 w-full",style:{top:`${t}px`},children:s.jsx(z,{animation:"slide-down",show:e.show,className:"text-white",children:e.children})})]})}function Jn(e){return s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none [&>*]:pointer-events-auto",children:e.children})}function Gu(e){const t=p(n=>n.setHoveringAnyControls);return d.useEffect(()=>()=>{t(!1)},[t]),s.jsxs("div",{className:"w-full text-white",children:[s.jsx(z,{animation:"fade",show:e.show,className:"pointer-events-none flex justify-end pt-32 bg-gradient-to-t from-black to-transparent transition-opacity duration-200 absolute bottom-0 w-full"}),s.jsx("div",{onMouseOver:()=>t(!0),onMouseOut:()=>t(!1),className:"pointer-events-auto z-10 pl-[calc(2rem+env(safe-area-inset-left))] pr-[calc(2rem+env(safe-area-inset-right))] pb-3 mb-[env(safe-area-inset-bottom)] absolute bottom-0 w-full",children:s.jsx(z,{animation:"slide-up",show:e.show,children:e.children})})]})}function qu(e){return s.jsx(z,{animation:"fade",show:e.show,className:"absolute inset-0 w-full h-full bg-black bg-opacity-20 pointer-events-none"})}const Yu=function(t){const{t:n}=S(),r=ee();return s.jsx("div",{className:"flex items-center",children:s.jsxs("button",{type:"button",onClick:()=>r(t.url),className:"py-1 -my-1 px-2 -mx-2 tabbable rounded-lg flex items-center cursor-pointer text-type-secondary hover:text-white transition-colors duration-200 font-medium",children:[s.jsx(E,{className:"mr-2",icon:j.ARROW_LEFT}),s.jsx("span",{className:"md:hidden",children:n("player.back.short")}),s.jsx("span",{className:"hidden md:block",children:n("player.back.default")})]})})},Ju=Yu;function Xu(e){const t=p(r=>r.setHoveringLeftControls),n=d.useCallback(()=>{t(!1)},[t]);return d.useEffect(()=>()=>{t(!1)},[t]),s.jsx("div",{className:C(["flex space-x-3 items-center",e.className]),onMouseLeave:n,children:e.children})}function Zu(e){return s.jsx(z,{animation:"fade",show:e.show,className:"pointer-events-none",children:s.jsx("div",{className:C(["absolute inset-0 flex space-x-6 items-center justify-center pointer-events-none [&>*]:pointer-events-auto",e.className]),children:e.children})})}const ed={i:"I"};function td(e){let{text:t,styling:n,overrideCasing:r}=e;const a=d.useMemo(()=>{let i=t;r&&t&&(i=t.slice(0,1)+t.slice(1).toLowerCase());const o=(i||"").split(" ").map(c=>ed[c]??c).join(" ").replaceAll(/ i'/g," I'").replaceAll(/\r?\n/g,"<br />");return wl(o,{ALLOWED_TAGS:["c","b","i","u","span","ruby","rt","br"],ADD_TAGS:["v","lang"],ALLOWED_ATTR:["title","lang"]})},[t,r]);return s.jsx("p",{className:"pointer-events-none mb-1 select-none rounded px-4 py-1 text-center leading-normal [text-shadow:0_2px_4px_rgba(0,0,0,0.5)]",style:{color:n.color,fontSize:`${(1.5*n.size).toFixed(2)}em`,backgroundColor:`rgba(0,0,0,${n.backgroundOpacity.toFixed(2)})`},children:s.jsx("span",{dangerouslySetInnerHTML:{__html:a},dir:"ltr"})})}function nd(){const e=p(c=>c.progress.time),t=p(c=>{var u;return(u=c.caption.selected)==null?void 0:u.srtData}),n=p(c=>{var u;return(u=c.caption.selected)==null?void 0:u.language}),r=O(c=>c.styling),a=O(c=>c.overrideCasing),i=O(c=>c.delay),o=d.useMemo(()=>t?Sl(t):[],[t,n]),l=d.useMemo(()=>o.filter(c=>{let{start:u,end:m}=c;return kl(u,m,i,e)}),[o,e,i]);return s.jsx("div",{children:l.map((c,u)=>{let{start:m,end:g,content:f}=c;return s.jsx(td,{text:f,styling:r,overrideCasing:a},Nl(u,m,g))})})}function sd(e){const t=p(i=>i.caption.selected),n=p(i=>i.caption.asTrack),r=p(i=>i.display),a=(r==null?void 0:r.getType())==="casting";return n||!t||a?null:s.jsx(z,{className:"absolute inset-0 pointer-events-none",animation:"slide-up",show:!0,children:s.jsx("div",{className:C(["text-white absolute flex w-full flex-col items-center transition-[bottom]",e.controlsShown?"bottom-24":"bottom-12"]),children:s.jsx(nd,{})})})}function rd(){const e=W(o=>o.addBookmark),t=W(o=>o.removeBookmark),n=W(o=>o.bookmarks),r=p(o=>o.meta),a=!!n[(r==null?void 0:r.tmdbId)??""],i=d.useCallback(()=>{r&&(a?t(r.tmdbId):e(r))},[a,r,e,t]);return s.jsx(te,{onClick:()=>i(),icon:a?j.BOOKMARK:j.BOOKMARK_OUTLINE,iconSizeClass:"text-base",className:"p-3"})}function ad(){const e=p(m=>m.interface.hovering),t=p(m=>m.interface.lastHoveringState),n=p(m=>m.mediaPlaying.isPaused),r=p(m=>m.interface.hasOpenOverlay),a=p(m=>m.interface.isHoveringControls),i=t===X.MOBILE_TAPPED,l=e!==X.NOT_HOVERING||a&&!i||r,u=i?l:l||n;return{showTouchTargets:i&&u,showTargets:u}}function id(e){const{showTargets:t,showTouchTargets:n}=ad(),r=p(o=>o.status),{isMobile:a}=vt(),i=p(o=>o.mediaPlaying.isLoading);return s.jsxs(Wu,{onLoad:e.onLoad,showingControls:t,children:[e.children,s.jsx(qu,{show:t&&r===A.PLAYING}),s.jsx(mu,{onChange:e.onMetaChange}),s.jsx(iu,{}),s.jsx(sd,{controlsShown:t}),r===A.PLAYING?s.jsxs(s.Fragment,{children:[s.jsxs(Jn,{children:[s.jsx(Hl,{}),s.jsx(Wl,{})]}),s.jsx(Jn,{children:s.jsx(xu,{})})]}):null,s.jsxs(Zu,{className:"text-white",show:n&&r===A.PLAYING,children:[s.jsx(Wn,{iconSizeClass:"text-3xl"}),s.jsx(Fn,{iconSizeClass:"text-5xl",className:i?"opacity-0":"opacity-100"}),s.jsx(Hn,{iconSizeClass:"text-3xl"})]}),s.jsx(Ku,{show:t,children:s.jsxs("div",{className:"grid grid-cols-[1fr,auto] xl:grid-cols-3 items-center",children:[s.jsxs("div",{className:"flex space-x-3 items-center",children:[s.jsx(Ju,{url:e.backUrl}),s.jsx("span",{className:"text mx-3 text-type-secondary",children:"/"}),s.jsx(Kl,{}),s.jsx(rd,{})]}),s.jsx("div",{className:"text-center hidden xl:flex justify-center items-center",children:s.jsx(Gl,{})}),s.jsx("div",{className:"hidden sm:flex items-center justify-end",children:s.jsx(Ne,{})}),s.jsx("div",{className:"flex sm:hidden items-center justify-end",children:r===A.PLAYING?s.jsxs(s.Fragment,{children:[s.jsx(Gn,{}),s.jsx(Yn,{})]}):null})]})}),s.jsxs(Gu,{show:t,children:[s.jsx("div",{className:"flex items-center space-x-3",children:r===A.PLAYING?s.jsxs(s.Fragment,{children:[a?s.jsx(zn,{short:!0}):null,s.jsx(Vl,{})]}):null}),s.jsxs("div",{className:"hidden lg:flex justify-between",dir:"ltr",children:[s.jsx(Xu,{children:r===A.PLAYING?s.jsxs(s.Fragment,{children:[s.jsx(Fn,{}),s.jsx(Wn,{}),s.jsx(Hn,{}),s.jsx(Ql,{}),s.jsx(zn,{})]}):null}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Kn,{}),r===A.PLAYING?s.jsxs(s.Fragment,{children:[s.jsx($n,{}),s.jsx(Gn,{}),s.jsx(Yn,{})]}):null,r===A.PLAYBACK_ERROR||r===A.PLAYING?s.jsx(Qn,{}):null,s.jsx(Un,{})]})]}),s.jsxs("div",{className:"grid grid-cols-[2.5rem,1fr,2.5rem] gap-3 lg:hidden",children:[s.jsx("div",{}),s.jsxs("div",{className:"flex justify-center space-x-3",children:[r===A.PLAYING?s.jsx($n,{}):null,s.jsx(Kn,{}),s.jsx(Qn,{})]}),s.jsx("div",{children:s.jsx(Un,{})})]})]}),s.jsx(hu,{}),s.jsx(gu,{controlsShowing:t,onChange:e.onMetaChange})]})}const od={releaseYear:2010,title:"Sintel",tmdbId:"",type:"movie"},Xn={hls:"https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8",mp4:"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4"},Zn={hls:"HLS",mp4:"MP4"};function ld(){const{status:e,playMedia:t,setMeta:n}=er(),[r,a]=d.useState("mp4"),[i,o]=d.useState(""),l=d.useCallback((c,u)=>{let m;if(u==="hls")m={type:"hls",url:c};else if(u==="mp4")m={type:"file",qualities:{unknown:{type:"mp4",url:c}}};else throw new Error("Invalid type");n(od),t(m,[],null)},[t,n]);return s.jsxs(id,{backUrl:"/",children:[e===A.IDLE?s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-full max-w-4xl rounded-xl bg-video-scraping-card p-10 m-4",children:s.jsxs("div",{className:"flex gap-16 flex-col lg:flex-row",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(Pe,{children:"Custom stream"}),s.jsxs("div",{className:"grid grid-cols-[1fr,auto] gap-2 items-center",children:[s.jsx(dn,{className:"bg-video-context-flagBg rounded-md p-2 text-white w-full",value:i,onChange:o,placeholder:"https://..."}),s.jsx(dl,{options:Object.entries(Zn).map(c=>({id:c[0],name:c[1]})),selectedItem:{id:r,name:Zn[r]},setSelectedItem:c=>a(c.id)})]}),s.jsx(_,{onClick:()=>l(i,r),children:"Start stream"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx(Pe,{children:"Preset tests"}),s.jsxs("div",{className:"grid grid-cols-[1fr,1fr] gap-2",children:[s.jsx(_,{onClick:()=>l(Xn.hls,"hls"),children:"HLS test"}),s.jsx(_,{onClick:()=>l(Xn.mp4,"mp4"),children:"MP4 test"})]})]})]})})}):null,e===A.PLAYBACK_ERROR?s.jsx(Ol,{}):null]})}function cd(){const{t:e}=S();return s.jsxs("div",{className:"relative flex flex-1 flex-col",children:[s.jsx(le,{children:s.jsx("title",{children:e("notFound.badge")})}),s.jsx(ln,{}),s.jsx("div",{className:"flex h-full flex-1 flex-col items-center justify-center p-5 text-center",children:s.jsx(an,{children:s.jsxs(rn,{children:[s.jsx(nn,{icon:j.EYE_SLASH,children:e("notFound.badge")}),s.jsx(Pe,{children:e("notFound.title")}),s.jsx(ve,{children:e("notFound.message")}),s.jsx(_,{href:"/",theme:"purple",padding:"md:px-12 p-2.5",className:"mt-6",children:e("notFound.goHome")})]})})})]})}function ud(){return s.jsx(cd,{})}function dd(e,t){const[n,r]=d.useState(e);return d.useEffect(()=>{const a=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(a)}},[e,t]),n}function es(e){return e?decodeURIComponent(e):""}function md(){const e=ee(),t=Kt(),[n,r]=d.useState(es(t.query));d.useEffect(()=>{r(es(t.query))},[t.query]);const a=function(o){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r(o),!!l){if(o.length===0){e("/",{replace:!0});return}e(Kr("/browse/:query",{query:o}),{replace:!0})}};return[n,a,()=>{a(n,!0)}]}function hd(e){return s.jsxs(Hs,{children:[s.jsx(ln,{bg:e.showBg}),e.children]})}function vr(e){const{t}=S(),[n]=Gt(),r=d.useCallback(()=>{var a;(a=e.onEdit)==null||a.call(e,!e.editing)},[e]);return s.jsx("button",{type:"button",onClick:r,className:"flex h-12 items-center overflow-hidden rounded-full bg-background-secondary px-4 py-2 text-white transition-[background-color,transform] hover:bg-background-secondaryHover active:scale-105",children:s.jsx("span",{ref:n,children:e.editing?s.jsx("span",{className:"mx-4 whitespace-nowrap",children:t("home.mediaList.stopEditing")}):s.jsx(E,{icon:j.EDIT})})})}function xn(e){return s.jsx("div",{className:e.className,children:s.jsxs("div",{className:"mb-5 flex items-center",children:[s.jsxs("p",{className:"flex flex-1 items-center font-bold uppercase text-type-text",children:[e.icon?s.jsx("span",{className:"mr-2 text-xl",children:s.jsx(E,{icon:e.icon})}):null,e.title]}),e.children]})})}const pn=d.forwardRef((e,t)=>s.jsx("div",{className:"grid grid-cols-2 gap-6 sm:grid-cols-3 md:grid-cols-4",ref:t,children:e.children})),ts={duration:0,watched:0};function fd(e,t){return e-t<60*2}function jr(e,t){return t<20}function gd(e,t){return!(jr(e,t)||fd(e,t))}function wr(e){var r,a;if(e.type!=="show")return{show:gd(((r=e.progress)==null?void 0:r.duration)??0,((a=e.progress)==null?void 0:a.watched)??0),progress:e.progress??ts};const t=Object.values(e.episodes).sort((i,o)=>o.updatedAt-i.updatedAt).filter(i=>!jr(i.progress.duration,i.progress.watched))[0],n=e.seasons[t==null?void 0:t.seasonId];return!t||!n?{show:!1,progress:ts}:{season:n,episode:t,show:!0,progress:t.progress}}function xd(e){return s.jsx("p",{className:`font-semibold text-type-secondary ${e.className||""}`,children:e.content.map((t,n)=>s.jsxs("span",{children:[n!==0?s.jsx("span",{className:"mx-[0.6em] text-[1em]",children:"●"}):null,t]},t))})}function pd(e){let{media:t,linkable:n,series:r,percentage:a,closable:i,onClose:o}=e;const{t:l}=S(),c=`${Math.round(a??0).toFixed(0)}%`,u=n&&!i,m=[l(`media.types.${t.type}`)];return t.year&&m.push(t.year.toFixed()),s.jsxs(Z.Base,{className:`group -m-3 mb-2 rounded-xl bg-background-main transition-colors duration-100 focus:relative focus:z-10 ${u?"hover:bg-mediaCard-hoverBackground tabbable":""}`,tabIndex:u?0:-1,onKeyUp:g=>g.key==="Enter"&&g.currentTarget.click(),children:[s.jsx(Z.Light,{flareSize:300,cssColorVar:"--colors-mediaCard-hoverAccent",backgroundClass:"bg-mediaCard-hoverBackground duration-100",className:C({"rounded-xl bg-background-main group-hover:opacity-100":u})}),s.jsxs(Z.Child,{className:`pointer-events-auto relative mb-2 p-3 transition-transform duration-100 ${u?"group-hover:scale-95":""}`,children:[s.jsxs("div",{className:C("relative mb-4 pb-[150%] w-full overflow-hidden rounded-xl bg-mediaCard-hoverBackground bg-cover bg-center transition-[border-radius] duration-100",{"group-hover:rounded-lg":!i}),style:{backgroundImage:t.poster?`url(${t.poster})`:void 0},children:[r?s.jsx("div",{className:["absolute right-2 top-2 rounded-md bg-mediaCard-badge px-2 py-1 transition-colors"].join(" "),children:s.jsx("p",{className:["text-center text-xs font-bold text-mediaCard-badgeText transition-colors",i?"":"group-hover:text-white"].join(" "),children:l("media.episodeDisplay",{season:r.season||1,episode:r.episode})})}):null,a!==void 0?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`absolute inset-x-0 -bottom-px pb-1 h-12 bg-gradient-to-t from-mediaCard-shadow to-transparent transition-colors ${u?"group-hover:from-mediaCard-hoverShadow":""}`}),s.jsx("div",{className:`absolute inset-x-0 bottom-0 h-12 bg-gradient-to-t from-mediaCard-shadow to-transparent transition-colors ${u?"group-hover:from-mediaCard-hoverShadow":""}`}),s.jsx("div",{className:"absolute inset-x-0 bottom-0 p-3",children:s.jsx("div",{className:"relative h-1 overflow-hidden rounded-full bg-mediaCard-barColor",children:s.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-mediaCard-barFillColor",style:{width:c}})})})]}):null,s.jsx("div",{className:`absolute inset-0 flex items-center justify-center bg-mediaCard-badge bg-opacity-80 transition-opacity duration-200 ${i?"opacity-100":"pointer-events-none opacity-0"}`,children:s.jsx(st,{clickable:!0,className:"text-2xl text-mediaCard-badgeText",onClick:()=>i&&(o==null?void 0:o()),icon:j.X})})]}),s.jsx("h1",{className:"mb-1 line-clamp-3 max-h-[4.5rem] text-ellipsis break-words font-bold text-white",children:s.jsx("span",{children:t.title})}),s.jsx(xd,{className:"text-xs",content:m})]})]})}function bd(e){const t=s.jsx(pd,{...e}),n=e.linkable&&!e.closable;let r=n?`/media/${encodeURIComponent(yi(e.media))}`:"#";return n&&e.series&&(e.series.season===0&&!e.series.episodeId?r+=`/${encodeURIComponent(e.series.seasonId)}`:r+=`/${encodeURIComponent(e.series.seasonId)}/${encodeURIComponent(e.series.episodeId)}`),e.linkable?s.jsx(qt,{to:r,tabIndex:-1,className:C("tabbable",e.closable?"hover:cursor-default":""),children:t}):s.jsx("span",{children:t})}function yd(e){var t,n,r,a;if(!(!e||!e.episode||!e.season))return{episode:(t=e.episode)==null?void 0:t.number,season:(n=e.season)==null?void 0:n.number,episodeId:(r=e.episode)==null?void 0:r.id,seasonId:(a=e.season)==null?void 0:a.id}}function bn(e){const t=V(i=>i.items),n=d.useMemo(()=>t[e.media.id],[t,e.media]),r=d.useMemo(()=>n?wr(n):null,[n]),a=r!=null&&r.show?r.progress.watched/r.progress.duration*100:void 0;return s.jsx(bd,{media:e.media,series:yd(r),linkable:!0,percentage:a,onClose:e.onClose,closable:e.closable})}function vd(){const{t:e}=S(),t=V(c=>c.items),n=W(c=>c.bookmarks),r=W(c=>c.removeBookmark),[a,i]=d.useState(!1),[o]=Gt(),l=d.useMemo(()=>{let c=[];return Object.entries(n).forEach(u=>{c.push({id:u[0],...u[1]})}),c=c.sort((u,m)=>{const g=n[u.id],f=n[m.id],h=t[u.id],x=t[m.id],v=Math.max(g.updatedAt,(h==null?void 0:h.updatedAt)??0);return Math.max(f.updatedAt,(x==null?void 0:x.updatedAt)??0)-v}),c},[n,t]);return l.length===0?null:s.jsxs("div",{children:[s.jsx(xn,{title:e("home.bookmarks.sectionTitle")||"Bookmarks",icon:j.BOOKMARK,children:s.jsx(vr,{editing:a,onEdit:i})}),s.jsx(pn,{ref:o,children:l.map(c=>s.jsx(bn,{media:c,closable:a,onClose:()=>r(c.id)},c.id))})]})}const jd=d.forwardRef((e,t)=>{const[n,r]=d.useState(!1);function a(i){e.onChange(i,!1)}return s.jsxs(Z.Base,{className:C({"hover:flare-enabled group flex flex-col rounded-[28px] transition-colors sm:flex-row sm:items-center relative":!0,"bg-search-background":!n,"bg-search-focused":n}),children:[s.jsx(Z.Light,{flareSize:400,enabled:n,className:"rounded-[28px]",backgroundClass:C({"transition-colors":!0,"bg-search-background":!n,"bg-search-focused":n})}),s.jsxs(Z.Child,{className:"flex flex-1 flex-col",children:[s.jsx("div",{className:"pointer-events-none absolute bottom-0 left-5 top-0 flex max-h-14 items-center text-search-icon",children:s.jsx(E,{icon:j.SEARCH})}),s.jsx(dn,{ref:t,onUnFocus:()=>{r(!1),e.onUnFocus()},onFocus:()=>r(!0),onChange:i=>a(i),value:e.value,className:"w-full flex-1 bg-transparent px-4 py-4 pl-12 text-search-text placeholder-search-placeholder focus:outline-none sm:py-4 sm:pr-2",placeholder:e.placeholder})]})]})});function wd(e){d.useEffect(()=>{const t=n=>{var r;if(n.key==="/"){if(document.activeElement&&document.activeElement.tagName.toLowerCase()==="input")return;n.preventDefault(),(r=e.current)==null||r.focus()}};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[e])}function kd(e){return s.jsx("h1",{className:`text-2xl font-bold text-white sm:text-3xl md:text-4xl ${e.className??""}`,children:e.children})}const Nd=()=>Math.floor(Math.random()*10)===0;function Sd(){const{t:e}=S(),t=d.useMemo(()=>Nd(),[]),n=d.useMemo(()=>Math.random(),[]);return{t:d.useCallback(a=>{const i=e(`${a}.default`)??"";if(!t)return i;const o=e(`${a}.extra`,{returnObjects:!0});return Array.isArray(o)?o.length===0?i:o[Math.floor(n*o.length)]:typeof o=="string"?o:i},[e,n,t])}}function Cd(e){const t=e.getHours();return t<5?"night":t<12?"morning":t<19?"day":"night"}function Ed(e){let{setIsSticky:t,searchParams:n}=e;const{t:r}=Sd(),{t:a}=S(),[i,o,l]=n,[,c]=d.useState(!1),u=gt(),m=d.useCallback(N=>{c(N),t(N)},[c,t]),{width:g}=sa(),f=16,[h,x]=d.useState(f);d.useEffect(()=>{g>1200?x(f):x(f+60)},[g]);const v=Cd(new Date),b=r(`home.titles.${v}`),y=d.useRef(null);return wd(y),s.jsx(ht,{children:s.jsxs("div",{className:"mt-44 space-y-16 text-center",children:[s.jsx("div",{className:"relative z-10 mb-16",children:s.jsx(kd,{className:"mx-auto max-w-md",children:b})}),s.jsx("div",{className:"relative h-20 z-30",children:s.jsx(ra,{topOffset:h*-1+u,stickyStyle:{paddingTop:`${h+u}px`},onFixedToggle:m,children:s.jsx(jd,{ref:y,onChange:o,value:i,onUnFocus:l,placeholder:a("home.search.placeholder")??""})})})]})})}function Id(){const{t:e}=S(),t=W(c=>c.bookmarks),n=V(c=>c.items),r=V(c=>c.removeItem),[a,i]=d.useState(!1),[o]=Gt(),l=d.useMemo(()=>{let c=[];return Object.entries(n).filter(u=>wr(u[1]).show).sort((u,m)=>m[1].updatedAt-u[1].updatedAt).forEach(u=>{c.push({id:u[0],...u[1]})}),c=c.filter(u=>!!!t[u.id]),c},[n,t]);return l.length===0?null:s.jsxs("div",{children:[s.jsx(xn,{title:e("home.continueWatching.sectionTitle"),icon:j.CLOCK,children:s.jsx(vr,{editing:a,onEdit:i})}),s.jsx(pn,{ref:o,children:l.map(c=>s.jsx(bn,{media:c,closable:a,onClose:()=>r(c.id)},c.id))})]})}function kr(){const{t:e}=S();return s.jsx(Oe,{className:"mb-24 mt-40",text:e("home.search.loading")??void 0})}function ns(e){const{t}=S(),n=e.failed?j.WARNING:j.EYE_SLASH;return s.jsxs("div",{className:"mb-24 mt-40  flex flex-col items-center justify-center space-y-3 text-center",children:[s.jsx(st,{icon:n,className:`text-xl ${e.failed?"text-red-400":"text-type-logo"}`}),e.failed?null:s.jsx("div",{children:(e.results??0)>0?s.jsx("p",{children:t("home.search.allResults")}):s.jsx("p",{children:t("home.search.noResults")})}),e.failed?s.jsx("div",{children:s.jsx("p",{children:t("home.search.failed")})}):null]})}function Ld(e){let{searchQuery:t}=e;const{t:n}=S(),[r,a]=d.useState([]),[i,o]=se(l=>Ts(l));return d.useEffect(()=>{async function l(c){const u=await o(c);u&&a(u)}t!==""&&l({searchQuery:t})},[t,o]),i.loading?s.jsx(kr,{}):i.error?s.jsx(ns,{failed:!0}):r?s.jsxs("div",{children:[r.length>0?s.jsxs("div",{children:[s.jsx(xn,{title:n("home.search.sectionTitle"),icon:j.SEARCH}),s.jsx(pn,{children:r.map(l=>s.jsx(bn,{media:l},l.id.toString()))})]}):null,s.jsx(ns,{results:r.length})]}):null}function Td(e){const[t,n]=d.useState(!1),[r,a]=d.useState(!1),i=dd(e,500);return d.useEffect(()=>{n(e!==""),a(e!=="")},[e]),d.useEffect(()=>{a(!1)},[i]),{loading:r,searching:t}}function ss(){const{t:e}=S(),[t,n]=d.useState(!1),r=md(),[a]=r,i=Td(a);return s.jsxs(hd,{showBg:t,children:[s.jsxs("div",{className:"mb-16 sm:mb-24",children:[s.jsx(le,{children:s.jsx("title",{children:e("global.name")})}),s.jsx(Ed,{searchParams:r,setIsSticky:n})]}),s.jsx($s,{children:i.loading?s.jsx(kr,{}):i.searching?s.jsx(Ld,{searchQuery:a}):s.jsxs(s.Fragment,{children:[s.jsx(vd,{}),s.jsx(Id,{})]})})]})}function Ue(e){return s.jsxs("div",{className:"flex flex-col items-center",children:[e.top?s.jsx("div",{className:"inline-block transform translate-y-1/2",children:e.top}):null,s.jsx("div",{className:"w-full rounded-xl bg-largeCard-background bg-opacity-50 max-w-[600px] mx-auto p-[3rem]",children:e.children})]})}function $e(e){return s.jsx("div",{className:"flex flex-col items-center text-center mb-8",children:s.jsxs("div",{className:"flex flex-col items-center text-center max-w-[318px]",children:[e.icon?s.jsx("div",{className:"text-2xl mb-4 text-largeCard-icon",children:e.icon}):null,s.jsx("h2",{className:"text-xl text-white font-bold",children:e.title}),e.children?s.jsx("div",{className:"text-type-text mt-4",children:e.children}):null]})})}function Ve(e){return s.jsx("div",{className:"mt-12",children:s.jsx("div",{className:C("mx-auto",{"flex flex-row-reverse justify-between items-center":e.splitAlign,"flex max-w-xs flex-col-reverse gap-3":!e.splitAlign}),children:e.children})})}function Nr(e){const t=!!e.url,n=!!e.to,r=s.jsx("span",{className:"group mt-1 cursor-pointer font-bold text-type-link hover:text-type-linkHover active:scale-95",children:e.children});return t?s.jsx("a",{href:e.url,children:r}):n?s.jsx(qt,{to:e.to??"",children:r}):s.jsx("span",{onClick:()=>e.onClick&&e.onClick(),children:r})}function it(e){return s.jsxs("div",{className:"space-y-3",children:[e.label?s.jsx("p",{className:"font-bold text-white",children:e.label}):null,s.jsx(dn,{name:e.name,value:e.value,autoComplete:e.autoComplete,onChange:e.onChange,placeholder:e.placeholder,passwordToggleable:e.passwordToggleable,className:"w-full flex-1 bg-authentication-inputBg px-4 py-3 text-search-text focus:outline-none rounded-lg placeholder:text-gray-700"})]})}function Rd(e){const[t,n]=d.useState(""),[r,a]=d.useState(""),{login:i,restore:o,importData:l}=we(),c=V(h=>h.items),u=W(h=>h.bookmarks),{t:m}=S(),[g,f]=se(async(h,x)=>{var y;if(!io(h))throw new Error(m("auth.login.validationError")??void 0);const v=x.trim();if(v.length===0)throw new Error(m("auth.login.deviceLengthError")??void 0);let b;try{b=await i({mnemonic:h,userData:{device:v}})}catch(N){throw N.status===401?new Error(m("auth.login.validationError")??void 0):N}await l(b,c,u),await o(b),(y=e.onLogin)==null||y.call(e)},[e,i,o,m]);return s.jsxs(Ue,{top:s.jsx(Ne,{backgroundClass:"bg-[#161527]"}),children:[s.jsx($e,{title:m("auth.login.title"),children:m("auth.login.description")}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(it,{label:m("auth.login.passphraseLabel")??void 0,value:t,autoComplete:"username",name:"username",onChange:n,placeholder:m("auth.login.passphrasePlaceholder")??void 0,passwordToggleable:!0}),s.jsx(it,{label:m("auth.deviceNameLabel")??void 0,value:r,onChange:a,placeholder:m("auth.deviceNamePlaceholder")??void 0}),g.error&&!g.loading?s.jsx("p",{className:"text-authentication-errorText",children:g.error.message}):null]}),s.jsx(Ve,{children:s.jsx(_,{theme:"purple",loading:g.loading,onClick:()=>f(t,r),children:m("auth.login.submit")})}),s.jsx("p",{className:"text-center mt-6",children:s.jsx(Te,{i18nKey:"auth.createAccount",children:s.jsx(Nr,{to:"/register",children:"."})})})]})}function Pd(){const e=ee();return s.jsxs(Be,{children:[s.jsx(ft,{subpage:!0,k:"global.pages.login"}),s.jsx(Rd,{onLogin:()=>{e("/")}})]})}const Sr=["#0A54FF","#CF2E68","#F9DD7F","#7652DD","#2ECFA8"],rs=Sr[0],Ad=function(t){return s.jsxs("div",{className:"space-y-3",children:[t.label?s.jsx("p",{className:"font-bold text-white",children:t.label}):null,s.jsx("div",{className:"flex gap-3",children:Sr.map(n=>s.jsx("button",{type:"button",tabIndex:0,className:C("w-full h-10 rounded flex justify-center items-center text-white pointer border-2 border-opacity-10 cursor-pointer",t.value===n?"border-white":"border-transparent"),onClick:()=>t.onInput(n),style:{backgroundColor:n},children:t.value===n?s.jsx(E,{icon:j.CHECKMARK}):null},n))})]})},as=Ad,Cr=[Se.USER_GROUP,Se.COUCH,Se.MOBILE,Se.TICKET,Se.HANDCUFFS],Md=Cr[0],_d=function(t){return s.jsxs("div",{className:"space-y-3",children:[t.label?s.jsx("p",{className:"font-bold text-white",children:t.label}):null,s.jsx("div",{className:"flex gap-3",children:Cr.map(n=>s.jsx("button",{type:"button",tabIndex:0,className:C("w-full h-10 rounded flex justify-center items-center text-white pointer border-2 border-opacity-10 cursor-pointer",t.value===n?"bg-buttons-purple border-white":"bg-authentication-inputBg border-transparent"),onClick:()=>t.onInput(n),children:s.jsx(ds,{className:"text-xl",icon:n})},n))})]})},Od=_d;function Dd(e){const[t,n]=d.useState(""),[r,a]=d.useState(rs),[i,o]=d.useState(rs),[l,c]=d.useState(Md),{t:u}=S(),[m,g]=d.useState(!1),f=d.useCallback(()=>{var x;g(!1);const h=t.trim();if(h.length===0){g(!0);return}(x=e.onNext)==null||x.call(e,{device:h,profile:{colorA:r,colorB:i,icon:l}})},[t,e,r,i,l]);return s.jsxs(Ue,{children:[s.jsx($e,{icon:s.jsx(E,{icon:j.USER}),title:u("auth.register.information.title")??void 0,children:u("auth.register.information.header")}),s.jsxs("div",{className:"space-y-6",children:[s.jsx(it,{label:u("auth.deviceNameLabel")??void 0,value:t,onChange:n,placeholder:u("auth.deviceNamePlaceholder")??void 0}),s.jsx(as,{label:u("auth.register.information.color1"),value:r,onInput:a}),s.jsx(as,{label:u("auth.register.information.color2"),value:i,onInput:o}),s.jsx(Od,{label:u("auth.register.information.icon"),value:l,onInput:c}),m?s.jsx("p",{className:"text-authentication-errorText",children:u("auth.login.deviceLengthError")}):null]}),s.jsx(Ve,{children:s.jsx(_,{theme:"purple",onClick:()=>f(),children:u("auth.register.information.next")})})]})}const Bd=function(t){const{t:n}=S(),r=t.mnemonic.split(" "),[,a]=aa(),[i,o]=d.useState(!1),l=ia(),c=d.useRef();function u(){a(t.mnemonic),o(!0),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>l()&&o(!1),500)}return s.jsxs("div",{className:"rounded-lg border border-authentication-border/50 ",children:[s.jsxs("div",{className:"px-4 py-2 flex justify-between border-b border-authentication-border/50",children:[s.jsx("p",{className:"font-bold text-sm text-white",children:n("auth.generate.passphraseFrameLabel")}),s.jsxs("button",{type:"button",className:"text-authentication-copyText hover:text-authentication-copyTextHover transition-colors flex gap-2 items-center cursor-pointer",onClick:()=>u(),children:[s.jsx(E,{icon:i?j.CHECKMARK:j.COPY,className:i?"text-xs":""}),s.jsx("span",{className:"text-sm",children:n("actions.copy")})]})]}),s.jsx("div",{className:"px-4 py-4 grid grid-cols-3 text-sm sm:text-base sm:grid-cols-4 gap-2",children:r.map((m,g)=>s.jsx("div",{className:"rounded-md py-2 bg-authentication-wordBackground text-white font-medium text-center",children:m},g))})]})},Fd=Bd;function Ud(e){const t=d.useMemo(()=>oo(),[]),{t:n}=S();return s.jsxs(Ue,{children:[s.jsx($e,{title:n("auth.generate.title"),icon:s.jsx(E,{icon:j.USER}),children:n("auth.generate.description")}),s.jsx(Fd,{mnemonic:t}),s.jsx(Ve,{children:s.jsx(_,{theme:"purple",onClick:()=>{var r;return(r=e.onNext)==null?void 0:r.call(e,t)},children:n("auth.generate.next")})})]})}function $d(e){const t=ee(),n=me(),r=d.useMemo(()=>new URL(n).hostname,[n]),a=ot(()=>Ks(M().BACKEND_URL),[n]),{t:i}=S();let o=s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-white font-bold text-lg",children:i("auth.trust.failed.title")}),s.jsx("p",{children:i("auth.trust.failed.text")})]});return a.loading&&(o=s.jsx(Oe,{})),a.value&&(o=s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-white font-bold text-lg",children:a.value.name}),a.value.description?s.jsx("p",{className:"text-center",children:a.value.description}):null]})),s.jsxs(Ue,{children:[s.jsx($e,{title:i("auth.trust.title"),icon:s.jsx(E,{icon:j.CIRCLE_EXCLAMATION}),children:s.jsx(Te,{i18nKey:"auth.trust.host",values:{hostname:r},children:s.jsx("span",{className:"text-white"})})}),s.jsx("div",{className:"border border-authentication-border rounded-xl px-4 py-8 flex flex-col items-center space-y-2 my-8",children:o}),s.jsxs(Ve,{children:[s.jsx(_,{theme:"secondary",onClick:()=>t("/"),children:i("auth.trust.no")}),s.jsx(_,{theme:"purple",onClick:()=>{var l;return a.value&&((l=e.onNext)==null?void 0:l.call(e,a.value))},children:i("auth.trust.yes")})]}),s.jsx("p",{className:"text-center mt-6",children:s.jsx(Te,{i18nKey:"auth.hasAccount",children:s.jsx(Nr,{to:"/login",children:"."})})})]})}function Vd(e){const[t,n]=d.useState(""),{register:r,restore:a,importData:i}=we(),o=V(b=>b.items),l=W(b=>b.bookmarks),c=_e(b=>b.language),u=O(b=>b.lastSelectedLanguage),m=tn(b=>b.theme),g=me(),{t:f}=S(),{executeRecaptcha:h}=oa(),[x,v]=se(async b=>{var T;if(!e.mnemonic||!e.userData)throw new Error(f("auth.verify.invalidData")??void 0);let y;if(e.hasCaptcha&&(y=h?await h():void 0,!y))throw new Error(f("auth.verify.recaptchaFailed")??void 0);if(b!==e.mnemonic)throw new Error(f("auth.verify.noMatch")??void 0);const N=await r({mnemonic:b,userData:e.userData,recaptchaToken:y});await i(N,o,l),await Os(g,N,{applicationLanguage:c,defaultSubtitleLanguage:u??void 0,applicationTheme:m??void 0}),await a(N),(T=e.onNext)==null||T.call(e)},[e,r,a]);return s.jsx(Ue,{children:s.jsxs("form",{children:[s.jsx($e,{icon:s.jsx(E,{icon:j.CIRCLE_CHECK}),title:f("auth.verify.title"),children:f("auth.verify.description")}),s.jsx(it,{label:f("auth.verify.passphraseLabel")??void 0,autoComplete:"username",name:"username",value:t,onChange:n,passwordToggleable:!0}),x.error?s.jsx("p",{className:"mt-3 text-authentication-errorText",children:x.error.message}):null,s.jsx(Ve,{children:s.jsx(_,{theme:"purple",loading:x.loading,onClick:()=>v(t),children:f("auth.verify.register")})})]})})}function Hd(e){return e.siteKey?s.jsx(la,{reCaptchaKey:e.siteKey,children:e.children}):e.children}function Wd(){const e=ee(),[t,n]=d.useState(0),[r,a]=d.useState(null),[i,o]=d.useState(null),[l,c]=d.useState(null);return s.jsx(Hd,{siteKey:l,children:s.jsxs(Be,{children:[s.jsx(ft,{subpage:!0,k:"global.pages.register"}),t===0?s.jsx($d,{onNext:u=>{c(u.hasCaptcha&&u.captchaClientKey?u.captchaClientKey:null),n(1)}}):null,t===1?s.jsx(Ud,{onNext:u=>{a(u),n(2)}}):null,t===2?s.jsx(Dd,{onNext:u=>{o(u),n(3)}}):null,t===3?s.jsx(Vd,{hasCaptcha:!!l,mnemonic:r,userData:i,onNext:()=>{e("/")}}):null]})})}function zd(e){const t=gt(),n=ne(r=>r.location);return s.jsxs("div",{children:[s.jsx("div",{className:"fixed inset-x-0 z-[1000]",children:s.jsx(yr,{})}),s.jsx("div",{style:{paddingTop:n===null?`${t}px`:"0px"},className:"flex min-h-screen flex-col",children:e.children})]})}const Er=K(G(e=>({routes:[],registerRoute(t){e(n=>{n.routes.push(t)})}})));function Qd(){const e=Ae(),t=Er(n=>n.registerRoute);d.useEffect(()=>{t({path:e.pathname})},[e.pathname,t]),us(()=>{t({path:e.pathname})})}function Lm(){const e=Er(r=>r.routes),t=Ae();return d.useMemo(()=>{const r=[...e];r.reverse();const a=r.find(i=>!i.path.startsWith("/media")&&t.pathname!==i.path&&!i.path.startsWith("/s/"));return(a==null?void 0:a.path)??"/"},[e,t])}const Kd=d.lazy(()=>pt(()=>import("./DeveloperPage-wdNbBDfs.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])));d.lazy(()=>pt(()=>import("./TestView-Rqe0tN4S.js"),__vite__mapDeps([10,1,2,3,4,7,5,6,8,9])));const zt=ls(()=>pt(()=>import("./PlayerView-6nGF7bBv.js"),__vite__mapDeps([11,1,2,3,5,6,4,7,8,9]))),Ir=ls(()=>pt(()=>import("./Settings-ioYldbdn.js"),__vite__mapDeps([12,1,2,3,4,5,6,8,9,7])));zt.preload();Ir.preload();function is(e){let{children:t}=e;const n=Ae(),r=ee();return d.useEffect(()=>{const a=n.pathname;Mt(a)&&Ci(n.pathname).then(i=>{r(i??"/",{replace:!0})})},[n.pathname,r]),Mt(n.pathname)?null:t}function Gd(){const{query:e}=Kt(),t=ee();return d.useEffect(()=>{e?wi(e).then(n=>{t(n??"/",{replace:!0})}):t("/",{replace:!0})},[e,t]),null}function qd(){const{query:e}=Kt(),t=ee();return d.useEffect(()=>{e?t(`/browse/${e}`,{replace:!0}):t("/",{replace:!0})},[e,t]),null}function Yd(){return Qd(),nl(),s.jsxs(zd,{children:[s.jsx(Zi,{}),s.jsxs(Gr,{children:[s.jsx(B,{path:"/s/:query",element:s.jsx(Gd,{})}),s.jsx(B,{path:"/search/:type",element:s.jsx(qr,{to:"/browse"})}),s.jsx(B,{path:"/search/:type/:query?",element:s.jsx(qd,{})}),s.jsx(B,{path:"/media/:media",element:s.jsx(is,{children:s.jsx(d.Suspense,{fallback:null,children:s.jsx(zt,{})})})}),s.jsx(B,{path:"/media/:media/:season/:episode",element:s.jsx(is,{children:s.jsx(d.Suspense,{fallback:null,children:s.jsx(zt,{})})})}),s.jsx(B,{path:"/browse/:query?",element:s.jsx(ss,{})}),s.jsx(B,{path:"/",element:s.jsx(ss,{})}),s.jsx(B,{path:"/register",element:s.jsx(Wd,{})}),s.jsx(B,{path:"/login",element:s.jsx(Pd,{})}),s.jsx(B,{path:"/about",element:s.jsx(al,{})}),Vs()?s.jsx(B,{path:"/dmca",element:s.jsx(Uo,{})}):null,s.jsx(B,{path:"/settings",element:s.jsx(d.Suspense,{fallback:null,children:s.jsx(Ir,{})})}),s.jsx(B,{path:"/admin",element:s.jsx(ul,{})}),s.jsx(B,{path:"/dev",element:s.jsx(Kd,{})}),s.jsx(B,{path:"/dev/video",element:s.jsx(ld,{})}),null,s.jsx(B,{path:"*",element:s.jsx(ud,{})})]})]})}const Jd=5*1e3;async function Xd(e,t,n,r){for(const a of e)if(t(a.id),!!r)try{if(a.action==="delete"){await ro(n,r,a.tmdbId);continue}if(a.action==="add"){await so(n,r,{meta:{poster:a.poster,title:a.title??"",type:a.type??"",year:a.year??NaN},tmdbId:a.tmdbId});continue}}catch(i){console.error(`Failed to sync bookmark: ${a.tmdbId} - ${a.action}`,i)}}function Zd(){const e=W(r=>r.clearUpdateQueue),t=W(r=>r.removeUpdateItem),n=me();return d.useEffect(()=>{e()},[e]),d.useEffect(()=>{const r=setInterval(()=>{(async()=>{const a=W.getState(),i=F.getState();await Xd(a.updateQueue,t,n,i.account)})()},Jd);return()=>{clearInterval(r)}},[t,n]),null}const em=5*1e3;async function tm(e,t,n,r){for(const a of e)if(t(a.id),!!r)try{if(a.action==="delete"){await po(n,r,a.tmdbId,a.seasonId,a.episodeId);continue}if(a.action==="upsert"){await xo(n,r,fo(a));continue}}catch(i){console.error(`Failed to sync progress: ${a.tmdbId} - ${a.action}`,i)}}function nm(){const e=V(r=>r.clearUpdateQueue),t=V(r=>r.removeUpdateItem),n=me();return d.useEffect(()=>{e()},[e]),d.useEffect(()=>{const r=setInterval(()=>{(async()=>{const a=V.getState(),i=F.getState();await tm(a.updateQueue,t,n,i.account)})()},em);return()=>{clearInterval(r)}},[t,n]),null}const sm=5*1e3;function rm(){const e=O(n=>n.importSubtitleLanguage),t=me();return d.useEffect(()=>{const n=setInterval(()=>{(async()=>{const r=O.getState(),a=F.getState();r.lastSync.lastSelectedLanguage!==r.lastSelectedLanguage&&a.account&&r.lastSelectedLanguage&&(await Os(t,a.account,{defaultSubtitleLanguage:r.lastSelectedLanguage}),e(r.lastSelectedLanguage))})()},sm);return()=>{clearInterval(n)}},[e,t]),null}Cu();function Lr(e){const t={user:"screens.loadingUser",lazy:"screens.loadingApp"},{t:n}=S();return s.jsx(Qs,{iconSlot:s.jsx(Oe,{}),children:n(t[e.type]??"unknown.translation")})}function Tr(e){const{t}=S(),{logout:n}=we(),r=F(o=>o.setBackendUrl),a=d.useCallback(()=>{r(null),location.reload()},[r]),i=d.useCallback(()=>{n().then(()=>{location.reload()})},[n]);return s.jsxs(Qs,{iconSlot:s.jsx(E,{className:"text-type-danger text-2xl",icon:j.WARNING}),children:[e.children,e.showResetButton?s.jsx("div",{className:"mt-6",children:s.jsx(_,{theme:"secondary",onClick:a,children:t("screens.loadingUserError.reset")})}):null,e.showLogoutButton?s.jsx("div",{className:"mt-6",children:s.jsx(_,{theme:"secondary",onClick:i,children:t("screens.loadingUserError.logout")})}):null]})}function am(){const e=Lo(),t=M().BACKEND_URL,n=me(),{t:r}=S(),a=t!==n;return e.loading?s.jsx(Lr,{type:"user"}):e.error?s.jsx(Tr,{showResetButton:a,showLogoutButton:!a,children:r(a?"screens.loadingUserError.textWithReset":"screens.loadingUserError.text")}):s.jsx(Yd,{})}function im(){const e=ot(async()=>{Qt.changeLanguage(_e.getState().language),await Fa()},[]),{t}=S();return e.loading?s.jsx(Zo,{}):e.error?s.jsx(Tr,{children:t("screens.migration.failed")}):s.jsx(am,{})}function om(e){return M().NORMAL_ROUTER?s.jsx(da,{children:e.children}):s.jsx(ma,{children:e.children})}const lm=document.getElementById("root"),cm=ca(lm);cm.render(s.jsx(d.StrictMode,{children:s.jsxs(Fo,{children:[s.jsx(oi,{}),s.jsx(ua,{children:s.jsx(d.Suspense,{fallback:s.jsx(Lr,{type:"lazy"}),children:s.jsxs(Co,{applyGlobal:!0,children:[s.jsx(nm,{}),s.jsx(Zd,{}),s.jsx(rm,{}),s.jsx(om,{children:s.jsx(im,{})})]})})})]})}));export{Oc as $,Ol as A,_ as B,me as C,F as D,an as E,Eo as F,Cm as G,De as H,nn as I,Em as J,Mo as K,Oe as L,R as M,ln as N,Im as O,_l as P,ve as Q,as as R,Od as S,ht as T,we as U,Vo as V,it as W,sn as X,Et as Y,k as Z,Bc as _,Pe as a,td as a0,gn as a1,cn as a2,_s as a3,en as a4,vo as a5,vt as a6,Ks as a7,$c as a8,wm as a9,dl as aa,km as ab,tn as ac,_e as ad,O as ae,Os as af,Mn as ag,Nm as ah,Sm as ai,Be as aj,ft as ak,$s as al,At as b,rn as c,jm as d,M as e,vm as f,js as g,hi as h,Do as i,z as j,Tt as k,ct as l,Lt as m,gs as n,bm as o,Rt as p,on as q,er as r,ym as s,mr as t,Fs as u,Lm as v,Vt as w,Ft as x,id as y,A as z};
//# sourceMappingURL=index-LKd9rWQ7.js.map
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/DeveloperPage-wdNbBDfs.js","assets/vendor-obEwBfia.js","assets/auth-PrcDRVv8.js","assets/caption-parsing-RO8mGNwK.js","assets/react-dom-75QGQ8x8.js","assets/Icons--uG9Na6u.js","assets/Icons-L9H4Bkh4.css","assets/locales-kG0Ihi24.js","assets/hls-zqvr_1ex.js","assets/ietf-language-tags-EHt6_2CE.js","assets/TestView-Rqe0tN4S.js","assets/PlayerView-6nGF7bBv.js","assets/Settings-ioYldbdn.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}